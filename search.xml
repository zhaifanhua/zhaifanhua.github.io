<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SqlServer常用语句及函数</title>
      <link href="/2021/07/12/30d67e432942/"/>
      <url>/2021/07/12/30d67e432942/</url>
      
        <content type="html"><![CDATA[<h1 id="SqlServer常用语句及函数"><a href="#SqlServer常用语句及函数" class="headerlink" title="SqlServer常用语句及函数"></a>SqlServer常用语句及函数</h1><h2 id="1、删除所有表"><a href="#1、删除所有表" class="headerlink" title="1、删除所有表"></a>1、删除所有表</h2><p> 1.1、删除所有表的外键约束（防止由于外键约束表删除失败）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> c1 <span class="keyword">cursor</span> <span class="keyword">for</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;alter table [&#x27;</span><span class="operator">+</span> object_name(parent_obj) <span class="operator">+</span> <span class="string">&#x27;] drop constraint [&#x27;</span><span class="operator">+</span>name<span class="operator">+</span><span class="string">&#x27;]; &#x27;</span></span><br><span class="line"><span class="keyword">from</span> sysobjects</span><br><span class="line"><span class="keyword">where</span> xtype <span class="operator">=</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line"><span class="keyword">open</span> c1</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@c1</span> <span class="type">varchar</span>(<span class="number">8000</span>)</span><br><span class="line"><span class="keyword">fetch</span> next <span class="keyword">from</span> c1 <span class="keyword">into</span> <span class="variable">@c1</span></span><br><span class="line">while(@<span class="variable">@fetch</span>_status<span class="operator">=</span><span class="number">0</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">exec</span>(<span class="variable">@c1</span>)</span><br><span class="line"><span class="keyword">fetch</span> next <span class="keyword">from</span> c1 <span class="keyword">into</span> <span class="variable">@c1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">close</span> c1</span><br><span class="line"><span class="keyword">deallocate</span> c1</span><br></pre></td></tr></table></figure><p> 1.2、删除所有的存储过程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名(是要删除表所在的那个数据库的名称)</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@sql</span> <span class="type">varchar</span>(<span class="number">8000</span>)</span><br><span class="line">while (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> sysobjects <span class="keyword">where</span> type<span class="operator">=</span><span class="string">&#x27;P&#x27;</span>)<span class="operator">&gt;</span><span class="number">0</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@sql</span><span class="operator">=</span><span class="string">&#x27;drop Procedure &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">FROM</span> sysobjects</span><br><span class="line"><span class="keyword">WHERE</span> (type <span class="operator">=</span> <span class="string">&#x27;P&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="string">&#x27;drop Procedure &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">exec</span>(<span class="variable">@sql</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p> 1.3、删除所有表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名(是要删除表所在的那个数据库的名称)</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@sql</span> <span class="type">varchar</span>(<span class="number">8000</span>)</span><br><span class="line">while (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> sysobjects <span class="keyword">where</span> type<span class="operator">=</span><span class="string">&#x27;U&#x27;</span>)<span class="operator">&gt;</span><span class="number">0</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@sql</span><span class="operator">=</span><span class="string">&#x27;drop table &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">FROM</span> sysobjects</span><br><span class="line"><span class="keyword">WHERE</span> (type <span class="operator">=</span> <span class="string">&#x27;U&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="string">&#x27;drop table &#x27;</span> <span class="operator">+</span> name</span><br><span class="line"><span class="keyword">exec</span>(<span class="variable">@sql</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h2 id="2、CONVERT-函数"><a href="#2、CONVERT-函数" class="headerlink" title="2、CONVERT() 函数"></a>2、CONVERT() 函数</h2><blockquote><p>CONVERT() 函数是把日期转换为新数据类型的通用函数。CONVERT() 函数可以用不同的格式显示日期/时间数据。</p></blockquote><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONVERT(data_type(length),data_to_be_converted,style)</span><br></pre></td></tr></table></figure><p><em>data_type(length)</em> 规定目标数据类型（带有可选的长度）。<em>data_to_be_converted</em> 含有需要转换的值。<em>style</em> 规定日期/时间的输出格式。</p><p>可以使用的 <em>style</em> 值：</p><table><thead><tr><th align="left">Style ID</th><th align="left">Style 格式</th></tr></thead><tbody><tr><td align="left">100 或者 0</td><td align="left">mon dd yyyy hh:miAM （或者 PM）</td></tr><tr><td align="left">101</td><td align="left">mm/dd/yy</td></tr><tr><td align="left">102</td><td align="left">yy.mm.dd</td></tr><tr><td align="left">103</td><td align="left">dd/mm/yy</td></tr><tr><td align="left">104</td><td align="left">dd.mm.yy</td></tr><tr><td align="left">105</td><td align="left">dd-mm-yy</td></tr><tr><td align="left">106</td><td align="left">dd mon yy</td></tr><tr><td align="left">107</td><td align="left">Mon dd, yy</td></tr><tr><td align="left">108</td><td align="left">hh:mm:ss</td></tr><tr><td align="left">109 或者 9</td><td align="left">mon dd yyyy hh:mi:ss:mmmAM（或者 PM）</td></tr><tr><td align="left">110</td><td align="left">mm-dd-yy</td></tr><tr><td align="left">111</td><td align="left">yy/mm/dd</td></tr><tr><td align="left">112</td><td align="left">yymmdd</td></tr><tr><td align="left">113 或者 13</td><td align="left">dd mon yyyy hh:mm:ss:mmm(24h)</td></tr><tr><td align="left">114</td><td align="left">hh:mi:ss:mmm(24h)</td></tr><tr><td align="left">120 或者 20</td><td align="left">yyyy-mm-dd hh:mi:ss(24h)</td></tr><tr><td align="left">121 或者 21</td><td align="left">yyyy-mm-dd hh:mi:ss.mmm(24h)</td></tr><tr><td align="left">126</td><td align="left">yyyy-mm-ddThh:mm:ss.mmm（没有空格）</td></tr><tr><td align="left">130</td><td align="left">dd mon yyyy hh:mi:ss:mmmAM</td></tr><tr><td align="left">131</td><td align="left">dd/mm/yy hh:mi:ss:mmmAM</td></tr></tbody></table><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>下面的脚本使用 CONVERT() 函数来显示不同的格式。我们将使用 GETDATE() 函数来获得当前的日期/时间：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONVERT(VARCHAR(19),GETDATE())</span><br><span class="line">CONVERT(VARCHAR(10),GETDATE(),110) </span><br><span class="line">CONVERT(VARCHAR(11),GETDATE(),106)</span><br><span class="line">CONVERT(VARCHAR(24),GETDATE(),113)</span><br></pre></td></tr></table></figure><p>结果类似：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Dec 29 2008 11:45 PM</span><br><span class="line">12-29-2008</span><br><span class="line">29 Dec 08</span><br><span class="line">29 Dec 2008 16:25:46.635</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SqlServer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SqlServer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决电脑不能复制移动删除文件夹的方法</title>
      <link href="/2021/07/06/0ca56f2765d8/"/>
      <url>/2021/07/06/0ca56f2765d8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>有时候小伙伴们正在或刚使用过的文件夹或者某个文件，想要把它移动到其它的位置，或者删除它，又或者仅仅想重命名这个文件，但是在操作过程中，我们发现它弹出来了文件夹或者文件正在被使用，操作无法完成，怎么办呢？对于这种情况，我们可以使用多种方法来解决。具体是什么呢？</p></blockquote><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p><strong>找到占用文件或文件夹的进程，结束那个进程就可以了。具体为：</strong></p><p><strong>【任务管理器】&gt;【性能】&gt;【打开资源监视器】&gt;【CPU】&gt;【关联的句柄】&gt;【输入文件夹地址】&gt;【结束进程】</strong></p><h3 id="1、文件夹正在使用"><a href="#1、文件夹正在使用" class="headerlink" title="1、文件夹正在使用"></a>1、文件夹正在使用</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210706115625.png!sign" alt="image-20210706115621973"></p><h3 id="2、【Ctrl】-【Alt】-【Del】快捷键打开任务管理器"><a href="#2、【Ctrl】-【Alt】-【Del】快捷键打开任务管理器" class="headerlink" title="2、【Ctrl】+【Alt】+【Del】快捷键打开任务管理器"></a>2、【Ctrl】+【Alt】+【Del】快捷键打开任务管理器</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210706115834.png!sign" alt="image-20210706115833003"></p><h3 id="3、点击性能选项卡选择打开资源管理器"><a href="#3、点击性能选项卡选择打开资源管理器" class="headerlink" title="3、点击性能选项卡选择打开资源管理器"></a>3、点击性能选项卡选择打开资源管理器</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210706120026.png!sign" alt="image-20210706120025366"></p><h3 id="4、打开-CPU-选项卡"><a href="#4、打开-CPU-选项卡" class="headerlink" title="4、打开 CPU 选项卡"></a>4、打开 CPU 选项卡</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210706120121.png!sign" alt="image-20210706120119301"></p><h3 id="5、将路径复制到【关键的句柄】，右键【结束进程】"><a href="#5、将路径复制到【关键的句柄】，右键【结束进程】" class="headerlink" title="5、将路径复制到【关键的句柄】，右键【结束进程】"></a>5、将路径复制到【关键的句柄】，右键【结束进程】</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210706120235.png!sign" alt="image-20210706120233849"></p><p><img src="https://img.zhaifanhua.com/blogimg/20210706120403.png!sign" alt="image-20210706120401074"></p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐​​ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 攻略 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 攻略 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>通用.NET数据库访问类SqlHelper</title>
      <link href="/2021/06/19/bff0524135f8/"/>
      <url>/2021/06/19/bff0524135f8/</url>
      
        <content type="html"><![CDATA[<h1 id="通用-NET数据库访问类SqlHelper"><a href="#通用-NET数据库访问类SqlHelper" class="headerlink" title="通用.NET数据库访问类SqlHelper"></a>通用.NET数据库访问类SqlHelper</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Xml;</span><br><span class="line"><span class="keyword">using</span> System.Data.SqlClient;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Configuration;</span><br><span class="line"><span class="comment">/*解释: </span></span><br><span class="line"><span class="comment"> * --------连接字符串属性--------</span></span><br><span class="line"><span class="comment"> * &quot;Server&quot;或&quot;Data Source&quot;属性:服务器名</span></span><br><span class="line"><span class="comment"> * &quot;Database&quot;或&quot;Initial Catalog&quot;属性:数据库名</span></span><br><span class="line"><span class="comment"> * &quot;Persist Security Info&quot;属性:是否保存安全信息，即数据库连接成功后是否保存密码信息(True或False)</span></span><br><span class="line"><span class="comment"> * --------密码验证登录--------</span></span><br><span class="line"><span class="comment"> * &quot;Uid&quot;或&quot;User Id&quot;属性:连接数据库的验证用户名</span></span><br><span class="line"><span class="comment"> * &quot;Pwd&quot;或&quot;Password&quot;属性:连接数据库的验证密码</span></span><br><span class="line"><span class="comment"> * --------Windows登录--------</span></span><br><span class="line"><span class="comment"> * &quot;AttachDbFilename&quot;属性:服务器的文件路径</span></span><br><span class="line"><span class="comment"> * &quot;Integrated Security&quot;属性:Windows登录（True或False，SSPI即为True）</span></span><br><span class="line"><span class="comment"> * --------获取连接字符串--------</span></span><br><span class="line"><span class="comment"> * 如果要获取连接数据连接对象或字符串的话，先要修改Configuration中的ConnectionStrings为&quot;ConnectionString&quot;才能调用。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ZhaiFanHua.DAL</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SqlServer数据访问帮助类 </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">SqlHelper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 私有构造函数和方法</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">SqlHelper</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将SqlParameter参数数组(参数值)分配给SqlCommand命令. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将给任何一个参数分配DBNull.Value; </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 该操作将阻止默认值的使用. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;command&quot;&gt;</span>命令名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParameters数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AttachParameters</span>(<span class="params">SqlCommand command, SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (command == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;command&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandParameters != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">foreach</span> (SqlParameter p <span class="keyword">in</span> commandParameters)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (p != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 检查未分配值的输出参数,将其分配以DBNull.Value. </span></span><br><span class="line">                        <span class="keyword">if</span> ((p.Direction == ParameterDirection.InputOutput || p.Direction == ParameterDirection.Input) &amp;&amp;</span><br><span class="line">                                                    (p.Value == <span class="literal">null</span>))</span><br><span class="line">                        &#123;</span><br><span class="line">                            p.Value = DBNull.Value;</span><br><span class="line">                        &#125;</span><br><span class="line">                        command.Parameters.Add(p);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将DataRow类型的列值分配到SqlParameter参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>要分配值的SqlParameter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>将要分配给存储过程参数的DataRow<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssignParameterValues</span>(<span class="params">SqlParameter[] commandParameters, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((commandParameters == <span class="literal">null</span>) || (dataRow == <span class="literal">null</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 设置参数值 </span></span><br><span class="line">            <span class="keyword">foreach</span> (SqlParameter commandParameter <span class="keyword">in</span> commandParameters)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 创建参数名称,如果不存在,只抛出一个异常. </span></span><br><span class="line">                <span class="keyword">if</span> (commandParameter.ParameterName == <span class="literal">null</span> ||</span><br><span class="line">                                    commandParameter.ParameterName.Length &lt;= <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(</span><br><span class="line">                        <span class="built_in">string</span>.Format(<span class="string">&quot;请提供参数&#123;0&#125;一个有效的名称&#123;1&#125;.&quot;</span>, i, commandParameter.ParameterName));</span><br><span class="line">                <span class="comment">// 从dataRow的表中获取为参数数组中数组名称的列的索引. </span></span><br><span class="line">                <span class="comment">// 如果存在和参数名称相同的列,则将列值赋给当前名称的参数. </span></span><br><span class="line">                <span class="keyword">if</span> (dataRow.Table.Columns.IndexOf(commandParameter.ParameterName.Substring(<span class="number">1</span>)) != <span class="number">-1</span>)</span><br><span class="line">                    commandParameter.Value = dataRow[commandParameter.ParameterName.Substring(<span class="number">1</span>)];</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将一个对象数组分配给SqlParameter参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>要分配值的SqlParameter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>将要分配给存储过程参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssignParameterValues</span>(<span class="params">SqlParameter[] commandParameters, <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((commandParameters == <span class="literal">null</span>) || (parameterValues == <span class="literal">null</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 确保对象数组个数与参数个数匹配,如果不匹配,抛出一个异常. </span></span><br><span class="line">            <span class="keyword">if</span> (commandParameters.Length != parameterValues.Length)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;参数值个数与参数不匹配.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 给参数赋值 </span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>, j = commandParameters.Length; i &lt; j; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// If the current array value derives from IDbDataParameter, then assign its Value property </span></span><br><span class="line">                <span class="keyword">if</span> (parameterValues[i] <span class="keyword">is</span> IDbDataParameter)</span><br><span class="line">                &#123;</span><br><span class="line">                    IDbDataParameter paramInstance = (IDbDataParameter)parameterValues[i];</span><br><span class="line">                    <span class="keyword">if</span> (paramInstance.Value == <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        commandParameters[i].Value = DBNull.Value;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        commandParameters[i].Value = paramInstance.Value;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (parameterValues[i] == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    commandParameters[i].Value = DBNull.Value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    commandParameters[i].Value = parameterValues[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 预处理用户提供的命令,数据库连接/事务/命令类型/参数 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;command&quot;&gt;</span>要处理的SqlCommand<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>数据库连接<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的事务或者是null值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本, 其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或都T-SQL命令文本<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>和命令相关联的SqlParameter参数数组,如果没有参数为&#x27;null&#x27;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;mustCloseConnection&quot;&gt;</span><span class="doctag">&lt;c&gt;</span>true<span class="doctag">&lt;/c&gt;</span> 如果连接是打开的,则为true,其它情况下为false.<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrepareCommand</span>(<span class="params">SqlCommand command, SqlConnection connection, SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, SqlParameter[] commandParameters, <span class="keyword">out</span> <span class="built_in">bool</span> mustCloseConnection</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (command == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;command&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandText == <span class="literal">null</span> || commandText.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;commandText&quot;</span>);</span><br><span class="line">            <span class="comment">// If the provided connection is not open, we will open it </span></span><br><span class="line">            <span class="keyword">if</span> (connection.State != ConnectionState.Open)</span><br><span class="line">            &#123;</span><br><span class="line">                mustCloseConnection = <span class="literal">true</span>;</span><br><span class="line">                connection.Open();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 给命令分配一个数据库连接. </span></span><br><span class="line">            command.Connection = connection;</span><br><span class="line">            <span class="comment">// 设置命令文本(存储过程名或SQL语句) </span></span><br><span class="line">            command.CommandText = commandText;</span><br><span class="line">            <span class="comment">// 分配事务 </span></span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">                command.Transaction = transaction;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 设置命令类型. </span></span><br><span class="line">            command.CommandType = commandType;</span><br><span class="line">            <span class="comment">// 分配命令参数 </span></span><br><span class="line">            <span class="keyword">if</span> (commandParameters != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AttachParameters(command, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> 私有构造函数和方法结束</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 数据库连接 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 一个有效的数据库连接字符串 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetConnSting</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ConfigurationManager.ConnectionStrings[<span class="string">&quot;ConnectionString&quot;</span>].ConnectionString;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 一个有效的数据库连接对象 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlConnection <span class="title">GetConnection</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            SqlConnection Connection = <span class="keyword">new</span> SqlConnection(SqlHelper.GetConnSting());</span><br><span class="line">            <span class="keyword">return</span> Connection;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteNonQuery命令</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接字符串,类型的SqlCommand. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(connString, CommandType.StoredProcedure, &quot;PublishOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本, 其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回命令影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteNonQuery(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接字符串,类型的SqlCommand.如果没有提供参数,不返回结果. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(connString, CommandType.StoredProcedure, &quot;PublishOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本, 其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParameter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回命令影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connection, commandType, commandText, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接字符串的存储过程,将对象数组的值赋给存储过程参数, </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法需要在参数缓存方法中探索参数并生成参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法没有提供访问输出参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(connString, &quot;PublishOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串/param&gt; </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配到存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回受影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果存在参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从探索存储过程参数(加载到缓存)并分配给存储过程参数数组. </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数情况下 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, CommandType.StoredProcedure, &quot;PublishOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteNonQuery(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, CommandType.StoredProcedure, &quot;PublishOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>T存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// Finally, execute the command </span></span><br><span class="line">            <span class="built_in">int</span> retval = cmd.ExecuteNonQuery();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                connection.Close();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,将对象数组的值赋给存储过程参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, &quot;PublishOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行带事务的SqlCommand. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例.:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(trans, CommandType.StoredProcedure, &quot;PublishOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数/returns&gt; </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteNonQuery(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行带事务的SqlCommand(指定参数). </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型(存储过程,命令文本或其它.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行 </span></span><br><span class="line">            <span class="built_in">int</span> retval = cmd.ExecuteNonQuery();</span><br><span class="line">            <span class="comment">// 清除参数集,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行带事务的SqlCommand(指定参数值). </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int result = ExecuteNonQuery(conn, trans, &quot;PublishOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回受影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQuery</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ExecuteNonQuery方法结束</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteDataset方法</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteDataset(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例: </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamters参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connection, commandType, commandText, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,直接提供参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例: </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(connString, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中检索存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数分配值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteDataset(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定存储过程参数,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="comment">// 预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 创建SqlDataAdapter和DataSet. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter da = <span class="keyword">new</span> SqlDataAdapter(cmd))</span><br><span class="line">            &#123;</span><br><span class="line">                DataSet ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">                <span class="comment">// 填充DataSet. </span></span><br><span class="line">                da.Fill(ds);</span><br><span class="line">                cmd.Parameters.Clear();</span><br><span class="line">                <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                    connection.Close();</span><br><span class="line">                <span class="keyword">return</span> ds;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输入参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例.:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(conn, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 比缓存中加载存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数分配值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定事务的命令,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteDataset(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定事务的命令,指定参数,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 创建 DataAdapter &amp; DataSet </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter da = <span class="keyword">new</span> SqlDataAdapter(cmd))</span><br><span class="line">            &#123;</span><br><span class="line">                DataSet ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">                da.Fill(ds);</span><br><span class="line">                cmd.Parameters.Clear();</span><br><span class="line">                <span class="keyword">return</span> ds;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定事务的命令,指定参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输入参数和返回值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例.:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  DataSet ds = ExecuteDataset(trans, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDataset</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数 </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数分配值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteDataset(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ExecuteDataset数据集命令结束</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteReader 数据阅读器</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 枚举,标识数据库连接是由SqlHelper提供还是由调用者提供 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">enum</span> SqlConnectionOwnership</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>由SqlHelper提供连接<span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">            Internal,</span><br><span class="line">            <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>由调用者提供连接<span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">            External</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的数据阅读器. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 如果是SqlHelper打开连接,当连接关闭DataReader也将关闭. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 如果是调用都打开连接,DataReader由调用都管理. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的事务,或者为 &#x27;null&#x27;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParameters参数数组,如果没有参数则为&#x27;null&#x27;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionOwnership&quot;&gt;</span>标识数据库连接对象是由调用者提供还是由SqlHelper提供<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, SqlParameter[] commandParameters, SqlConnectionOwnership connectionOwnership</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 创建命令 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                PrepareCommand(cmd, connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">                <span class="comment">// 创建数据阅读器 </span></span><br><span class="line">                SqlDataReader dataReader;</span><br><span class="line">                <span class="keyword">if</span> (connectionOwnership == SqlConnectionOwnership.External)</span><br><span class="line">                &#123;</span><br><span class="line">                    dataReader = cmd.ExecuteReader();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dataReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 清除参数,以便再次使用.. </span></span><br><span class="line">                <span class="comment">// <span class="doctag">HACK:</span> There is a problem here, the output parameter values are fletched </span></span><br><span class="line">                <span class="comment">// when the reader is closed, so if the parameters are detached from the command </span></span><br><span class="line">                <span class="comment">// then the SqlReader can磘 set its values. </span></span><br><span class="line">                <span class="comment">// When this happen, the parameters can磘 be used again in other command. </span></span><br><span class="line">                <span class="built_in">bool</span> canClear = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">foreach</span> (SqlParameter commandParameter <span class="keyword">in</span> cmd.Parameters)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (commandParameter.Direction != ParameterDirection.Input)</span><br><span class="line">                        canClear = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (canClear)</span><br><span class="line">                &#123;</span><br><span class="line">                    cmd.Parameters.Clear();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> dataReader;</span><br><span class="line">            &#125;</span><br><span class="line">            catch</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                    connection.Close();</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的数据阅读器. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的数据阅读器,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组(new SqlParameter(&quot;@prodid&quot;, 24))<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            SqlConnection connection = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                connection = <span class="keyword">new</span> SqlConnection(connectionString);</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connection, <span class="literal">null</span>, commandType, commandText, commandParameters, SqlConnectionOwnership.Internal);</span><br><span class="line">            &#125;</span><br><span class="line">            catch</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// If we fail to return the SqlDatReader, we need to close the connection ourselves </span></span><br><span class="line">                <span class="keyword">if</span> (connection != <span class="literal">null</span>) connection.Close();</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(connString, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的数据阅读器. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库连接对象的数据阅读器,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, SqlConnectionOwnership.External);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库连接对象的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(conn, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>T存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库事务的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库事务的数据阅读器,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   SqlDataReader dr = ExecuteReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ExecuteReader(transaction.Connection, transaction, commandType, commandText, commandParameters, SqlConnectionOwnership.External);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [调用者方式]执行指定数据库事务的数据阅读器,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlDataReader dr = ExecuteReader(trans, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReader</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ExecuteReader数据阅读器</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteScalar 返回结果集中的第一行第一列</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(connString, CommandType.StoredProcedure, &quot;GetOrderCount&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteScalar(connectionString, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,指定参数,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(connString, CommandType.StoredProcedure, &quot;GetOrderCount&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connection, commandType, commandText, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,指定参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(connString, &quot;GetOrderCount&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(conn, CommandType.StoredProcedure, &quot;GetOrderCount&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteScalar(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定参数,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(conn, CommandType.StoredProcedure, &quot;GetOrderCount&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行SqlCommand命令,并返回结果. </span></span><br><span class="line">            <span class="built_in">object</span> retval = cmd.ExecuteScalar();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                connection.Close();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,指定参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(conn, &quot;GetOrderCount&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(trans, CommandType.StoredProcedure, &quot;GetOrderCount&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteScalar(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,指定参数,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(trans, CommandType.StoredProcedure, &quot;GetOrderCount&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行SqlCommand命令,并返回结果. </span></span><br><span class="line">            <span class="built_in">object</span> retval = cmd.ExecuteScalar();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,指定参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  int orderCount = (int)ExecuteScalar(trans, &quot;GetOrderCount&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalar</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// PPull the parameters for this stored procedure from the parameter cache () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteScalar(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ExecuteScalar</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteXmlReader XML阅读器 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的SqlCommand命令,并产生一个XmlReader对象做为结果集返回. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteXmlReader(connection, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlConnection connection, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                PrepareCommand(cmd, connection, (SqlTransaction)<span class="literal">null</span>, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">                <span class="comment">// 执行命令 </span></span><br><span class="line">                XmlReader retval = cmd.ExecuteXmlReader();</span><br><span class="line">                <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">                cmd.Parameters.Clear();</span><br><span class="line">                <span class="keyword">return</span> retval;</span><br><span class="line">            &#125;</span><br><span class="line">            catch</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                    connection.Close();</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(conn, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的SqlCommand命令,并产生一个XmlReader对象做为结果集返回. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 执行参数为空的方法 </span></span><br><span class="line">            <span class="keyword">return</span> ExecuteXmlReader(transaction, commandType, commandText, (SqlParameter[])<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句 using &quot;FOR XML AUTO&quot;<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlTransaction transaction, CommandType commandType, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行命令 </span></span><br><span class="line">            XmlReader retval = cmd.ExecuteXmlReader();</span><br><span class="line">            <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">            cmd.Parameters.Clear();</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的SqlCommand命令,并产生一个XmlReader对象做为结果集返回,指定参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  XmlReader r = ExecuteXmlReader(trans, &quot;GetOrders&quot;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReader</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                <span class="keyword">return</span> ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ExecuteXmlReader 阅读器结束</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> FillDataset 填充数据集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,映射数据表并填充数据集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType, <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                FillDataset(connection, commandType, commandText, dataSet, tableNames);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,映射数据表并填充数据集.指定命令参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                FillDataset(connection, commandType, commandText, dataSet, tableNames, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接字符串的命令,映射数据表并填充数据集,指定存储过程参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(connString, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, 24); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span>    </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建并打开数据库连接对象,操作完成释放对象. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Open();</span><br><span class="line">                <span class="comment">// 调用指定数据库连接字符串重载方法. </span></span><br><span class="line">                FillDataset(connection, spName, dataSet, tableNames, parameterValues);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,映射数据表并填充数据集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span>    </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(connection, commandType, commandText, dataSet, tableNames, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,映射数据表并填充数据集,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(connection, <span class="literal">null</span>, commandType, commandText, dataSet, tableNames, commandParameters);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库连接对象的命令,映射数据表并填充数据集,指定存储过程参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                FillDataset(connection, CommandType.StoredProcedure, spName, dataSet, tableNames, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                FillDataset(connection, CommandType.StoredProcedure, spName, dataSet, tableNames);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,映射数据表并填充数据集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(transaction, commandType, commandText, dataSet, tableNames, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,映射数据表并填充数据集,指定参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlTransaction transaction, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            FillDataset(transaction.Connection, transaction, commandType, commandText, dataSet, tableNames, commandParameters);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定数据库事务的命令,映射数据表并填充数据集,指定存储过程参数值. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此方法不提供访问存储过程输出参数和返回值参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(trans, &quot;GetOrders&quot;, ds, new string[]&#123;&quot;orders&quot;&#125;, 24, 36); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterValues&quot;&gt;</span>分配给存储过程输入参数的对象数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlTransaction transaction, <span class="built_in">string</span> spName,</span></span></span><br><span class="line"><span class="params"><span class="function">                    DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> <span class="built_in">object</span>[] parameterValues</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((parameterValues != <span class="literal">null</span>) &amp;&amp; (parameterValues.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 给存储过程参数赋值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, parameterValues);</span><br><span class="line">                <span class="comment">// 调用重载方法 </span></span><br><span class="line">                FillDataset(transaction, CommandType.StoredProcedure, spName, dataSet, tableNames, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 没有参数值 </span></span><br><span class="line">                FillDataset(transaction, CommandType.StoredProcedure, spName, dataSet, tableNames);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [私有方法][内部调用]执行指定数据库连接对象/事务的命令,映射数据表并填充数据集,DataSet/TableNames/SqlParameters. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  FillDataset(conn, trans, CommandType.StoredProcedure, &quot;GetOrders&quot;, ds, new string[] &#123;&quot;orders&quot;&#125;, new SqlParameter(&quot;@prodid&quot;, 24)); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandType&quot;&gt;</span>命令类型 (存储过程,命令文本或其它)<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名称或T-SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要填充结果集的DataSet实例<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableNames&quot;&gt;</span>表映射的数据表数组 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用户定义的表名 (可有是实际的表名.) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>分配给命令的SqlParamter参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FillDataset</span>(<span class="params">SqlConnection connection, SqlTransaction transaction, CommandType commandType,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="built_in">string</span> commandText, DataSet dataSet, <span class="built_in">string</span>[] tableNames,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (dataSet == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;dataSet&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlCommand命令,并进行预处理 </span></span><br><span class="line">            SqlCommand command = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">            <span class="built_in">bool</span> mustCloseConnection = <span class="literal">false</span>;</span><br><span class="line">            PrepareCommand(command, connection, transaction, commandType, commandText, commandParameters, <span class="keyword">out</span> mustCloseConnection);</span><br><span class="line">            <span class="comment">// 执行命令 </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter dataAdapter = <span class="keyword">new</span> SqlDataAdapter(command))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 追加表映射 </span></span><br><span class="line">                <span class="keyword">if</span> (tableNames != <span class="literal">null</span> &amp;&amp; tableNames.Length &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> tableName = <span class="string">&quot;Table&quot;</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="built_in">int</span> index = <span class="number">0</span>; index &lt; tableNames.Length; index++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (tableNames[index] == <span class="literal">null</span> || tableNames[index].Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The tableNames parameter must contain a list of tables, a value was provided as null or empty string.&quot;</span>, <span class="string">&quot;tableNames&quot;</span>);</span><br><span class="line">                        dataAdapter.TableMappings.Add(tableName, tableNames[index]);</span><br><span class="line">                        tableName += (index + <span class="number">1</span>).ToString();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 填充数据集使用默认表名称 </span></span><br><span class="line">                dataAdapter.Fill(dataSet);</span><br><span class="line">                <span class="comment">// 清除参数,以便再次使用. </span></span><br><span class="line">                command.Parameters.Clear();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (mustCloseConnection)</span><br><span class="line">                connection.Close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> UpdateDataset 更新数据集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行数据集更新到数据库,指定inserted, updated, or deleted命令. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  UpdateDataset(conn, insertCommand, deleteCommand, updateCommand, dataSet, &quot;Order&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;insertCommand&quot;&gt;</span>[追加记录]一个有效的T-SQL语句或存储过程<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;deleteCommand&quot;&gt;</span>[删除记录]一个有效的T-SQL语句或存储过程<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;updateCommand&quot;&gt;</span>[更新记录]一个有效的T-SQL语句或存储过程<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataSet&quot;&gt;</span>要更新到数据库的DataSet<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableName&quot;&gt;</span>要更新到数据库的DataTable<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UpdateDataset</span>(<span class="params">SqlCommand insertCommand, SqlCommand deleteCommand, SqlCommand updateCommand, DataSet dataSet, <span class="built_in">string</span> tableName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (insertCommand == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;insertCommand&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (deleteCommand == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;deleteCommand&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (updateCommand == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;updateCommand&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (tableName == <span class="literal">null</span> || tableName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;tableName&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建SqlDataAdapter,当操作完成后释放. </span></span><br><span class="line">            <span class="keyword">using</span> (SqlDataAdapter dataAdapter = <span class="keyword">new</span> SqlDataAdapter())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 设置数据适配器命令 </span></span><br><span class="line">                dataAdapter.UpdateCommand = updateCommand;</span><br><span class="line">                dataAdapter.InsertCommand = insertCommand;</span><br><span class="line">                dataAdapter.DeleteCommand = deleteCommand;</span><br><span class="line">                <span class="comment">// 更新数据集改变到数据库 </span></span><br><span class="line">                dataAdapter.Update(dataSet, tableName);</span><br><span class="line">                <span class="comment">// 提交所有改变到数据集. </span></span><br><span class="line">                dataSet.AcceptChanges();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> CreateCommand 创建一条SqlCommand命令 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建SqlCommand命令,指定数据库连接对象,存储过程名和参数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 示例:  </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>  SqlCommand command = CreateCommand(conn, &quot;AddCustomer&quot;, &quot;CustomerID&quot;, &quot;CustomerName&quot;); </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sourceColumns&quot;&gt;</span>源表的列名称数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlCommand命令<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlCommand <span class="title">CreateCommand</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="keyword">params</span> <span class="built_in">string</span>[] sourceColumns</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建命令 </span></span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand(spName, connection);</span><br><span class="line">            cmd.CommandType = CommandType.StoredProcedure;</span><br><span class="line">            <span class="comment">// 如果有参数值 </span></span><br><span class="line">            <span class="keyword">if</span> ((sourceColumns != <span class="literal">null</span>) &amp;&amp; (sourceColumns.Length &gt; <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 将源表的列到映射到DataSet命令中. </span></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> index = <span class="number">0</span>; index &lt; sourceColumns.Length; index++)</span><br><span class="line">                    commandParameters[index].SourceColumn = sourceColumns[index];</span><br><span class="line">                <span class="comment">// Attach the discovered parameters to the SqlCommand object </span></span><br><span class="line">                AttachParameters(cmd, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> cmd;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteNonQueryTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回受影响的行数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQueryTypedParams</span>(<span class="params">String connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回受影响的行数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQueryTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事物的存储过程,使用DataRow做为参数值,返回受影响的行数. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回影响的行数<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ExecuteNonQueryTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// Sf the row has values, the store procedure parameters must be initialized </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteNonQuery(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteDatasetTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDatasetTypedParams</span>(<span class="params"><span class="built_in">string</span> connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">//如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDatasetTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事务的存储过程,使用DataRow做为参数值,返回DataSet. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个包含结果集的DataSet.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ExecuteDatasetTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteDataset(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteReaderTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回DataReader. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReaderTypedParams</span>(<span class="params">String connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回DataReader. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReaderTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事物的存储过程,使用DataRow做为参数值,返回DataReader. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回包含结果集的SqlDataReader<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlDataReader <span class="title">ExecuteReaderTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteScalarTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接字符串的存储过程,使用DataRow做为参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalarTypedParams</span>(<span class="params">String connectionString, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connectionString, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connectionString, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connectionString, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalarTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事务的存储过程,使用DataRow做为参数值,返回结果集中的第一行第一列. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回结果集中的第一行第一列<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ExecuteScalarTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteScalar(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ExecuteXmlReaderTypedParams 类型化参数(DataRow) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库连接对象的存储过程,使用DataRow做为参数值,返回XmlReader类型的结果集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReaderTypedParams</span>(<span class="params">SqlConnection connection, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(connection, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(connection, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行指定连接数据库事务的存储过程,使用DataRow做为参数值,返回XmlReader类型的结果集. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transaction&quot;&gt;</span>一个有效的连接事务 object<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dataRow&quot;&gt;</span>使用DataRow作为参数值<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回XmlReader结果集对象.<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XmlReader <span class="title">ExecuteXmlReaderTypedParams</span>(<span class="params">SqlTransaction transaction, String spName, DataRow dataRow</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (transaction == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (transaction != <span class="literal">null</span> &amp;&amp; transaction.Connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;The transaction was rollbacked or commited, please provide an open transaction.&quot;</span>, <span class="string">&quot;transaction&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="comment">// 如果row有值,存储过程必须初始化. </span></span><br><span class="line">            <span class="keyword">if</span> (dataRow != <span class="literal">null</span> &amp;&amp; dataRow.ItemArray.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 从缓存中加载存储过程参数,如果缓存中不存在则从数据库中检索参数信息并加载到缓存中. () </span></span><br><span class="line">                SqlParameter[] commandParameters = SqlHelperParameterCache.GetSpParameterSet(transaction.Connection, spName);</span><br><span class="line">                <span class="comment">// 分配参数值 </span></span><br><span class="line">                AssignParameterValues(commandParameters, dataRow);</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName, commandParameters);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SqlHelper.ExecuteXmlReader(transaction, CommandType.StoredProcedure, spName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SqlHelperParameterCache提供缓存存储过程参数,并能够在运行时从存储过程中探索参数. </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">SqlHelperParameterCache</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 私有方法,字段,构造函数 </span></span><br><span class="line">        <span class="comment">// 私有构造函数,妨止类被实例化. </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">SqlHelperParameterCache</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 这个方法要注意 </span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Hashtable paramCache = Hashtable.Synchronized(<span class="keyword">new</span> Hashtable());</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 探索运行时的存储过程,返回SqlParameter参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 初始化参数值为 DBNull.Value. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名称<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span>是否包含返回值参数<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlParameter[] <span class="title">DiscoverSpParameterSet</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            SqlCommand cmd = <span class="keyword">new</span> SqlCommand(spName, connection);</span><br><span class="line">            cmd.CommandType = CommandType.StoredProcedure;</span><br><span class="line">            connection.Open();</span><br><span class="line">            <span class="comment">// 检索cmd指定的存储过程的参数信息,并填充到cmd的Parameters参数集中. </span></span><br><span class="line">            SqlCommandBuilder.DeriveParameters(cmd);</span><br><span class="line">            connection.Close();</span><br><span class="line">            <span class="comment">// 如果不包含返回值参数,将参数集中的每一个参数删除. </span></span><br><span class="line">            <span class="keyword">if</span> (!includeReturnValueParameter)</span><br><span class="line">            &#123;</span><br><span class="line">                cmd.Parameters.RemoveAt(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建参数数组 </span></span><br><span class="line">            SqlParameter[] discoveredParameters = <span class="keyword">new</span> SqlParameter[cmd.Parameters.Count];</span><br><span class="line">            <span class="comment">// 将cmd的Parameters参数集复制到discoveredParameters数组. </span></span><br><span class="line">            cmd.Parameters.CopyTo(discoveredParameters, <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 初始化参数值为 DBNull.Value. </span></span><br><span class="line">            <span class="keyword">foreach</span> (SqlParameter discoveredParameter <span class="keyword">in</span> discoveredParameters)</span><br><span class="line">            &#123;</span><br><span class="line">                discoveredParameter.Value = DBNull.Value;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> discoveredParameters;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> SqlParameter参数数组的深层拷贝. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;originalParameters&quot;&gt;</span>原始参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回一个同样的参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlParameter[] <span class="title">CloneParameters</span>(<span class="params">SqlParameter[] originalParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            SqlParameter[] clonedParameters = <span class="keyword">new</span> SqlParameter[originalParameters.Length];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>, j = originalParameters.Length; i &lt; j; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                clonedParameters[i] = (SqlParameter)((ICloneable)originalParameters[i]).Clone();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> clonedParameters;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> 私有方法,字段,构造函数结束</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 缓存方法</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 追加参数数组到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符串<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandParameters&quot;&gt;</span>要缓存的参数数组<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CacheParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> commandText, <span class="keyword">params</span> SqlParameter[] commandParameters</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandText == <span class="literal">null</span> || commandText.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;commandText&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> hashKey = connectionString + <span class="string">&quot;:&quot;</span> + commandText;</span><br><span class="line">            paramCache[hashKey] = commandParameters;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 从缓存中获取参数数组. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;commandText&quot;&gt;</span>存储过程名或SQL语句<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetCachedParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> commandText</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (commandText == <span class="literal">null</span> || commandText.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;commandText&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> hashKey = connectionString + <span class="string">&quot;:&quot;</span> + commandText;</span><br><span class="line">            SqlParameter[] cachedParameters = paramCache[hashKey] <span class="keyword">as</span> SqlParameter[];</span><br><span class="line">            <span class="keyword">if</span> (cachedParameters == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> CloneParameters(cachedParameters);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> 缓存方法结束</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 检索指定的存储过程的参数集</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 返回指定的存储过程的参数集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> GetSpParameterSet(connectionString, spName, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 返回指定的存储过程的参数集 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connectionString&quot;&gt;</span>一个有效的数据库连接字符.<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span>是否包含返回值参数<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params"><span class="built_in">string</span> connectionString, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectionString == <span class="literal">null</span> || connectionString.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connectionString&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="keyword">using</span> (SqlConnection connection = <span class="keyword">new</span> SqlConnection(connectionString))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> GetSpParameterSetInternal(connection, spName, includeReturnValueParameter);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [内部]返回指定的存储过程的参数集(使用连接对象). </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接字符<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> GetSpParameterSet(connection, spName, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [内部]返回指定的存储过程的参数集(使用连接对象) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 这个方法将查询数据库,并将信息存储到缓存. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 是否包含返回值参数 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSet</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">using</span> (SqlConnection clonedConnection = (SqlConnection)((ICloneable)connection).Clone())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> GetSpParameterSetInternal(clonedConnection, spName, includeReturnValueParameter);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> [私有]返回指定的存储过程的参数集(使用连接对象) </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;connection&quot;&gt;</span>一个有效的数据库连接对象<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;spName&quot;&gt;</span>存储过程名<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;includeReturnValueParameter&quot;&gt;</span>是否包含返回值参数<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回SqlParameter参数数组<span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlParameter[] <span class="title">GetSpParameterSetInternal</span>(<span class="params">SqlConnection connection, <span class="built_in">string</span> spName, <span class="built_in">bool</span> includeReturnValueParameter</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;connection&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (spName == <span class="literal">null</span> || spName.Length == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">&quot;spName&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> hashKey = connection.ConnectionString + <span class="string">&quot;:&quot;</span> + spName + (includeReturnValueParameter ? <span class="string">&quot;:include ReturnValue Parameter&quot;</span> : <span class="string">&quot;&quot;</span>);</span><br><span class="line">            SqlParameter[] cachedParameters;</span><br><span class="line">            cachedParameters = paramCache[hashKey] <span class="keyword">as</span> SqlParameter[];</span><br><span class="line">            <span class="keyword">if</span> (cachedParameters == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                SqlParameter[] spParameters = DiscoverSpParameterSet(connection, spName, includeReturnValueParameter);</span><br><span class="line">                paramCache[hashKey] = spParameters;</span><br><span class="line">                cachedParameters = spParameters;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> CloneParameters(cachedParameters);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> 参数集检索结束</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CSarp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> .NET </tag>
            
            <tag> CSarp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用端口及范围</title>
      <link href="/2021/06/12/a0e2f68c42a4/"/>
      <url>/2021/06/12/a0e2f68c42a4/</url>
      
        <content type="html"><![CDATA[<h3 id="端口范围"><a href="#端口范围" class="headerlink" title="端口范围"></a>端口范围</h3><p>一般用到的是1到65535，其中0一般不使用。端口号可分为3大类：<br>1、公认端口（Well Known Ports）：从0到1023，它们紧密绑定（binding）于一些服务。通常这些端口的通讯明确表明了某种服务的协议。例如：80端口实际上总是HTTP通讯。<br>2、注册端口（Registered Ports）：从1024到49151。它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。<br>3、动态和/或私有端口（Dynamic and/or Private Ports）：从49152到65535。理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</p><h3 id="常用版"><a href="#常用版" class="headerlink" title="常用版"></a>常用版</h3><p>21：FTP服务所开放的端口，用于上传、下载文件。<br>22：SSH端口，用于通过命令行模式远程连接Linux服务器或vps。<br>23：Telnet端口，用于Telnet远程登录服务器。<br>25：SMTP服务所开放的端口，用于发送邮件。<br>80：HTTP用于HTTP服务提供访问功能，例如，IIS、Apache、Nginx 等服务。<br>110：POP3用于POP3 协议，POP3 是电子邮件收发的协议。<br>143：IMAP用于IMAP（Internet Message Access Protocol）协议，IMAP 是用于电子邮件的接收的协议。<br>443：HTTPS 用于HTTPS服务提供访问功能。HTTPS 是一种能提供加密和通过安全端口传输的一种协议。<br>1433：SQL Server SQL Server的TCP 端口，用于供SQL Server对外提供服务。<br>1434：SQL Server SQL Server的UDP端口，用于返回SQL Server使用了哪个 TCP/IP 端口。<br>1521：Oracle通信端口，服务器上部署了Oracle SQL需要放行的端口。<br>3306：MySQL数据库对外提供服务的端口。<br>3389：远程桌面服务端口，可以通过这个端口远程连接服务器。<br>8080：代理端口,同80端口一样，8080 端口常用于WWW代理服务，实现网页浏览。</p><h3 id="简易版"><a href="#简易版" class="headerlink" title="简易版"></a>简易版</h3><p>0 端口：无效端口,通常用于分析操作系统<br>1 端口：传输控制协议端口服务多路开关选择器<br>2 端口：管理实用程序<br>3 端口：压缩进程<br>5 端口：远程作业登录<br>7 端口：回显<br>9 端口：丢弃<br>11 端口：在线用户<br>13 端口：时间<br>17 端口：每日引用<br>18 端口：消息发送协议<br>19 端口：字符发生器<br>20 端口：FTP 文件传输协议(默认数据口)<br>21 端口：FTP 文件传输协议(控制)<br>22 端口：SSH 远程登录协议<br>23 端口：telnet(终端仿真协议),木马 Tiny Telnet Server 开放此端口<br>24 端口：预留给个人用邮件系统<br>25 端口：SMTP 服务器所开放的端口，用于发送邮件<br>27 端口：NSW 用户系统 FE<br>29 端口：MSG ICP<br>31 端口：MSG 验证,木马 Master Paradise、HackersParadise 开放此端口<br>33 端口：显示支持协议<br>35 端口：预留给个人打印机服务<br>37 端口：时间<br>38 端口：路由访问协议<br>39 端口：资源定位协议<br>41 端口：图形<br>42 端口：主机名服务<br>43 端口：who is 服务<br>44 端口：MPM(消息处理模块)标志协议<br>45 端口：消息处理模块<br>46 端口：消息处理模块(默认发送口)<br>47 端口：NI FTP<br>48 端口：数码音频后台服务<br>49 端口：TACACS 登录主机协议<br>50 端口：远程邮件检查协议<br>51 端口：IMP(接口信息处理机)逻辑地址维护<br>52 端口：施乐网络服务系统时间协议<br>53 端口：dns 域名服务器<br>54 端口：施乐网络服务系统票据交换<br>55 端口：ISI 图形语言<br>56 端口：施乐网络服务系统验证<br>57 端口：预留个人用终端访问<br>58 端口：施乐网络服务系统邮件<br>59 端口：预留个人文件服务<br>60 端口：未定义<br>61 端口：NI 邮件<br>62 端口：异步通讯适配器服务<br>63 端口：whois++<br>64 端口：通讯接口<br>65 端口：TACACS 数据库服务<br>66 端口：Oracle SQL*NET<br>67 端口：引导程序协议服务端<br>68 端口：引导程序协议客户端<br>69 端口：小型文件传输协议<br>70 端口：信息检索协议<br>71 端口：远程作业服务<br>72 端口：远程作业服务<br>73 端口：远程作业服务<br>74 端口：远程作业服务<br>75 端口：预留给个人拨出服务<br>76 端口：分布式外部对象存储<br>77 端口：预留给个人远程作业输入服务<br>78 端口：修正 TCP<br>79 端口：查询远程主机在线用户等信息<br>80 端口：http,用于网页浏览,木马 Executor 开放此端口<br>81 端口：HOST2 名称服务<br>82 端口：传输实用程序<br>83 端口：模块化智能终端 ML 设备<br>84 端口：公用追踪设备<br>85 端口：模块化智能终端 ML 设备<br>86 端口：Micro Focus Cobol 编程语言<br>87 端口：预留给个人终端连接<br>88 端口：Kerberros 安全认证系统<br>89 端口：SU/MIT telnet(终端仿真网关)<br>90 端口：DNSIX 安全属性标记图<br>91 端口：MIT Dover 假脱机<br>92 端口：网络打印协议<br>93 端口：设备控制协议<br>94 端口：Tivoli 对象调度<br>96 端口：DIXIE 协议规范<br>97 端口：快速远程虚拟文件协议<br>98 端口：TAC 新闻协议<br>99 端口：后门程序 ncx99 开放此端口<br>100 端口：未知用途<br>101 端口：NIC 主机名称服务<br>102 端口：消息传输代理<br>103 端口：Genesis 点对点传输网络<br>105 端口：信箱名称服务<br>106 端口：3COM-TSMUX 开放端口<br>107 端口：远程 Telnet 服务<br>108 端口：SNA 网关访问服务<br>109 端口：POP2 服务器开放此端口,用于接收邮件<br>110 端口：POP3 服务器开放此端口,用于接收邮件<br>111 端口：SUN 公司的 RPC 服务所有端口<br>112 端口：McIDAS 数据传输协议<br>113 端口：认证服务，用于鉴别 TCP 连接的用户<br>114 端口：音频新闻多点服务<br>115 端口：简单文件传输服务<br>116 端口：ANSA REX 通知<br>117 端口：UUCP 路径服务<br>118 端口：SQL 服务<br>119 端口：NEWS 新闻组传输协议，承载 USENET 通信<br>121 端口：木马 BO jammerkillahV 开放端口<br>122 端口：SMAKY 网络<br>123 端口：网络时间协议，蠕虫病毒会利用，一般关闭<br>128 端口：GSS X 许可认证<br>129 端口：密码生成器协议<br>130 端口：Cisco 软件开放端口<br>131 端口：Cisco 软件开放端口<br>132 端口：Cisco 软件开放端口<br>133 端口：统计服务<br>134 端口：INGRES-网络服务<br>135 端口：DCOM 服务，冲击波病毒利用，不能关闭<br>136 端口：命名系统<br>137 端口：NETBIOS 协议应用，为共享开放<br>138 端口：NETBIOS 协议应用，为共享开放<br>139 端口：NETBIOS 协议应用，为共享开放<br>140 端口：EMFIS 数据服务<br>141 端口：EMFIS 控制服务<br>143 端口：Interim 邮件访问协议<br>144 端口：UMA 软件开放端口<br>145 端口：UAAC 协议<br>149 端口：AED 512 仿真服务<br>150 端口：SQL(结构化查询语言)-网络<br>152 端口：后台文件传输协议<br>156 端口：SQL(结构化查询语言)服务<br>158 端口：PC 邮件服务器<br>159 端口：NSS-路由<br>160 端口：SGMP-陷阱<br>161 端口：简单网络管理协议<br>162 端口：SNMP 陷阱<br>163 端口：CMIP/TCP 管理<br>164 端口：CMIP/TCP 代理<br>166 端口：Sirius 系统<br>169 端口：发送<br>170 端口：网络附言<br>177 端口：x 显示管理控制协议，入侵者通过它访问 X-windows 操作台<br>178 端口：NextStep Window 服务<br>179 端口：边界网关协议<br>180 端口：图表<br>181 端口：统一<br>184 端口：OC 服务器<br>185 端口：远程-KIS<br>186 端口：KIS 协议<br>187 端口：应用通信接口<br>189 端口：队列文件传输<br>190 端口：网关进入控制协议<br>191 端口：Prospero 目录服务<br>192 端口：OSU 网络监视系统<br>193 端口：Spider 远程控制协议<br>194 端口：多线交谈协议<br>197 端口：目录地址服务<br>198 端口：目录地址服务监视器<br>200 端口：IBM 系统资源控制器<br>201 端口：AppleTalk(Mac 机所用的网络协议)路由保证<br>202 端口：AppleTalk(Mac 机所用的网络协议)Name Binding<br>203 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>204 端口：AppleTalk(Mac 机所用的网络协议)回显<br>205 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>206 端口：AppleTalk(Mac 机所用的网络协议)区信息<br>207 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>208 端口：AppleTalk(Mac 机所用的网络协议)未用端口<br>209 端口：快速邮件传输协议<br>210 端口：ANSI(美国国家标准协会)Z39.50<br>211 端口：Texas Instruments 914C/G 终端<br>213 端口：IPX(以太网所用的协议)<br>218 端口：Netix 消息记录协议<br>219 端口：Unisys ARPs<br>220 端口：交互邮件访问协议 v3<br>223 端口：证书分发中心<br>224 端口：masq 拨号器<br>241 端口：预留端口 (224-241)<br>245 端口：链接<br>246 端口：显示系统协议<br>257 端口：安全电子交易系统<br>258 端口：Yak Winsock 个人聊天<br>259 端口：有效短程遥控<br>260 端口：开放端口<br>261 端口：IIOP 基于 TLS/SSL 的命名服务<br>266 端口：SCSI(小型计算机系统接口)on ST<br>267 端口：Tobit David 服务层<br>268 端口：Tobit David 复制<br>281 端口：个人连结<br>282 端口：Cable 端口 A/X<br>286 端口：FXP 通信<br>308 端口：Novastor 备份<br>313 端口：Magenta 逻辑<br>318 端口：PKIX 时间标记<br>333 端口：Texar 安全端口<br>344 端口：Prospero 数据存取协议<br>345 端口：Perf 分析工作台<br>346 端口：Zebra 服务器<br>347 端口：Fatmen 服务器<br>348 端口：Cabletron 管理协议<br>358 端口：Shrink 可上网家电协议<br>359 端口：网络安全风险管理协议<br>362 端口：SRS 发送<br>363 端口：RSVP 隧道<br>372 端口：列表处理<br>373 端口：Legend 公司<br>374 端口：Legend 公司<br>376 端口：AmigaEnvoy 网络查询协议<br>377 端口：NEC 公司<br>378 端口：NEC 公司<br>379 端口：TIA/EIA/IS-99 调制解调器客户端<br>380 端口：TIA/EIA/IS-99 调制解调器服务器<br>381 端口：hp(惠普)性能数据收集器<br>382 端口：hp(惠普)性能数据控制节点<br>383 端口：hp(惠普)性能数据警报管理<br>384 端口：远程网络服务器系统<br>385 端口：IBM 应用程序<br>386 端口：ASA 信息路由器定义文件.<br>387 端口：Appletalk 更新路由.<br>389 端口：轻型目录访问协议<br>395 端口：网络监视控制协议<br>396 端口：Novell(美国 Novell 公司)Netware(Novell 公司出的网络操作系统)over IP<br>400 端口：工作站解决方案<br>401 端口：持续电源<br>402 端口：Genie 协议<br>406 端口：交互式邮件支持协议<br>408 端口：Prospero 资源管理程序<br>409 端口：Prospero 资源节点管理.<br>410 端口：DEC(数据设备公司)远程调试协议<br>411 端口：远程 MT 协议<br>412 端口：陷阱协定端口<br>413 端口：存储管理服务协议<br>414 端口：信息查询<br>415 端口：B 网络<br>423 端口：IBM 操作计划和控制开端<br>424 端口：IBM 操作计划和控制追踪<br>425 端口：智能计算机辅助设计<br>427 端口：服务起位置<br>434 端口：移动 ip 代理<br>435 端口：移动 ip 管理<br>443 端口：基于 TLS/SSL 的网页浏览端口，能提供加密和通过安全端口传输的另一种 HTTP<br>444 端口：简单网络内存分页协议<br>445 端口：Microsoft-DS，为共享开放，震荡波病毒利用，一般应关闭<br>446 端口：DDM-远程关系数据库访问<br>447 端口：DDM-分布式文件管理<br>448 端口：DDM-使用安全访问远程数据库<br>456 端口：木马 HACKERS PARADISE 开放此端口<br>458 端口：apple quick time 软件开放端口<br>459 端口：ampr-rcmd 命令<br>464 端口：k 密码服务<br>469 端口：广播控制协议<br>470 端口：scx-代理<br>472 端口：ljk-登陆<br>481 端口：Ph 服务<br>487 端口：简单异步文件传输<br>489 端口：nest-协议<br>491 端口：go-登陆<br>499 端口：ISO ILL 协议<br>500 端口：Internet 密钥交换，Lsass 开放端口，不能关闭<br>509 端口：陷阱<br>510 端口：FirstClass 协议<br>512 端口：远程进程执行<br>513 端口：远程登陆<br>514 端口：cmd 命令<br>515 端口：spooler<br>516 端口：可视化数据<br>518 端口：交谈<br>519 端口：unix 时间<br>520 端口：扩展文件名称服务器<br>525 端口：时间服务<br>526 端口：新日期<br>529 端口：在线聊天系统服务<br>530 端口：远程过程调用<br>531 端口：聊天<br>532 端口：读新闻<br>533 端口：紧急广播端口<br>534 端口：MegaMedia 管理端<br>537 端口：网络流媒体协议<br>542 端口：商业<br>543 端口：Kerberos(软件)v4/v5<br>544 端口：krcmd 命令<br>546 端口：DHCPv6 客户端<br>547 端口：DHCPv6 服务器<br>552 端口：设备共享<br>554 端口：Real Time Stream 控制协议<br>555 端口：木马 PhAse1.0、Stealth Spy、IniKiller 开放此端口<br>556 端口：远距离文件服务器<br>563 端口：基于 TLS/SSL 的网络新闻传输协议<br>564 端口：plan 9 文件服务<br>565 端口：whoami 查询<br>566 端口：streettalk<br>567 端口：banyan-rpc(远程过程调用)<br>568 端口：DPA 成员资格<br>569 端口：MSN 成员资格<br>570 端口：demon(调试监督程序)<br>571 端口：udemon(调试监督程序)<br>572 端口：声纳<br>573 端口：banyan-贵宾<br>574 端口：FTP 软件代理系统<br>581 端口：Bundle Discovery 协议<br>582 端口：SCC 安全<br>583 端口：Philips 视频会议<br>584 端口：密钥服务器<br>585 端口：IMAP4+SSL (Use 993 instead)<br>586 端口：密码更改<br>587 端口：申请<br>589 端口：Eye 连结<br>595 端口：CAB 协议<br>597 端口：PTC 名称服务<br>598 端口：SCO 网络服务器管理 3<br>599 端口：Aeolon Core 协议<br>600 端口：Sun IPC(进程间通讯)服务器<br>601 端口：可靠系统登陆服务<br>604 端口：通道<br>606 端口：Cray 统一资源管理<br>608 端口：发送人-传递/提供 文件传输器<br>609 端口：npmp-陷阱<br>610 端口：npmp-本地<br>611 端口：npmp-gui( 图形用户界面)<br>612 端口：HMMP 指引<br>613 端口：HMMP 操作<br>614 端口：SSL(加密套接字协议层)shell(壳)<br>615 端口：Internet 配置管理<br>616 端口：SCO(Unix 系统)系统管理服务器<br>617 端口：SCO 桌面管理服务器<br>619 端口：Compaq(康柏公司)EVM<br>620 端口：SCO 服务器管理<br>623 端口：ASF 远程管理控制协议<br>624 端口：Crypto 管理<br>631 端口：IPP (Internet 打印协议)<br>633 端口：服务更新(Sterling 软件)<br>637 端口：局域网服务器<br>641 端口：repcmd 命令<br>647 端口：DHCP(动态主机配置协议)Failover<br>648 端口：注册登记协议(RRP)<br>649 端口：Cadview-3d 软件协议<br>666 端口：木马 Attack FTP、Satanz Backdoor 开放此端口<br>808 端口：ccproxy http/gopher/ftp (over http)协议<br>1001 端口：木马 Silencer，WebEx 开放端口<br>1011 端口：木马 Doly 开放端口<br>1024 端口：动态端口的开始,木马 yai 开放端口<br>1025 端口：inetinfo.exe(互联网信息服务)木马 netspy 开放端口<br>1026 端口：inetinfo.exe(互联网信息服务)<br>1027 端口：应用层网关服务<br>1030 端口：应用层网关服务<br>1031 端口：BBN IAD<br>1033 端口：本地网络信息端口<br>1034 端口：同步通知<br>1036 端口：安全部分传输协议<br>1070 端口：木马 Psyber Stream，Streaming Audio 开放端口<br>1071 端口：网络服务开放端口<br>1074 端口：网络服务开放端口<br>1080 端口：Socks 这一协议以通道方式穿过防火墙，允许防火墙后面的人通过一个 IP 地址访问 INTERNET<br>1110 端口：卡巴斯基反病毒软件开放此端口<br>1125 端口：卡巴斯基反病毒软件开放此端口<br>1203 端口：许可证生效端口<br>1204 端口：登陆请求监听端口<br>1206 端口：Anthony 数据端口<br>1222 端口：SNI R&amp;D 网络端口<br>1233 端口：普遍的附录服务器端口<br>1234 端口：木马 SubSeven2.0、Ultors Trojan 开放此端口<br>1243 端口：木马 SubSeven1.0/1.9 开放此端口<br>1245 端口：木马 Vodoo，GabanBus，NetBus，Vodoo 开放此端口<br>1273 端口：EMC-网关端口<br>1289 端口：JWalk 服务器端口<br>1290 端口：WinJa 服务器端口<br>1333 端口：密码策略(网络服务)(svchost.exe)<br>1334 端口：网络服务(svchost.exe)<br>1335 端口：数字公正协议<br>1336 端口：即时聊天协议(svchost.exe)<br>1349 端口：注册网络协议端口<br>1350 端口：注册网络协议端口<br>1352 端口：tcp lotusnote lotus note<br>1371 端口：富士通配置协议端口<br>1372 端口：富士通配置协议端口<br>1374 端口：EPI 软件系统端口<br>1376 端口：IBM 个人-个人软件端口<br>1377 端口：Cichlid 许可证管理端口<br>1378 端口：Elan 许可证管理端口<br>1380 端口：Telesis 网络许可证管理端口<br>1381 端口：苹果网络许可证管理端口<br>1386 端口：CheckSum 许可证管理端口<br>1387 端口：系统开放端口(rundll32.exe)<br>1388 端口：数据库高速缓存端口<br>1389 端口：文档管理端口<br>1390 端口：存储控制器端口<br>1391 端口：存储器存取服务器端口<br>1392 端口：打印管理端口<br>1393 端口：网络登陆服务器端口<br>1394 端口：网络登陆客户端端口<br>1395 端口：PC 工作站管理软件端口<br>1396 端口：DVL 活跃邮件端口<br>1397 端口：音频活跃邮件端口<br>1398 端口：视频活跃邮件端口<br>1399 端口：Cadkey 许可证管理端口<br>1433 端口：Microsoft 的 SQL 服务开放端口<br>1434 端口：Microsoft 的 SQL 服务监视端口<br>1492 端口：木马 FTP99CMP 开放此端口<br>1509 端口：木马 Psyber Streaming Server 开放此端口<br>1512 端口：Microsoft Windows 网络名称服务<br>1524 端口：许多攻击脚本安装一个后门 SHELL 于这个端口<br>1600 端口：木马 Shivka-Burka 开放此端口<br>1645 端口：远程认证拨号用户服务<br>1701 端口：第 2 层隧道协议<br>1731 端口：NetMeeting 音频调用控制<br>1801 端口：Microsoft 消息队列服务器<br>1807 端口：木马 SpySender 开放此端口<br>1900 端口：可被利用 ddos 攻击，一般关闭<br>1912 端口：金山词霸开放此端口<br>1981 端口：木马 ShockRave 开放此端口<br>1999 端口：木马 BackDoor,yai 开放此端口<br>2000 端口：木马 GirlFriend 1.3、Millenium 1.0 开放此端口<br>2001 端口：木马 Millenium 1.0、Trojan Cow,黑洞 2001 开放此端口<br>2003 端口：GNU 查询<br>2023 端口：木马 Pass Ripper 开放此端口<br>2049 端口：NFS 程序常运行于此端口<br>2115 端口：木马 Bugs 开放此端口<br>2140 端口：木马 Deep Throat 1.0/3.0，The Invasor 开放此端口<br>2500 端口：应用固定端口会话复制的 RPC 客户<br>2504 端口：网络平衡负荷<br>2565 端口：木马 Striker 开放此端口<br>2583 端口：木马 Wincrash 2.0 开放此端口<br>2801 端口：木马 Phineas Phucker 开放此端口<br>2847 端口：诺顿反病毒服务开放此端口<br>3024 端口：木马 WinCrash 开放此端口<br>3128 端口：squid http 代理服务器开放此端口<br>3129 端口：木马 Master Paradise 开放此端口<br>3150 端口：木马 The Invasor,deep throat 开放此端口<br>3210 端口：木马 SchoolBus 开放此端口<br>3306 端口：MySQL 开放此端口<br>3333 端口：木马 Prosiak 开放此端口<br>3389 端口：WINDOWS 2000 终端开放此端口<br>3456 端口：inetinfo.exe(互联网信息服务)开放端口，VAT 默认数据<br>3457 端口：VAT 默认控制<br>3527 端口：Microsoft 消息队列服务器<br>3700 端口：木马 Portal of Doom 开放此端口<br>3996 端口：木马 RemoteAnything 开放此端口<br>4000 端口：腾讯 QQ 客户端开放此端口<br>4060 端口：木马 RemoteAnything 开放此端口<br>4092 端口：木马 WinCrash 开放此端口<br>4133 端口：NUTS Bootp 服务器<br>4134 端口：NIFTY-Serve HMI 协议<br>4141 端口：Workflow 服务器<br>4142 端口：文档服务器<br>4143 端口：文档复制<br>4145 端口：VVR 控制<br>4321 端口：远程 Who Is 查询<br>4333 端口：微型 sql 服务器<br>4349 端口：文件系统端口记录<br>4350 端口：网络设备<br>4351 端口：PLCY 网络服务<br>4453 端口：NSS 警报管理<br>4454 端口：NSS 代理管理<br>4455 端口：PR 聊天用户<br>4456 端口：PR 聊天服务器<br>4457 端口：PR 注册<br>4480 端口：Proxy+ HTTP 代理端口<br>4500 端口：Lsass 开放端口，不能关闭<br>4547 端口：Lanner 许可管理<br>4555 端口：RSIP 端口<br>4590 端口：木马 ICQTrojan 开放此端口<br>4672 端口：远程文件访问服务器<br>4752 端口：简单网络音频服务器<br>4800 端口：Icona 快速消息系统<br>4801 端口：Icona 网络聊天<br>4802 端口：Icona 许可系统服务器<br>4848 端口：App 服务器-Admin HTTP<br>4849 端口：App 服务器-Admin HTTPS<br>4950 端口：木马 IcqTrojan 开放 5000 端口<br>5000 端口：木马 blazer5，Sockets de Troie 开放 5000 端口，一般应关闭<br>5001 端口：木马 Sockets de Troie 开放 5001 端口<br>5006 端口：wsm 服务器<br>5007 端口：wsm 服务器 ssl<br>5022 端口：mice 服务器<br>5050 端口：多媒体会议控制协议<br>5051 端口：ITA 代理<br>5052 端口：ITA 管理<br>5137 端口：MyCTS 服务器端口<br>5150 端口：Ascend 通道管理协议<br>5154 端口：BZFlag 游戏服务器<br>5190 端口：America-Online(美国在线)<br>5191 端口：AmericaOnline1(美国在线)<br>5192 端口：AmericaOnline2(美国在线)<br>5193 端口：AmericaOnline3(美国在线)<br>5222 端口：Jabber 客户端连接<br>5225 端口：HP(惠普公司)服务器<br>5226 端口：HP(惠普公司)<br>5232 端口：SGI 绘图软件端口<br>5250 端口：i 网关<br>5264 端口：3Com 网络端口 1<br>5265 端口：3Com 网络端口 2<br>5269 端口：Jabber 服务器连接<br>5306 端口：Sun MC 组<br>5321 端口：木马 Sockets de Troie 开放 5321 端口<br>5400 端口：木马 Blade Runner 开放此端口<br>5401 端口：木马 Blade Runner 开放此端口<br>5402 端口：木马 Blade Runner 开放此端口<br>5405 端口：网络支持<br>5409 端口：Salient 数据服务器<br>5410 端口：Salient 用户管理<br>5415 端口：NS 服务器<br>5416 端口：SNS 网关<br>5417 端口：SNS 代理<br>5421 端口：网络支持 2<br>5423 端口：虚拟用户<br>5427 端口：SCO-PEER-TTA(Unix 系统)<br>5432 端口：PostgreSQL 数据库<br>5550 端口：木马 xtcp 开放此端口<br>5569 端口：木马 Robo-Hack 开放此端口<br>5599 端口：公司远程安全安装<br>5600 端口：公司安全管理<br>5601 端口：公司安全代理<br>5631 端口：pcANYWHERE(软件)数据<br>5632 端口：pcANYWHERE(软件)数据<br>5673 端口：JACL 消息服务器<br>5675 端口：V5UA 应用端口<br>5676 端口：RA 管理<br>5678 端口：远程复制代理连接<br>5679 端口：直接电缆连接<br>5720 端口：MS-执照<br>5729 端口：Openmail 用户代理层<br>5730 端口：Steltor’s 日历访问<br>5731 端口：netscape(网景)suiteware<br>5732 端口：netscape(网景)suiteware<br>5742 端口：木马 WinCrash1.03 开放此端口<br>5745 端口：fcopy-服务器<br>5746 端口：fcopys-服务器<br>5755 端口：OpenMail(邮件服务器)桌面网关服务器<br>5757 端口：OpenMail(邮件服务器)X.500 目录服务器<br>5766 端口：OpenMail (邮件服务器)NewMail 服务器<br>5767 端口：OpenMail (邮件服务器)请求代理曾(安全)<br>5768 端口：OpenMail(邮件服务器) CMTS 服务器<br>5777 端口：DALI 端口<br>5800 端口：虚拟网络计算<br>5801 端口：虚拟网络计算<br>5802 端口：虚拟网络计算 HTTP 访问, d<br>5803 端口：虚拟网络计算 HTTP 访问, d<br>5900 端口：虚拟网络计算机显示 0<br>5901 端口：虚拟网络计算机显示 1<br>5902 端口：虚拟网络计算机显示 2<br>5903 端口：虚拟网络计算机显示 3<br>6000 端口：X Window 系统<br>6001 端口：X Window 服务器<br>6002 端口：X Window 服务器<br>6003 端口：X Window 服务器<br>6004 端口：X Window 服务器<br>6005 端口：X Window 服务器<br>6006 端口：X Window 服务器<br>6007 端口：X Window 服务器<br>6008 端口：X Window 服务器<br>6009 端口：X Window 服务器<br>6456 端口：SKIP 证书发送<br>6471 端口：LVision 许可管理器<br>6505 端口：BoKS 管理私人端口<br>6506 端口：BoKS 管理公共端口<br>6507 端口：BoKS Dir 服务器,私人端口<br>6508 端口：BoKS Dir 服务器,公共端口<br>6509 端口：MGCS-MFP 端口<br>6510 端口：MCER 端口<br>6566 端口：SANE 控制端口<br>6580 端口：Parsec 主服务器<br>6581 端口：Parsec 对等网络<br>6582 端口：Parsec 游戏服务器<br>6588 端口：AnalogX HTTP 代理端口<br>6631 端口：Mitchell 电信主机<br>6667 端口：Internet 多线交谈<br>6668 端口：Internet 多线交谈<br>6670 端口：木马 Deep Throat 开放此端口<br>6671 端口：木马 Deep Throat 3.0 开放此端口<br>6699 端口：Napster 文件(MP3)共享服务<br>6701 端口：KTI/ICAD 名称服务器<br>6788 端口：SMC 软件-HTTP<br>6789 端口：SMC 软件-HTTPS<br>6841 端口：Netmo 软件默认开放端口<br>6842 端口：Netmo HTTP 服务<br>6883 端口：木马 DeltaSource 开放此端口<br>6939 端口：木马 Indoctrination 开放此端口<br>6969 端口：木马 Gatecrasher、Priority 开放此端口<br>6970 端口：real 音频开放此端口<br>7000 端口：木马 Remote Grab 开放此端口<br>7002 端口：使用者&amp; 组 数据库<br>7003 端口：音量定位数据库<br>7004 端口：AFS/Kerberos 认证服务<br>7005 端口：音量管理服务<br>7006 端口：错误解释服务<br>7007 端口：Basic 监督进程<br>7008 端口：服务器-服务器更新程序<br>7009 端口：远程缓存管理服务<br>7011 端口：Talon 软件发现端口<br>7012 端口：Talon 软件引擎<br>7013 端口：Microtalon 发现<br>7014 端口：Microtalon 通信<br>7015 端口：Talon 网络服务器<br>7020 端口：DP 服务<br>7021 端口：DP 服务管理<br>7100 端口：X 字型服务<br>7121 端口：虚拟原型许可证管理<br>7300 端口：木马 NetMonitor 开放此端口<br>7301 端口：木马 NetMonitor 开放此端口<br>7306 端口：木马 NetMonitor，NetSpy1.0 开放此端口<br>7307 端口：木马 NetMonitor 开放此端口<br>7308 端口：木马 NetMonitor 开放此端口<br>7323 端口：Sygate 服务器端<br>7511 端口：木马聪明基因开放此端口<br>7588 端口：Sun 许可证管理<br>7597 端口：木马 Quaz 开放此端口<br>7626 端口：木马冰河开放此端口<br>7633 端口：PMDF 管理<br>7674 端口：iMQ SSL 通道<br>7675 端口：iMQ 通道<br>7676 端口：木马 Giscier 开放此端口<br>7720 端口：Med 图象入口<br>7743 端口：Sakura 脚本传递协议<br>7789 端口：木马 ICKiller 开放此端口<br>7797 端口：Propel 连接器端口<br>7798 端口：Propel 编码器端口<br>8000 端口：腾讯 QQ 服务器端开放此端口<br>8001 端口：VCOM 通道<br>8007 端口：Apache(类似 iis)jServ 协议 1.x<br>8008 端口：HTTP Alternate<br>8009 端口：Apache(类似 iis)JServ 协议 1.3<br>8010 端口：Wingate 代理开放此端口<br>8011 端口：木马 way2.4 开放此端口<br>8022 端口：OA-系统<br>8080 端口：WWW 代理开放此端口<br>8081 端口：ICECap 控制台<br>8082 端口：BlackIce(防止黑客软件)警报发送到此端口<br>8118 端口：Privoxy HTTP 代理<br>8121 端口：Apollo 数据端口<br>8122 端口：Apollo 软件管理端口<br>8181 端口：Imail<br>8225 端口：木马灰鸽子开放此端口<br>8311 端口：木马初恋情人开放此端口<br>8351 端口：服务器寻找<br>8416 端口：eSpeech Session 协议<br>8417 端口：eSpeech RTP 协议<br>8473 端口：虚拟点对点<br>8668 端口：网络地址转换<br>8786 端口：Message 客户端<br>8787 端口：Message 服务器<br>8954 端口：Cumulus 管理端口<br>9000 端口：CS 监听<br>9001 端口：ETL 服务管理<br>9002 端口：动态 id 验证<br>9021 端口：Pangolin 验证<br>9022 端口：PrivateArk 远程代理<br>9023 端口：安全网络登陆-1<br>9024 端口：安全网络登陆-2<br>9025 端口：安全网络登陆-3<br>9026 端口：安全网络登陆-4<br>9101 端口：Bacula 控制器<br>9102 端口：Bacula 文件后台<br>9103 端口：Bacula 存储邮件后台<br>9111 端口：DragonIDS 控制台<br>9217 端口：FSC 通讯端口<br>9281 端口：软件传送端口 1<br>9282 端口：软件传送端口 2<br>9346 端口：C 技术监听<br>9400 端口：木马 Incommand 1.0 开放此端口<br>9401 端口：木马 Incommand 1.0 开放此端口<br>9402 端口：木马 Incommand 1.0 开放此端口<br>9594 端口：信息系统<br>9595 端口：Ping Discovery 服务<br>9800 端口：WebDav 源端口<br>9801 端口：Sakura 脚本转移协议-2<br>9802 端口：WebDAV Source TLS/SSL<br>9872 端口：木马 Portal of Doom 开放此端口<br>9873 端口：木马 Portal of Doom 开放此端口<br>9874 端口：木马 Portal of Doom 开放此端口<br>9875 端口：木马 Portal of Doom 开放此端口<br>9899 端口：木马 InIkiller 开放此端口<br>9909 端口：域名时间<br>9911 端口：SYPECom 传送协议<br>9989 端口：木马 iNi-Killer 开放此端口<br>9990 端口：OSM Applet 程序服务器<br>9991 端口：OSM 事件服务器<br>10000 端口：网络数据管理协议<br>10001 端口：SCP 构造端口<br>10005 端口：安全远程登陆<br>10008 端口：Octopus 多路器<br>10067 端口：木马 iNi-Killer 开放此端口<br>10113 端口：NetIQ 端点<br>10115 端口：NetIQ 端点<br>10116 端口：NetIQVoIP 鉴定器<br>10167 端口：木马 iNi-Killer 开放此端口<br>11000 端口：木马 SennaSpy 开放此端口<br>11113 端口：金山词霸开放此端口<br>11233 端口：木马 Progenic trojan 开放此端口<br>12076 端口：木马 Telecommando 开放此端口<br>12223 端口：木马 Hack’99 KeyLogger 开放此端口<br>12345 端口：木马 NetBus1.60/1.70、GabanBus 开放此端口<br>12346 端口：木马 NetBus1.60/1.70、GabanBus 开放此端口<br>12361 端口：木马 Whack-a-mole 开放此端口<br>13223 端口：PowWow 客户端，是 Tribal Voice 的聊天程序<br>13224 端口：PowWow 服务器，是 Tribal Voice 的聊天程序<br>16959 端口：木马 Subseven 开放此端口<br>16969 端口：木马 Priority 开放此端口<br>17027 端口：外向连接<br>19191 端口：木马蓝色火焰开放此端口<br>20000 端口：木马 Millennium 开放此端口<br>20001 端口：木马 Millennium 开放此端口<br>20034 端口：木马 NetBus Pro 开放此端口<br>21554 端口：木马 GirlFriend 开放此端口<br>22222 端口：木马 Prosiak 开放此端口<br>23444 端口：木马网络公牛开放此端口<br>23456 端口：木马 Evil FTP、Ugly FTP 开放此端口<br>25793 端口：Vocaltec 地址服务器<br>26262 端口：K3 软件-服务器<br>26263 端口：K3 软件客户端<br>26274 端口：木马 Delta 开放此端口<br>27374 端口：木马 Subseven 2.1 开放此端口<br>30100 端口：木马 NetSphere 开放此端口<br>30129 端口：木马 Masters Paradise 开放此端口<br>30303 端口：木马 Socket23 开放此端口<br>30999 端口：木马 Kuang 开放此端口<br>31337 端口：木马 BO(Back Orifice)开放此端口<br>31338 端口：木马 BO(Back Orifice)，DeepBO 开放此端口<br>31339 端口：木马 NetSpy DK 开放此端口<br>31666 端口：木马 BOWhack 开放此端口<br>31789 端口：Hack-a-tack<br>32770 端口：sun solaris RPC 服务开放此端口<br>33333 端口：木马 Prosiak 开放此端口<br>33434 端口：路由跟踪<br>34324 端口：木马 Tiny Telnet Server、BigGluck、TN 开放此端口<br>36865 端口：KastenX 软件端口<br>38201 端口：Galaxy7 软件数据通道<br>39681 端口：TurboNote 默认端口<br>40412 端口：木马 The Spy 开放此端口<br>40421 端口：木马 Masters Paradise 开放此端口<br>40422 端口：木马 Masters Paradise 开放此端口<br>40423 端口：木马 Masters Paradise 开放此端口<br>40426 端口：木马 Masters Paradise 开放此端口<br>40843 端口：CSCC 防火墙<br>43210 端口：木马 SchoolBus 1.0/2.0 开放此端口<br>43190 端口：IP-PROVISION<br>44321 端口：PCP 服务器(pmcd)<br>44322 端口：PCP 服务器(pmcd)代理<br>44334 端口：微型个人防火墙端口<br>44442 端口：ColdFusion 软件端口<br>44443 端口：ColdFusion 软件端口<br>44445 端口：木马 Happypig 开放此端口<br>45576 端口：E 代时光专业代理开放此端口<br>47262 端口：木马 Delta 开放此端口<br>47624 端口：Direct Play 服务器<br>47806 端口：ALC 协议<br>48003 端口：Nimbus 网关<br>50505 端口：木马 Sockets de Troie 开放此端口<br>50766 端口：木马 Fore 开放此端口<br>53001 端口：木马 Remote Windows Shutdown 开放此端口<br>54320 端口：木马 bo2000 开放此端口<br>54321 端口：木马 SchoolBus 1.0/2.0 开放此端口<br>61466 端口：木马 Telecommando 开放此端口<br>65000 端口：木马 Devil 1.03 开放此端口<br>65301 端口：PC Anywhere 软件开放端口</p><h3 id="复杂版"><a href="#复杂版" class="headerlink" title="复杂版"></a>复杂版</h3><p>端口：0<br>服务：Reserved<br>说明：通常用于分析操作系统。这一方法能够工作是因为在一些系统中“0”是无效端口，当你试图使用通常的闭合端口连接它时将产生不同的结果。一种典型的扫描，使用IP地址为0.0.0.0，设置ACK位并在以太网层广播。</p><p>端口：1<br>服务：tcpmux<br>说明：这显示有人在寻找SGI Irix机器。Irix是实现tcpmux的主要提供者，默认情况下tcpmux在这种系统中被打开。Irix机器在发布是含有几个默认的无密码的帐户，如：IP、GUEST UUCP、NUUCP、DEMOS 、TUTOR、DIAG、OUTOFBOX等。许多管理员在安装后忘记删除这些帐户。因此HACKER在INTERNET上搜索tcpmux并利用这些帐户。</p><p>端口：7<br>服务：Echo<br>说明：能看到许多人搜索Fraggle放大器时，发送到X.X.X.0和X.X.X.255的信息。</p><p>端口：19<br>服务：Character Generator<br>说明：这是一种仅仅发送字符的服务。UDP版本将会在收到UDP包后回应含有垃圾字符的包。TCP连接时会发送含有垃圾字符的数据流直到连接关闭。HACKER利用IP欺骗可以发动DoS攻击。伪造两个chargen服务器之间的UDP包。同样Fraggle DoS攻击向目标地址的这个端口广播一个带有伪造受害者IP的数据包，受害者为了回应这些数据而过载。</p><p>端口：21<br>服务：FTP<br>说明：FTP服务器所开放的端口，用于上传、下载。最常见的攻击者用于寻找打开anonymous的FTP服务器的方法。这些服务器带有可读写的目录。木马Doly Trojan、Fore、Invisible FTP、WebEx、WinCrash和Blade Runner所开放的端口。</p><p>端口：22<br>服务：Ssh<br>说明：PcAnywhere建立的TCP和这一端口的连接可能是为了寻找ssh。这一服务有许多弱点，如果配置成特定的模式，许多使用RSAREF库的版本就会有不少的漏洞存在。</p><p>端口：23<br>服务：Telnet<br>说明：远程登录，入侵者在搜索远程登录UNIX的服务。大多数情况下扫描这一端口是为了找到机器运行的操作系统。还有使用其他技术，入侵者也会找到密码。木马Tiny Telnet Server就开放这个端口。</p><p>端口：25<br>服务：SMTP<br>说明：SMTP服务器所开放的端口，用于发送邮件。入侵者寻找SMTP服务器是为了传递他们的SPAM。入侵者的帐户被关闭，他们需要连接到高带宽的E-MAIL服务器上，将简单的信息传递到不同的地址。木马Antigen、Email Password Sender、Haebu Coceda、Shtrilitz Stealth、WinPC、WinSpy都开放这个端口。</p><p>端口：31<br>服务：MSG Authentication<br>说明：木马Master Paradise、Hackers Paradise开放此端口。</p><p>端口：42<br>服务：WINS Replication<br>说明：WINS复制</p><p>端口：53<br>服务：Domain Name Server（DNS）<br>说明：DNS服务器所开放的端口，入侵者可能是试图进行区域传递（TCP），欺骗DNS（UDP）或隐藏其他的通信。因此防火墙常常过滤或记录此端口。</p><p>端口：67<br>服务：Bootstrap Protocol Server<br>说明：通过DSL和Cable modem的防火墙常会看见大量发送到广播地址255.255.255.255的数据。这些机器在向DHCP服务器请求一个地址。HACKER常进入它们，分配一个地址把自己作为局部路由器而发起大量中间人（man-in-middle）攻击。客户端向68端口广播请求配置，服务器向67端口广播回应请求。这种回应使用广播是因为客户端还不知道可以发送的IP地址。</p><p>端口：69<br>服务：Trival File Transfer<br>说明：许多服务器与bootp一起提供这项服务，便于从系统下载启动代码。但是它们常常由于错误配置而使入侵者能从系统中窃取任何文件。它们也可用于系统写入文件。</p><p>端口：79<br>服务：Finger Server<br>说明：入侵者用于获得用户信息，查询操作系统，探测已知的缓冲区溢出错误，回应从自己机器到其他机器Finger扫描。</p><p>端口：80<br>服务：HTTP<br>说明：用于网页浏览。木马Executor开放此端口。</p><p>端口：99<br>服务：gram Relay<br>说明：后门程序ncx99开放此端口。</p><p>端口：102<br>服务：Message transfer agent(MTA)-X.400 over TCP/IP<br>说明：消息传输代理。</p><p>端口：109<br>服务：Post Office Protocol -Version3<br>说明：POP3服务器开放此端口，用于接收邮件，客户端访问服务器端的邮件服务。POP3服务有许多公认的弱点。关于用户名和密码交换缓冲区溢出的弱点至少有20个，这意味着入侵者可以在真正登陆前进入系统。成功登陆后还有其他缓冲区溢出错误。</p><p>端口：110<br>服务：SUN公司的RPC服务所有端口<br>说明：常见RPC服务有rpc.mountd、NFS、rpc.statd、rpc.csmd、rpc.ttybd、amd等</p><p>端口：113<br>服务：Authentication Service<br>说明：这是一个许多计算机上运行的协议，用于鉴别TCP连接的用户。使用标准的这种服务可以获得许多计算机的信息。但是它可作为许多服务的记录器，尤其是FTP、POP、IMAP、SMTP和IRC等服务。通常如果有许多客户通过防火墙访问这些服务，将会看到许多这个端口的连接请求。记住，如果阻断这个端口客户端会感觉到在防火墙另一边与E-MAIL服务器的缓慢连接。许多防火墙支持TCP连接的阻断过程中发回RST。这将会停止缓慢的连接。</p><p>端口：119<br>服务：Network News Transfer Protocol<br>说明：NEWS新闻组传输协议，承载USENET通信。这个端口的连接通常是人们在寻找USENET服务器。多数ISP限制，只有他们的客户才能访问他们的新闻组服务器。打开新闻组服务器将允许发/读任何人的帖子，访问被限制的新闻组服务器，匿名发帖或发送SPAM。</p><p>端口：135<br>服务：Location Service<br>说明：Microsoft在这个端口运行DCE RPC end-point mapper为它的DCOM服务。这与UNIX 111端口的功能很相似。使用DCOM和RPC的服务利用计算机上的end-point mapper注册它们的位置。远端客户连接到计算机时，它们查找end-point mapper找到服务的位置。HACKER扫描计算机的这个端口是为了找到这个计算机上运行Exchange Server吗？什么版本？还有些DOS攻击直接针对这个端口。</p><p>端口：137、138、139<br>服务：NETBIOS Name Service<br>说明：其中137、138是UDP端口，当通过网上邻居传输文件时用这个端口。而139端口：通过这个端口进入的连接试图获得NetBIOS/SMB服务。这个协议被用于windows文件和打印机共享和SAMBA。还有WINS Regisrtation也用它。</p><p>端口：143<br>服务：Interim Mail Access Protocol v2<br>说明：和POP3的安全问题一样，许多IMAP服务器存在有缓冲区溢出漏洞。记住：一种LINUX蠕虫（admv0rm）会通过这个端口繁殖，因此许多这个端口的扫描来自不知情的已经被感染的用户。当REDHAT在他们的LINUX发布版本中默认允许IMAP后，这些漏洞变的很流行。这一端口还被用于IMAP2，但并不流行。</p><p>端口：161<br>服务：SNMP<br>说明：SNMP允许远程管理设备。所有配置和运行信息的储存在数据库中，通过SNMP可获得这些信息。许多管理员的错误配置将被暴露在Internet。Cackers将试图使用默认的密码public、private访问系统。他们可能会试验所有可能的组合。SNMP包可能会被错误的指向用户的网络。</p><p>端口：177<br>服务：X Display Manager Control Protocol<br>说明：许多入侵者通过它访问X-windows操作台，它同时需要打开6000端口。</p><p>端口：389<br>服务：LDAP、ILS<br>说明：轻型目录访问协议和NetMeeting Internet Locator Server共用这一端口。</p><p>端口：443<br>服务：Https<br>说明：网页浏览端口，能提供加密和通过安全端口传输的另一种HTTP。</p><p>端口：456<br>服务：[NULL]<br>说明：木马HACKERS PARADISE开放此端口。</p><p>端口：513<br>服务：Login,remote login<br>说明：是从使用cable modem或DSL登陆到子网中的UNIX计算机发出的广播。这些人为入侵者进入他们的系统提供了信息。</p><p>端口：544<br>服务：[NULL]<br>说明：kerberos kshell</p><p>端口：548<br>服务：Macintosh,File Services(AFP/IP)<br>说明：Macintosh,文件服务。</p><p>端口：553<br>服务：CORBA IIOP （UDP）<br>说明：使用cable modem、DSL或VLAN将会看到这个端口的广播。CORBA是一种面向对象的RPC系统。入侵者可以利用这些信息进入系统。</p><p>端口：555<br>服务：DSF<br>说明：木马PhAse1.0、Stealth Spy、IniKiller开放此端口。</p><p>端口：568<br>服务：Membership DPA<br>说明：成员资格 DPA。</p><p>端口：569<br>服务：Membership MSN<br>说明：成员资格 MSN。</p><p>端口：635<br>服务：mountd<br>说明：Linux的mountd Bug。这是扫描的一个流行BUG。大多数对这个端口的扫描是基于UDP的，但是基于TCP的mountd有所增加（mountd同时运行于两个端口）。记住mountd可运行于任何端口（到底是哪个端口，需要在端口111做portmap查询），只是Linux默认端口是635，就像NFS通常运行于2049端口。</p><p>端口：636<br>服务：LDAP<br>说明：SSL（Secure Sockets layer）</p><p>端口：666<br>服务：Doom Id Software<br>说明：木马Attack FTP、Satanz Backdoor开放此端口</p><p>端口：993<br>服务：IMAP<br>说明：SSL（Secure Sockets layer）</p><p>端口：1001、1011<br>服务：[NULL]<br>说明：木马Silencer、WebEx开放1001端口。木马Doly Trojan开放1011端口。</p><p>端口：1024<br>服务：Reserved<br>说明：它是动态端口的开始，许多程序并不在乎用哪个端口连接网络，它们请求系统为它们分配下一个闲置端口。基于这一点分配从端口1024开始。这就是说第一个向系统发出请求的会分配到1024端口。你可以重启机器，打开Telnet，再打开一个窗口运行natstat -a 将会看到Telnet被分配1024端口。还有SQL session也用此端口和5000端口。</p><p>端口：1025、1033<br>服务：1025：network blackjack 1033：[NULL]<br>说明：木马netspy开放这2个端口。</p><p>端口：1080<br>服务：SOCKS<br>说明：这一协议以通道方式穿过防火墙，允许防火墙后面的人通过一个IP地址访问INTERNET。理论上它应该只允许内部的通信向外到达INTERNET。但是由于错误的配置，它会允许位于防火墙外部的攻击穿过防火墙。WinGate常会发生这种错误，在加入IRC聊天室时常会看到这种情况。</p><p>端口：1170<br>服务：[NULL]<br>说明：木马Streaming Audio Trojan、Psyber Stream Server、Voice开放此端口。</p><p>端口：1234、1243、6711、6776<br>服务：[NULL]<br>说明：木马SubSeven2.0、Ultors Trojan开放1234、6776端口。木马SubSeven1.0/1.9开放1243、6711、6776端口。</p><p>端口：1245<br>服务：[NULL]<br>说明：木马Vodoo开放此端口。</p><p>端口：1433<br>服务：SQL<br>说明：Microsoft的SQL服务开放的端口。</p><p>端口：1492<br>服务：stone-design-1<br>说明：木马FTP99CMP开放此端口。</p><p>端口：1500<br>服务：RPC client fixed port session queries<br>说明：RPC客户固定端口会话查询</p><p>端口：1503<br>服务：NetMeeting T.120<br>说明：NetMeeting T.120</p><p>端口：1524<br>服务：ingress<br>说明：许多攻击脚本将安装一个后门SHELL于这个端口，尤其是针对SUN系统中Sendmail和RPC服务漏洞的脚本。如果刚安装了防火墙就看到在这个端口上的连接企图，很可能是上述原因。可以试试Telnet到用户的计算机上的这个端口，看看它是否会给你一个SHELL。连接到600/pcserver也存在这个问题。</p><p>端口：1600<br>服务：issd<br>说明：木马Shivka-Burka开放此端口。</p><p>端口：1720<br>服务：NetMeeting<br>说明：NetMeeting H.233 call Setup。</p><p>端口：1731<br>服务：NetMeeting Audio Call Control<br>说明：NetMeeting音频调用控制。</p><p>端口：1807<br>服务：[NULL]<br>说明：木马SpySender开放此端口。</p><p>端口：1981<br>服务：[NULL]<br>说明：木马ShockRave开放此端口。</p><p>端口：1999<br>服务：cisco identification port<br>说明：木马BackDoor开放此端口。</p><p>端口：2000<br>服务：[NULL]<br>说明：木马GirlFriend 1.3、Millenium 1.0开放此端口。</p><p>端口：2001<br>服务：[NULL]<br>说明：木马Millenium 1.0、Trojan Cow开放此端口。</p><p>端口：2023<br>服务：xinuexpansion 4<br>说明：木马Pass Ripper开放此端口。</p><p>端口：2049<br>服务：NFS<br>说明：NFS程序常运行于这个端口。通常需要访问Portmapper查询这个服务运行于哪个端口。</p><p>端口：2115<br>服务：[NULL]<br>说明：木马Bugs开放此端口。</p><p>端口：2140、3150<br>服务：[NULL]<br>说明：木马Deep Throat 1.0/3.0开放此端口。</p><p>端口：2500<br>服务：RPC client using a fixed port session replication<br>说明：应用固定端口会话复制的RPC客户</p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 基础知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基础知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL开启远程连接</title>
      <link href="/2021/06/11/55b08bc2ab7a/"/>
      <url>/2021/06/11/55b08bc2ab7a/</url>
      
        <content type="html"><![CDATA[<h1 id="MySQL开启远程连接"><a href="#MySQL开启远程连接" class="headerlink" title="MySQL开启远程连接"></a>MySQL开启远程连接</h1><p>在Linux上面装完MySQL 或 MariaDB，远程登录报错 Host is not allowed to connect to this MySQL server,是因为没有开启远程登陆。解决方法如下：</p><p>1、在装有MySQL的机器上登录MySQL；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p你的密码</span><br></pre></td></tr></table></figure><p>2、执行下面命令；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br></pre></td></tr></table></figure><p>3、执行下面命令，执行完可能会报错，不用管它。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update user set host = &#x27;%&#x27; where user = &#x27;root&#x27;;</span><br></pre></td></tr></table></figure><p>4、继续执行命令，来刷新MySQL的权限相关表；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><p>经过上面4步，就可以解决这个问题了。</p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET面试题</title>
      <link href="/2021/06/11/39a2b01e6d07/"/>
      <url>/2021/06/11/39a2b01e6d07/</url>
      
        <content type="html"><![CDATA[<h1 id="NET面试题"><a href="#NET面试题" class="headerlink" title=".NET面试题"></a>.NET面试题</h1><blockquote><p>这里总结收集.NET面试题。</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210611235021.png!sign" alt="image-20210611235007650"></p><h2 id="CSharp"><a href="#CSharp" class="headerlink" title="CSharp"></a>CSharp</h2><p>暂无</p><h2 id="SQL-Server"><a href="#SQL-Server" class="headerlink" title="SQL Server"></a>SQL Server</h2><p>1、写出一条 SQL 语句：取出文章表（article）中第 31 到第 40 记录（SQL Server，以自动增长的 id 作为主键，注意：id 可能不是连续的。）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM(</span><br><span class="line">    SELECT id, ROW_NUMBER() OVER(ORDER BY id ASC) AS rowid</span><br><span class="line">    FROM article</span><br><span class="line">) T</span><br><span class="line">WHERE T.rowid BETWEEN 31 and 40 </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> .NET </tag>
            
            <tag> 面试题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决网页文字不能复制的方法</title>
      <link href="/2021/05/13/2e98a43a272b/"/>
      <url>/2021/05/13/2e98a43a272b/</url>
      
        <content type="html"><![CDATA[<h1 id="网页文字不能复制的方法"><a href="#网页文字不能复制的方法" class="headerlink" title="网页文字不能复制的方法"></a>网页文字不能复制的方法</h1><h2 id="解决网页文字不能复制的方法"><a href="#解决网页文字不能复制的方法" class="headerlink" title="解决网页文字不能复制的方法"></a>解决网页文字不能复制的方法</h2><blockquote><p>网页文字不能复制基本都是通过Javascript脚本来实现的，Chrome、Firefox浏览器都有禁用Javascript功能，所以我们只要禁用当前页面Javascript即可破解网页文字不能复制的问题。</p></blockquote><h3 id="1、禁用javascript"><a href="#1、禁用javascript" class="headerlink" title="1、禁用javascript"></a>1、禁用javascript</h3><p>浏览器按F12再按F1打开Settings界面，钩选”Disable Javascript”即可：</p><p><img src="https://img.zhaifanhua.com/blogimg/20210513234145.png!sign" alt="image-20210513184015431"></p><blockquote><p>上述方法在大部分情况下都适用的，但是，有时用了后页面内容会消失，提示”Please enable Javascript to continue”，此时就需要另一种方法了。</p></blockquote><h3 id="2、书签法"><a href="#2、书签法" class="headerlink" title="2、书签法"></a>2、书签法</h3><p>在浏览器新建书签，名称填写”解除网页限制”，网址填写下边代码:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:(function()&#123;var _0x6d08=[&quot;\x38\x20\x31\x3D\x66\x3B\x38\x20\x30\x3D\x31\x2E\x30\x3B\x30\x2E\x39\x3D\x30\x2E\x67\x3D\x30\x2E\x68\x3D\x30\x2E\x69\x3D\x30\x2E\x6A\x3D\x30\x2E\x6F\x3D\x30\x2E\x39\x3D\x30\x2E\x70\x3D\x31\x2E\x39\x3D\x31\x2E\x67\x3D\x31\x2E\x68\x3D\x31\x2E\x69\x3D\x31\x2E\x6A\x3D\x71\x3B\x72\x28\x73\x20\x33\x20\x74\x20\x66\x2E\x75\x28\x27\x2A\x27\x29\x29\x7B\x35\x28\x33\x2E\x36\x21\x3D\x37\x29\x7B\x38\x20\x32\x3D\x76\x2E\x77\x28\x33\x29\x3B\x35\x28\x37\x21\x3D\x3D\x32\x5B\x22\x6B\x22\x5D\x26\x26\x27\x34\x27\x21\x3D\x32\x5B\x22\x6B\x22\x5D\x29\x7B\x33\x2E\x61\x28\x27\x36\x27\x2C\x27\x62\x2D\x63\x3A\x34\x20\x21\x64\x27\x29\x3B\x65\x7D\x35\x28\x37\x21\x3D\x3D\x32\x5B\x22\x6C\x22\x5D\x26\x26\x27\x34\x27\x21\x3D\x32\x5B\x22\x6C\x22\x5D\x29\x7B\x33\x2E\x61\x28\x27\x36\x27\x2C\x27\x2D\x78\x2D\x62\x2D\x63\x3A\x34\x20\x21\x64\x27\x29\x3B\x65\x7D\x35\x28\x37\x21\x3D\x3D\x32\x5B\x22\x6D\x22\x5D\x26\x26\x27\x34\x27\x21\x3D\x32\x5B\x22\x6D\x22\x5D\x29\x7B\x33\x2E\x61\x28\x27\x36\x27\x2C\x27\x2D\x79\x2D\x62\x2D\x63\x3A\x34\x20\x21\x64\x27\x29\x3B\x65\x7D\x7D\x7D\x7A\x28\x27\u5df2\u89e3\u9664\u6587\u672c\u590d\u5236\u4e0e\u53f3\u952e\u9650\u5236\u3010\u6458\u7e41\u534e\u7248\u6743\u6240\u6709\u3011\x27\x29\x3B&quot;,&quot;\x7C&quot;,&quot;\x73\x70\x6C\x69\x74&quot;,&quot;\x62\x6F\x64\x79\x7C\x64\x6F\x63\x7C\x6F\x62\x6A\x63\x73\x73\x7C\x6E\x6F\x64\x65\x7C\x61\x75\x74\x6F\x7C\x69\x66\x7C\x73\x74\x79\x6C\x65\x7C\x75\x6E\x64\x65\x66\x69\x6E\x65\x64\x7C\x76\x61\x72\x7C\x6F\x6E\x73\x65\x6C\x65\x63\x74\x73\x74\x61\x72\x74\x7C\x73\x65\x74\x41\x74\x74\x72\x69\x62\x75\x74\x65\x7C\x75\x73\x65\x72\x7C\x73\x65\x6C\x65\x63\x74\x7C\x69\x6D\x70\x6F\x72\x74\x61\x6E\x74\x7C\x63\x6F\x6E\x74\x69\x6E\x75\x65\x7C\x64\x6F\x63\x75\x6D\x65\x6E\x74\x7C\x6F\x6E\x63\x6F\x70\x79\x7C\x6F\x6E\x70\x61\x73\x74\x65\x7C\x6F\x6E\x6B\x65\x79\x64\x6F\x77\x6E\x7C\x6F\x6E\x63\x6F\x6E\x74\x65\x78\x74\x6D\x65\x6E\x75\x7C\x75\x73\x65\x72\x53\x65\x6C\x65\x63\x74\x7C\x77\x65\x62\x6B\x69\x74\x55\x73\x65\x72\x53\x65\x6C\x65\x63\x74\x7C\x6D\x6F\x7A\x55\x73\x65\x72\x53\x65\x6C\x65\x63\x74\x7C\x7C\x6F\x6E\x6D\x6F\x75\x73\x65\x6D\x6F\x76\x65\x7C\x6F\x6E\x64\x72\x61\x67\x73\x74\x61\x72\x74\x7C\x6E\x75\x6C\x6C\x7C\x66\x6F\x72\x7C\x6C\x65\x74\x7C\x6F\x66\x7C\x71\x75\x65\x72\x79\x53\x65\x6C\x65\x63\x74\x6F\x72\x41\x6C\x6C\x7C\x77\x69\x6E\x64\x6F\x77\x7C\x67\x65\x74\x43\x6F\x6D\x70\x75\x74\x65\x64\x53\x74\x79\x6C\x65\x7C\x77\x65\x62\x6B\x69\x74\x7C\x6D\x6F\x7A\x7C\x61\x6C\x65\x72\x74\x7C\x6E\x77\x77\x77\x7C\x69\x70\x6C\x61\x79\x53\x6F\x66\x74\x7C\x63\x6F\x6D&quot;,&quot;&quot;,&quot;\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65&quot;,&quot;\x72\x65\x70\x6C\x61\x63\x65&quot;,&quot;\x5C\x77\x2B&quot;,&quot;\x5C\x62&quot;,&quot;\x67&quot;];eval(function(_0x66f0x1,_0x66f0x2,_0x66f0x3,_0x66f0x4,_0x66f0x5,_0x66f0x6)&#123;_0x66f0x5= function(_0x66f0x3)&#123;return (_0x66f0x3&lt; _0x66f0x2?_0x6d08[4]:_0x66f0x5(parseInt(_0x66f0x3/ _0x66f0x2)))+ ((_0x66f0x3= _0x66f0x3% _0x66f0x2)&gt; 35?String[_0x6d08[5]](_0x66f0x3+ 29):_0x66f0x3.toString(36))&#125;;if(!_0x6d08[4][_0x6d08[6]](/^/,String))&#123;while(_0x66f0x3--)&#123;_0x66f0x6[_0x66f0x5(_0x66f0x3)]= _0x66f0x4[_0x66f0x3]|| _0x66f0x5(_0x66f0x3)&#125;;_0x66f0x4= [function(_0x66f0x5)&#123;return _0x66f0x6[_0x66f0x5]&#125;];_0x66f0x5= function()&#123;return _0x6d08[7]&#125;;_0x66f0x3= 1&#125;;while(_0x66f0x3--)&#123;if(_0x66f0x4[_0x66f0x3])&#123;_0x66f0x1= _0x66f0x1[_0x6d08[6]]( new RegExp(_0x6d08[8]+ _0x66f0x5(_0x66f0x3)+ _0x6d08[8],_0x6d08[9]),_0x66f0x4[_0x66f0x3])&#125;&#125;;return _0x66f0x1&#125;(_0x6d08[0],39,39,_0x6d08[3][_0x6d08[2]](_0x6d08[1]),0,&#123;&#125;))&#125;)()</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210513234151.png!sign" alt="image-20210513183156944"></p><p>建完如图，在需要破解复制的页面点击下这个书签就可以了。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210513234153.png!sign" alt="image-20210513182914258"></p><p>弹出提示关闭后，就可以随心复制和使用鼠标右键了。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210513234201.png!sign" alt="image-20210513183412214"></p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用zfile搭建公共在线网盘</title>
      <link href="/2021/05/11/d5d839e7e71d/"/>
      <url>/2021/05/11/d5d839e7e71d/</url>
      
        <content type="html"><![CDATA[<p>注：本文只用于个人使用教程，基本转载原作者文档配图以便后续更换服务器时配置，原文档地址: <a href="http://docs.zhaojun.im/zfile%E3%80%82">http://docs.zhaojun.im/zfile。</a></p><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><blockquote><p>下载 java 环境。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS系统</span></span><br><span class="line">yum install -y java-1.8.0-openjdk unzip</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210612042510.png!sign" alt="image-20210612042503354"></p><h3 id="下载项目"><a href="#下载项目" class="headerlink" title="下载项目"></a>下载项目</h3><blockquote><p>这里我将文件下载到了 /home/www 下，并在该文件夹下创建了 pan 这个文件夹，并为此文件夹赋予操作权限</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">wget -P /home/www https://c.jun6.net/ZFILE/zfile-release.war</span><br><span class="line"><span class="built_in">cd</span> /home/www</span><br><span class="line">mkdir pan &amp;&amp; unzip zfile-release.war -d pan &amp;&amp; rm -rf zfile-release.war</span><br><span class="line">chmod +x /home/www/pan/bin/*.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210612042624.png!sign" alt="image-20210612042621776"></p><p>……</p><p><img src="https://img.zhaifanhua.com/blogimg/20210612042708.png!sign" alt="image-20210612042706352"></p><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/home/www/pan/bin/start.sh       <span class="comment"># 启动项目</span></span><br><span class="line">/home/www/pan/bin/stop.sh        <span class="comment"># 停止项目</span></span><br><span class="line">/home/www/pan/bin/restart.sh     <span class="comment"># 重启项目</span></span><br></pre></td></tr></table></figure><h3 id="更改端口"><a href="#更改端口" class="headerlink" title="更改端口"></a>更改端口</h3><blockquote><p>由于 zfile 的默认端口是8080端口，这里我的这个端口已占用，所以需要改一下。如果你的站点少或该端口没有被占用，可以忽略这一步，不用更改。</p></blockquote><p>1、用 xftp 打开 /home/www/pan/WEB-INF/classes 文件夹。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210612043406.png!sign" alt="image-20210612043404047"></p><p>2、用任何编辑器打开 application.yml 文件，找到 server ，更改为你需要的端口。</p><blockquote><p>为什么呢？因为端口范围一般用到的是1到65535，其中0不使用。端口号可分为3大类：</p><p>1、公认端口（Well Known Ports）：从0到1023，它们紧密绑定（binding）于一些服务。通常这些端口的通讯明确表明了某种服务的协议。例如：80端口实际上总是HTTP通讯。</p><p>2、注册端口（Registered Ports）：从1024到49151。它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。</p><p>3、动态和/或私有端口（Dynamic and/or Private Ports）：从49152到65535。理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210612044334.png!sign" alt="image-20210612044332360"></p><p>为安全起见，这里我用 55555 。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210612065127.png!sign" alt="image-20210612053637243"></p><h3 id="修改-nginx-conf-文件"><a href="#修改-nginx-conf-文件" class="headerlink" title="修改 nginx.conf 文件"></a>修改 nginx.conf 文件</h3><p>由于我用的域名是 https 访问，所以需要代理到 55555 端口，如果不用域名，这一步省略。如我的配置如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#-------------摘繁华公共网盘------------------</span><br><span class="line">server &#123;</span><br><span class="line">    listen443 ssl;</span><br><span class="line">    server_namepan.zhaifanhua.com;</span><br><span class="line">    ssl_certificate/home/ssl/zhaifanhua.com/full_chain.pem;</span><br><span class="line">    ssl_certificate_key/home/ssl/zhaifanhua.com/private.key;</span><br><span class="line">    add_header Strict-Transport-Security &quot;max-age=63072000&quot; always;</span><br><span class="line">    ssl_stapling            on;</span><br><span class="line">    ssl_stapling_verify     on;</span><br><span class="line">    ssl_session_cacheshared:SSL:1m;</span><br><span class="line">    ssl_session_timeout5m;</span><br><span class="line">    ssl_protocolsTLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_ciphersECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">    proxy_pass          http://127.0.0.1:55555;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改完重启 nginx 即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><h3 id="配置完成"><a href="#配置完成" class="headerlink" title="配置完成"></a>配置完成</h3><p>这时我们直接访问域名，即可进入安装页面。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210612055127.png!sign" alt="image-20210612055124775"></p><p>安装完成配置好驱动器就可以访问了。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210612062128.png!sign" alt="image-20210612062125708"></p><h2 id="前后端分离部署"><a href="#前后端分离部署" class="headerlink" title="前后端分离部署"></a>前后端分离部署</h2><p>下载 <code>https://github.com/zhaojun1998/zfile/tree/master/src/main/resources/static</code> 路径下的所有文件, 或在程序运行后的相对路径：<code>WEB-INF/classes/static</code>.</p><p>修改 <code>zfile.config.json</code> 内文件指向后端地址, 然后放到静态资源服务器, 或对象存储即可:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;baseUrl&quot;</span>: <span class="string">&quot;http://xx.xxx.cn:8080&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210612062434.png!sign" alt="image-20210612062432546"></p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zfile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在CentOS上安装Nginx配置HTTPS并设置系统服务和开机启动（最全教程）</title>
      <link href="/2021/03/15/01dba31040c1/"/>
      <url>/2021/03/15/01dba31040c1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>友情提示：全部配完大约需要20分钟，系统为腾讯云CentOS7.5，本教程配合 xshell 和 xftp 使用更佳。本教程 摘繁华 版权所有。</p></blockquote><h3 id="操作按键"><a href="#操作按键" class="headerlink" title="操作按键"></a>操作按键</h3><div class="tabs" id="操作按键"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#操作按键-1">常用按键</button></li><li class="tab"><button type="button" data-href="#操作按键-2">编辑器vim按键</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="操作按键-1"><p>复制操作：<kbd>Shift</kbd>+<kbd>Ins</kbd> </p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="操作按键-2"><p>开启编辑： <kbd> i </kbd> 或者 <kbd> Insert </kbd> </p><p>退出编辑： <kbd> Esc </kbd> </p><p>退出vim： <kbd>:</kbd> + <kbd>q </kbd> </p><p>保存vim： <kbd>:</kbd> + <kbd>w</kbd> </p><p>保存退出vim： <kbd>: </kbd> + <kbd>w </kbd> + <kbd>q </kbd> </p><p>不保存退出vim： <kbd>: </kbd> + <kbd>q</kbd> + <kbd>! </kbd> </p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="第一步：安装所需要的依赖"><a href="#第一步：安装所需要的依赖" class="headerlink" title="第一步：安装所需要的依赖"></a>第一步：安装所需要的依赖</h2><h4 id="1、所需要的依赖包括：gcc，pcre，zlib，openssl。"><a href="#1、所需要的依赖包括：gcc，pcre，zlib，openssl。" class="headerlink" title="1、所需要的依赖包括：gcc，pcre，zlib，openssl。"></a>1、所需要的依赖包括：gcc，pcre，zlib，openssl。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel</span><br></pre></td></tr></table></figure><div class="tabs" id="依赖"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#依赖-1">GCC库</button></li><li class="tab"><button type="button" data-href="#依赖-2">PCRE库</button></li><li class="tab"><button type="button" data-href="#依赖-3">ZLIB库</button></li><li class="tab"><button type="button" data-href="#依赖-4">OpenSSL库</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="依赖-1"><p><strong>GCC库</strong>（用来编译下载下来的 nginx 源码）</p><p>GCC  是 Linux 下最主要的编译工具，GCC 不仅功能非常强大，结构也非常灵活。它可以通过不同的前端模块来支持各种语言，如 Java、Fortran、Pascal、Modula-3 和 Ada。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖-2"><p><strong>PCRE库</strong>（ rewrite 模块需要 pcre 库）</p><p>PCRE 支持正则表达式。如果我们在配置文件 nginx.conf 中使用了正则表达式，那么在编译 Nginx 时就必须把PCRE库编译进 Nginx，因为 Nginx 的 HTTP 模块需要靠它来解析正则表达式。另外，pcre-devel 是使用PCRE做二次开发时所需要的开发库，包括头文件等，这也是编译 Nginx 所必须使用的。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖-3"><p><strong>ZLIB库</strong>（ gzip 模块需要 zlib 库）<br>zlib 提供了很多压缩和解方式，用于对 HTTP 包的内容做 gzip 格式的压缩，如果我们在 nginx.conf 中配置了 gzip on，并指定对于某些类型（content-type）的HTTP响应使用 gzip 来进行压缩以减少网络传输量，则在编译时就必须把 zlib 编译进 Nginx。zlib-devel 是二次开发所需要的库。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖-4"><p><strong>OpenSSL库</strong>（SSL功能需要 openssl 库）<br>openssl 是一个安全套接字层密码库，如果服务器不只是要支持 HTTP，还需要在更安全的 SSL 协议上传输 HTTP，那么需要拥有 OpenSSL。另外，如果我们想使用 MD5、SHA1 等散列函数，那么也需要安装它。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>显示以下结果表示安装完成。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034336.png!sign" alt="image-20210312142614045"></p><h2 id="第二步：升级-openssl-非必需"><a href="#第二步：升级-openssl-非必需" class="headerlink" title="第二步：升级 openssl 非必需"></a>第二步：升级 openssl 非必需</h2><blockquote><p>这个不是必需！不想升级可直接跳第三步，怕麻烦最好不升级，不升级也可以用，因为升级我踩过好多坑。</p></blockquote><p>yum安装的 openssl ，版本比较低，我们可以通过以下命令查看 openssl 的版本。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl version -a</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413034355.png!sign" alt="image-20210313215300685"></p><blockquote><p>openssl 的版本是 1.0.2k，这个是2017年发布的，已经有点老了，我们下载最新版本。</p></blockquote><h4 id="1、进入-openssl官网-查看版本，这里我下载的是-openssl-1-1-1j-tar-gz-。"><a href="#1、进入-openssl官网-查看版本，这里我下载的是-openssl-1-1-1j-tar-gz-。" class="headerlink" title="1、进入 openssl官网 查看版本，这里我下载的是 openssl-1.1.1j.tar.gz  。"></a>1、进入 <a href="http://www.openssl.org/source/">openssl官网</a> 查看版本，这里我下载的是 <a href="https://www.openssl.org/source/openssl-1.1.1j.tar.gz">openssl-1.1.1j.tar.gz</a>  。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">wget https://www.openssl.org/source/openssl-1.1.1j.tar.gz</span><br></pre></td></tr></table></figure><h4 id="2、解压-openssl-1-1-1j-tar-gz-并进入解压目录。"><a href="#2、解压-openssl-1-1-1j-tar-gz-并进入解压目录。" class="headerlink" title="2、解压 openssl-1.1.1j.tar.gz 并进入解压目录。"></a>2、解压 openssl-1.1.1j.tar.gz 并进入解压目录。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf openssl-1.1.1j.tar.gz</span><br><span class="line">cd openssl-1.1.1j</span><br></pre></td></tr></table></figure><h4 id="3、进行重新编译-openssl-。"><a href="#3、进行重新编译-openssl-。" class="headerlink" title="3、进行重新编译 openssl 。"></a>3、进行重新编译 openssl 。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./config shared zlib</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><blockquote><p>此过程需要 3 分钟左右……</p></blockquote><p>编译完成后以下图：</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034420.png!sign" alt="image-20210314003448904"></p><h4 id="4、备份当前openssl。"><a href="#4、备份当前openssl。" class="headerlink" title="4、备份当前openssl。"></a>4、备份当前openssl。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv /usr/bin/openssl /usr/bin/openssl.bak</span><br><span class="line">mv /usr/include/openssl /usr/include/openssl.bak</span><br></pre></td></tr></table></figure><h4 id="5、配置使用新版本："><a href="#5、配置使用新版本：" class="headerlink" title="5、配置使用新版本："></a>5、配置使用新版本：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/bin/openssl /usr/bin/openssl</span><br><span class="line">ln -s /usr/local/include/openssl /usr/include/openssl</span><br></pre></td></tr></table></figure><h4 id="6、更新动态链接库数据："><a href="#6、更新动态链接库数据：" class="headerlink" title="6、更新动态链接库数据："></a>6、更新动态链接库数据：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;/usr/local/lib64/&quot; &gt;&gt; /etc/ld.so.conf</span><br></pre></td></tr></table></figure><p>重新加载动态链接库。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldconfig -v</span><br></pre></td></tr></table></figure><h4 id="7、重新查看版本号进行验证："><a href="#7、重新查看版本号进行验证：" class="headerlink" title="7、重新查看版本号进行验证："></a>7、重新查看版本号进行验证：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl version -a</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413034449.png!sign" alt="image-20210314013041087"></p><h4 id="8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。"><a href="#8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。" class="headerlink" title="8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。"></a>8、为适应NGINX编译需要设置参数，需要修改openss路径，不然会出现找不到openssl目录的问题。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd auto/lib/openssl</span><br><span class="line">cp conf /mnt/</span><br><span class="line">vim conf</span><br></pre></td></tr></table></figure><p>将</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CORE_INCS=&quot;$CORE_INCS $OPENSSL/.openssl/include&quot;</span><br><span class="line">CORE_DEPS=&quot;$CORE_DEPS $OPENSSL/.openssl/include/openssl/ssl.h&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/.openssl/lib/libssl.a&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/.openssl/lib/libcrypto.a&quot;</span><br></pre></td></tr></table></figure><p>修改为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CORE_INCS=&quot;$CORE_INCS $OPENSSL/include&quot;</span><br><span class="line">CORE_DEPS=&quot;$CORE_DEPS $OPENSSL/include/openssl/ssl.h&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/lib/libssl.a&quot;</span><br><span class="line">CORE_LIBS=&quot;$CORE_LIBS $OPENSSL/lib/libcrypto.a&quot;</span><br></pre></td></tr></table></figure><h4 id="9、建立libssl-a和libcrypto-a的软连接。"><a href="#9、建立libssl-a和libcrypto-a的软连接。" class="headerlink" title="9、建立libssl.a和libcrypto.a的软连接。"></a>9、建立libssl.a和libcrypto.a的软连接。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/ssl/lib</span><br><span class="line">ln -s /usr/local/lib64/libssl.a /usr/local/ssl/lib/libssl.a</span><br><span class="line">ln -s /usr/local/lib64/libcrypto.a /usr/local/ssl/lib/libcrypto.a</span><br></pre></td></tr></table></figure><h4 id="10、建立软连接openssl后，-usr-local-ssl-下没有include路径，需重新指向。"><a href="#10、建立软连接openssl后，-usr-local-ssl-下没有include路径，需重新指向。" class="headerlink" title="10、建立软连接openssl后，/usr/local/ssl/下没有include路径，需重新指向。"></a>10、建立软连接openssl后，/usr/local/ssl/下没有include路径，需重新指向。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/include/ /usr/local/ssl/include</span><br><span class="line">ll</span><br></pre></td></tr></table></figure><h2 id="第三步：正式安装Nginx"><a href="#第三步：正式安装Nginx" class="headerlink" title="第三步：正式安装Nginx"></a>第三步：正式安装Nginx</h2><h4 id="1、先进入到-usr-local-目录，创建并进入-nginx-目录。"><a href="#1、先进入到-usr-local-目录，创建并进入-nginx-目录。" class="headerlink" title="1、先进入到 usr/local 目录，创建并进入 nginx 目录。"></a>1、先进入到 usr/local 目录，创建并进入 nginx 目录。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">mkdir nginx</span><br><span class="line">cd nginx</span><br></pre></td></tr></table></figure><h4 id="2、通过-wget-命令在线获取到-nginx-的安装包，这里我选择的是-nginx-1-17-7-这个版本，命令是："><a href="#2、通过-wget-命令在线获取到-nginx-的安装包，这里我选择的是-nginx-1-17-7-这个版本，命令是：" class="headerlink" title="2、通过 wget 命令在线获取到 nginx 的安装包，这里我选择的是 nginx-1.17.7 这个版本，命令是："></a>2、通过 wget 命令在线获取到 nginx 的安装包，这里我选择的是 nginx-1.17.7 这个版本，命令是：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://nginx.org/download/nginx-1.17.7.tar.gz</span><br></pre></td></tr></table></figure><blockquote><p>最新版本可以直接点直通车查看：<a href="https://nginx.org/download">nginx下载地址</a></p></blockquote><h4 id="3、解压-nginx-1-17-7-tar-gz。"><a href="#3、解压-nginx-1-17-7-tar-gz。" class="headerlink" title="3、解压 nginx-1.17.7.tar.gz。"></a>3、解压 nginx-1.17.7.tar.gz。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf nginx-1.17.7.tar.gz</span><br></pre></td></tr></table></figure><h4 id="4、进入刚刚解压的文件夹nginx-1-17-7进行安装。"><a href="#4、进入刚刚解压的文件夹nginx-1-17-7进行安装。" class="headerlink" title="4、进入刚刚解压的文件夹nginx-1.17.7进行安装。"></a>4、进入刚刚解压的文件夹nginx-1.17.7进行安装。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd nginx-1.17.7</span><br></pre></td></tr></table></figure><h4 id="5、使用–prefix参数指定nginx安装的目录。"><a href="#5、使用–prefix参数指定nginx安装的目录。" class="headerlink" title="5、使用–prefix参数指定nginx安装的目录。"></a>5、使用–prefix参数指定nginx安装的目录。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module</span><br></pre></td></tr></table></figure><h4 id="6、用make、make-install安装，安装命令。"><a href="#6、用make、make-install安装，安装命令。" class="headerlink" title="6、用make、make install安装，安装命令。"></a>6、用make、make install安装，安装命令。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>显示以下结果表示安装完成。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034517.png!sign" alt="image-20210314050029293"></p><h4 id="7、查看nginx版本。"><a href="#7、查看nginx版本。" class="headerlink" title="7、查看nginx版本。"></a>7、查看nginx版本。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -V</span><br></pre></td></tr></table></figure><p>看到版本号为 1.17.7，各个模块也安装正常。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034540.png!sign" alt="image-20210314050114769"></p><p>执行完成后看看Nginx安在什么地方了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis nginx</span><br></pre></td></tr></table></figure><p>可以看到，我的nginx是安装在了 /usr/local/nginx。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034555.png!sign" alt="image-20210314050157365"></p><h4 id="8、运行命令启动nginx。"><a href="#8、运行命令启动nginx。" class="headerlink" title="8、运行命令启动nginx。"></a>8、运行命令启动nginx。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><h4 id="9、用ps命令看看nginx进程跑起来没有。"><a href="#9、用ps命令看看nginx进程跑起来没有。" class="headerlink" title="9、用ps命令看看nginx进程跑起来没有。"></a>9、用ps命令看看nginx进程跑起来没有。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep nginx</span><br></pre></td></tr></table></figure><p>跑起来了，说明安装没有问题。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034612.png!sign" alt="image-20210314050237838"></p><h2 id="第四步：验证是否成功安装"><a href="#第四步：验证是否成功安装" class="headerlink" title="第四步：验证是否成功安装"></a>第四步：验证是否成功安装</h2><h4 id="1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。"><a href="#1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。" class="headerlink" title="1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。"></a>1、现在在浏览器输入ip地址或者localhost，就能看到Nginx的欢迎界面了。</h4><p><img src="https://img.zhaifanhua.com/blogimg/20210413034636.png!sign" alt="image-20210312152634185"></p><p>到此，Nginx成功完成安装！接下来就是配置nginx让别人能访问到你的网站。</p><h2 id="第五步：配置nginx"><a href="#第五步：配置nginx" class="headerlink" title="第五步：配置nginx"></a>第五步：配置nginx</h2><h4 id="1、打开文件夹-usr-local-nginx-conf-，查看目录结构。"><a href="#1、打开文件夹-usr-local-nginx-conf-，查看目录结构。" class="headerlink" title="1、打开文件夹 /usr/local/nginx/conf ，查看目录结构。"></a>1、打开文件夹 /usr/local/nginx/conf ，查看目录结构。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/conf</span><br><span class="line">ll</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413034657.png!sign" alt="image-20210312160909002"></p><p>可以看到里面有nginx.conf这个文件，使用命令 vim 打开时是这样的</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034711.png!sign" alt="image-20210312161955404"></p><p><code>后面要用到的链接</code><span id="shuoming">说明文件</span></p><p>这里有必要对nginx.conf说明一下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1; # 工作进程：数目。根据硬件调整，通常等于cpu数量或者2倍cpu数量。</span><br><span class="line"></span><br><span class="line">#错误日志存放路径。</span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid; # nginx进程pid存放路径。</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024; # 工作进程的最大连接数量。</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types; # 指定mime类型，由mime.type来定义。</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    # 日志格式设置</span><br><span class="line">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    # 用log_format指令设置日志格式后，需要用access_log来指定日志文件存放路径。</span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    # 指定nginx是否调用sendfile函数来输出文件，对于普通应用，必须设置on。如果用来进行下载等应用磁盘io重负载应用，可设着off，以平衡磁盘与网络io处理速度，降低系统uptime。</span><br><span class="line">    sendfile        on;</span><br><span class="line">    # 此选项允许或禁止使用socket的TCP_CORK的选项，此选项仅在sendfile的时候使用。</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    </span><br><span class="line">    # keepalive超时时间。</span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    # 开启gzip压缩服务。</span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    # 虚拟主机。</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;  # 配置监听端口号。</span><br><span class="line">        server_name  localhost;  # 配置访问域名，域名可以有多个，用空格隔开。</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;  # 字符集设置。</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # 错误跳转页。</span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        # 请求的url过滤，正则匹配，~为区分大小写，~*为不区分大小写。</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        </span><br><span class="line">        #    root           html; # 根目录。</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000; # 请求转向定义的服务器列表。</span><br><span class="line">        #    fastcgi_index  index.php; # 如果请求的Fastcgi_index URI是以 / 结束的, 该指令设置的文件会被附加到URI的后面并保存在变量$fastcig_script_name中。</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl; # 监听端口。</span><br><span class="line">    #    server_name  localhost; # 域名。</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem; # 证书位置。</span><br><span class="line">    #    ssl_certificate_key  cert.key; # 私钥位置。</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5; # 密码加密方式。</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2、在这里建议将现有的nginx-conf文件复制一份出来并重命名为nginx-conf-bak文件，方便以后配置错了恢复。"><a href="#2、在这里建议将现有的nginx-conf文件复制一份出来并重命名为nginx-conf-bak文件，方便以后配置错了恢复。" class="headerlink" title="2、在这里建议将现有的nginx.conf文件复制一份出来并重命名为nginx.conf.bak文件，方便以后配置错了恢复。"></a>2、在这里建议将现有的nginx.conf文件复制一份出来并重命名为nginx.conf.bak文件，方便以后配置错了恢复。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -b /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf.bak</span><br></pre></td></tr></table></figure><h4 id="3、然后打开-usr-local-nginx-conf-看看目录结构，发现已经复制好了"><a href="#3、然后打开-usr-local-nginx-conf-看看目录结构，发现已经复制好了" class="headerlink" title="3、然后打开 /usr/local/nginx/conf 看看目录结构，发现已经复制好了"></a>3、然后打开 /usr/local/nginx/conf 看看目录结构，发现已经复制好了</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/conf</span><br><span class="line">ll</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413034734.png!sign" alt="image-20210314050447427"></p><p>这时后就可以安心修改nginx.conf文件了！注：上面的说明文件和conf源文件一模一样，我只是加了注释，放心复制。</p><h4 id="4、直接在本地创建一个空-nginx-conf-文件，复制上面-说明文件的代码，按照我的注释配置你的网站："><a href="#4、直接在本地创建一个空-nginx-conf-文件，复制上面-说明文件的代码，按照我的注释配置你的网站：" class="headerlink" title="4、直接在本地创建一个空 nginx.conf 文件，复制上面 说明文件的代码，按照我的注释配置你的网站："></a>4、直接在本地创建一个空 nginx.conf 文件，复制上面 <a href="#shuoming">说明文件</a>的代码，按照我的注释配置你的网站：</h4><blockquote><p>一般情况下只需要在最后一个}之前添加server配置就可以了</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413034755.png!sign" alt="image-20210313170838307"></p><p>比如我的个人主页网站配置如下：</p><p><img src="https://img.zhaifanhua.com/blogimg/20210413034807.png!sign" alt="image-20210315063102695"></p><p>下面说说我为什么这么配置（如果你的网站不需要https访问，这一步可以忽略）。</p><blockquote><p>现在网站 https 已经是标配，这个配置还是很重要的。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># -------------------http-----------------------</span><br><span class="line">    # -------------配置跳转https-------------</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name *.zhaifanhua.cn;</span><br><span class="line">        return 301 https://$http_host$request_uri;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>上面的配置是为了 http 跳转为 https ，当访问 80 端口时 nginx 自动转发为已经存在配置网址的 443 端口。比如别人访问网站 <a href="http://zhaifanhua.cn/">http://zhaifanhua.cn</a> 会自动跳转为 <a href="https://zhaifanhua.cn/">https://zhaifanhua.cn</a> 。</p><p>这里我设置为 *.zhaifanhua.cn 是因为我有很多站点都需要跳转为 https 协议访问，并且我的证书是泛域名解析，干脆用通配符 * 来配置一劳永逸。这样访问任何前缀的域名都可以跳转为 https 协议了。</p></blockquote><p>下面就是正式配置网站目录和证书了，一下内容将参数 server_name、ssl_certificate、ssl_certificate_key、location 下的 root 修改你自己的域名和路径即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># -------------------https-----------------------</span><br><span class="line">    # -------------摘繁华主页------------------</span><br><span class="line">    server &#123;</span><br><span class="line">        listen443 ssl;</span><br><span class="line">        server_namezhaifanhua.cn www.zhaifanhua.cn;</span><br><span class="line">        # 证书位置</span><br><span class="line">        ssl_certificate/home/ssl/zhaifanhua.cn/full_chain.pem;</span><br><span class="line">        # 私钥位置</span><br><span class="line">        ssl_certificate_key/home/ssl/zhaifanhua.cn/private.key;</span><br><span class="line">        # 开启HSTS</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=63072000&quot; always;</span><br><span class="line">        # 装订在线证书状态协议</span><br><span class="line">        ssl_stapling            on;</span><br><span class="line">        ssl_stapling_verify     on;</span><br><span class="line">        # 配置会话缓存</span><br><span class="line">        ssl_session_cacheshared:SSL:1m;</span><br><span class="line">        ssl_session_timeout5m;</span><br><span class="line">        # 配置协议</span><br><span class="line">        ssl_protocolsTLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        # 配置加密套件</span><br><span class="line">        ssl_ciphersECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line"></span><br><span class="line">        # 根目录</span><br><span class="line">        root                    /home/www/www;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="5、修改完成后保存，然后用xftp上传到-usr-local-nginx-conf-目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。"><a href="#5、修改完成后保存，然后用xftp上传到-usr-local-nginx-conf-目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。" class="headerlink" title="5、修改完成后保存，然后用xftp上传到 /usr/local/nginx/conf 目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。"></a>5、修改完成后保存，然后用xftp上传到 /usr/local/nginx/conf 目录进行覆盖源文件，然后判断配置文件是否正确，有successful表示可用。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -t</span><br></pre></td></tr></table></figure><h4 id="6、配置正确后，重启-nginx-重新加载配置文件使配置生效："><a href="#6、配置正确后，重启-nginx-重新加载配置文件使配置生效：" class="headerlink" title="6、配置正确后，重启 nginx 重新加载配置文件使配置生效："></a>6、配置正确后，重启 nginx 重新加载配置文件使配置生效：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure><h4 id="7、这时候访问网站已经出现了锁，说明-https-开启成功。"><a href="#7、这时候访问网站已经出现了锁，说明-https-开启成功。" class="headerlink" title="7、这时候访问网站已经出现了锁，说明 https 开启成功。"></a>7、这时候访问网站已经出现了锁，说明 https 开启成功。</h4><p><img src="https://img.zhaifanhua.com/blogimg/20210413034829.png!sign" alt="image-20210315005057299"></p><h2 id="第六步：配置为系统服务"><a href="#第六步：配置为系统服务" class="headerlink" title="第六步：配置为系统服务"></a>第六步：配置为系统服务</h2><h4 id="1、在系统服务目录里创建-nginx-service-文件。"><a href="#1、在系统服务目录里创建-nginx-service-文件。" class="headerlink" title="1、在系统服务目录里创建 nginx.service 文件。"></a>1、在系统服务目录里创建 nginx.service 文件。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /lib/systemd/system/nginx.service</span><br></pre></td></tr></table></figure><p>写入内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx</span><br><span class="line">After=network.target</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class="line">PrivateTmp=true</span><br><span class="line">  </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><blockquote><p>[Unit] 服务的说明<br>Description 描述服务<br>After 描述服务类别<br>[Service] 服务运行参数的设置<br>Type=forking 是后台运行的形式<br>ExecStart 为服务的具体运行命令<br>ExecReload 为重启命令<br>ExecStop 为停止命令<br>PrivateTmp=True 表示给服务分配独立的临时空间<br>[Install] 运行级别下服务安装的相关设置，可设置为多用户，即系统运行级别为3</p></blockquote><p>注意：[Service]的启动、重启、停止命令全部要求使用绝对路径，保存退出。</p><h4 id="2、设置用户的权限，重新加载-nginx-service-文件"><a href="#2、设置用户的权限，重新加载-nginx-service-文件" class="headerlink" title="2、设置用户的权限，重新加载 nginx.service 文件"></a>2、设置用户的权限，重新加载 nginx.service 文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 ./nginx.service</span><br><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure><h4 id="3、杀死-nginx-重启nginx"><a href="#3、杀死-nginx-重启nginx" class="headerlink" title="3、杀死 nginx 重启nginx"></a>3、杀死 nginx 重启nginx</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pkill -9 nginx</span><br><span class="line">systemctl restart nginx</span><br><span class="line">ps aux | grep nginx</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413034852.png!sign" alt="image-20210315025038577"></p><p>说明配置系统服务成功！</p><h4 id="4、设置开机自启动"><a href="#4、设置开机自启动" class="headerlink" title="4、设置开机自启动"></a>4、设置开机自启动</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx.service</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413034904.png!sign" alt="image-20210315025338229"></p><p>说明开机自启动设置成功！</p><h3 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 启动nginx服务</span><br><span class="line">service nginx start</span><br><span class="line">systemctl start nginx.service</span><br><span class="line"># 查看nginx状态</span><br><span class="line">service nginx status</span><br><span class="line">systemctl status nginx.service</span><br><span class="line"># 重启nginx服务</span><br><span class="line">service nginx reload</span><br><span class="line">systemctl restart nginx.service　</span><br><span class="line"># 停止nginx服务</span><br><span class="line">service nginx stop</span><br><span class="line">systemctl stop nginx.service</span><br><span class="line"></span><br><span class="line"># 设置开机自启动</span><br><span class="line">systemctl enable nginx.service</span><br><span class="line"># 停止开机自启动</span><br><span class="line">systemctl disable nginx.service</span><br><span class="line"></span><br><span class="line"># 查看所有已启动的服务</span><br><span class="line">systemctl list-units --type=service</span><br></pre></td></tr></table></figure><h2 id="致谢及彩蛋"><a href="#致谢及彩蛋" class="headerlink" title="致谢及彩蛋"></a>致谢及彩蛋</h2><ul><li>这篇文章写了整整两天，希望能为你带来帮助。由于知识水平有限，本文难免有不足之处，诚请各位同行提出批评和指正。</li><li>配置功能可能需要没多长时间，但为了能让读者尽可能一次配置成功，查了无数的资料，也实验了好几遍……还是蛮累的，不要忘了一件三连哦！</li></ul><p>彩蛋 ：写这篇文章之前，我的域名开了CDN加速，原本我的nginx是配置好的，我更新了我的网站程序后，怎么刷新内容都不变，我还以为我的nginx出错了，而且考虑到我的服务器好长时间没有清理了，直接TMD把服务器重装了，结果忘了备份一个重要的数据库，导致所有资料都没了，你能想到我当时的心情了吧！！！！不过要是没有重装，我也不会写这篇文章了，哈哈哈哈……欲知后文，请关注我或者任何搜索引擎搜索“摘繁华”就能找到我，嘻嘻。</p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐​​ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> Linux </tag>
            
            <tag> CentOS </tag>
            
            <tag> Nginx </tag>
            
            <tag> HTTPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python(Jupyter)实现餐饮企业订单数据分析</title>
      <link href="/2020/11/17/9a3359f551e9/"/>
      <url>/2020/11/17/9a3359f551e9/</url>
      
        <content type="html"><![CDATA[<h3 id="1-导入所需要的包"><a href="#1-导入所需要的包" class="headerlink" title="1.导入所需要的包"></a>1.导入所需要的包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> NaN</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> DataFrame,Series</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#正常显示中文标签</span></span><br><span class="line"><span class="comment"># 绘图魔术命令</span></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure><h3 id="2-定义后面用到的函数"><a href="#2-定义后面用到的函数" class="headerlink" title="2.定义后面用到的函数"></a>2.定义后面用到的函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数组中元素大写转小写(返回list)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arrayToLower</span>(<span class="params">array:<span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> [a.lower() <span class="keyword">for</span> a <span class="keyword">in</span> array <span class="keyword">if</span> <span class="built_in">isinstance</span>(a,<span class="built_in">str</span>)==<span class="literal">True</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据源(返回DataFrame)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dataOpen</span>(<span class="params">filepath:<span class="built_in">str</span>,sheetindex:<span class="built_in">int</span>,isData:<span class="built_in">bool</span></span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">         <span class="comment"># 截取路径字符串</span></span><br><span class="line">        filetype=filepath.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 判断文件类型</span></span><br><span class="line">        rdata:DataFrame</span><br><span class="line">        <span class="keyword">if</span> filetype==<span class="string">&#x27;csv&#x27;</span>:</span><br><span class="line">            data=pd.read_csv(<span class="built_in">open</span>(filepath))<span class="comment"># 读取数据源</span></span><br><span class="line">            rdata=pd.DataFrame.copy(data)<span class="comment"># 复制数据源</span></span><br><span class="line">        <span class="keyword">if</span> filetype==<span class="string">&#x27;xlsx&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> sheetindex&lt;<span class="number">0</span>:</span><br><span class="line">                data=pd.read_excel(filepath,<span class="number">0</span>)</span><br><span class="line">                rdata=pd.DataFrame.copy(data)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data=pd.read_excel(filepath,sheetindex)</span><br><span class="line">                rdata=pd.DataFrame.copy(data)</span><br><span class="line">        <span class="comment"># 判断是否数据文件</span></span><br><span class="line">        <span class="keyword">if</span> isData:</span><br><span class="line">            <span class="comment"># 重命名</span></span><br><span class="line">            rdata.columns=arrayToLower(rdata.columns)<span class="comment"># 列转小写</span></span><br><span class="line">            <span class="comment"># 转换中文列名称</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(all_tz)):</span><br><span class="line">                <span class="keyword">if</span> rdata.columns.values.tolist()==all_tz[i]:</span><br><span class="line">                    rdata.columns=all_sm[i]</span><br><span class="line">            <span class="comment">#数据源处理</span></span><br><span class="line">            rdata=rdata.dropna(axis=<span class="number">1</span>,how=<span class="string">&#x27;all&#x27;</span>,thresh=<span class="number">1</span>,inplace=<span class="literal">False</span>)<span class="comment"># 删除无意义的空列</span></span><br><span class="line">        <span class="keyword">return</span> rdata</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span>(ex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建文件夹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mkDirectory</span>(<span class="params">path</span>):</span></span><br><span class="line">    <span class="comment"># 去除首位空格</span></span><br><span class="line">    path=path.strip()</span><br><span class="line">    <span class="comment"># 去除尾部 \ 符号</span></span><br><span class="line">    path=path.rstrip(<span class="string">r&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="comment"># 判断路径是否存在</span></span><br><span class="line">    isExists=os.path.exists(path) <span class="comment"># 存在True，不存在False</span></span><br><span class="line">    <span class="comment"># 判断结果</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isExists:<span class="comment"># 如果不存在则创建文件夹</span></span><br><span class="line">        os.makedirs(path)</span><br><span class="line">        <span class="built_in">print</span>(path+<span class="string">&#x27;  文件夹创建成功&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:<span class="comment"># 如果目录存在则不创建，并提示目录已存在</span></span><br><span class="line">        <span class="built_in">print</span>(path+<span class="string">&#x27;  文件夹已存在&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数来显示柱状上的数值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">autoBarLabel</span>(<span class="params">rects</span>):</span></span><br><span class="line">    <span class="keyword">for</span> rect <span class="keyword">in</span> rects:</span><br><span class="line">        height = rect.get_height()</span><br><span class="line">        plt.text(rect.get_x(),height+<span class="number">.1</span>,height,fontsize=<span class="number">30</span>)</span><br></pre></td></tr></table></figure><h3 id="3-数据源地址"><a href="#3-数据源地址" class="headerlink" title="3.数据源地址"></a>3.数据源地址</h3><p><a href="https://zhaifanhua.lanzous.com/iMnXHkpryof">源数据下载</a> ，下载完解压在D盘即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取数据源或数据源地址</span></span><br><span class="line">file_users=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/users.xlsx&#x27;</span></span><br><span class="line">file_meal_order_info=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/meal_order_info.csv&#x27;</span></span><br><span class="line">file_meal_order_detail=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/meal_order_detail.xlsx&#x27;</span>s</span><br><span class="line">file_state=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/数据特征说明.xlsx&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-打开数据源"><a href="#4-打开数据源" class="headerlink" title="4.打开数据源"></a>4.打开数据源</h3><h4 id="4-1-打开数据特征说明表"><a href="#4-1-打开数据特征说明表" class="headerlink" title="4.1.打开数据特征说明表"></a>4.1.打开数据特征说明表</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始数据</span></span><br><span class="line">data_state_sourse=dataOpen(file_state,<span class="number">0</span>,<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 填充NaN的数据</span></span><br><span class="line">data_state_sourse=data_state_sourse.ffill()</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_state=data_state_sourse</span><br><span class="line"><span class="comment"># ---------------表特征说明字段-------------------</span></span><br><span class="line"><span class="comment"># 所有列名称</span></span><br><span class="line">data_state_col=[column <span class="keyword">for</span> column <span class="keyword">in</span> data_state]</span><br><span class="line">data_state_col_bm=data_state_col[<span class="number">0</span>]<span class="comment"># 表名</span></span><br><span class="line">data_state_col_bz=data_state_col[<span class="number">1</span>]<span class="comment"># 备注</span></span><br><span class="line">data_state_col_tz=data_state_col[<span class="number">2</span>]<span class="comment"># 特征</span></span><br><span class="line">data_state_col_sm=data_state_col[<span class="number">3</span>]<span class="comment"># 说明</span></span><br><span class="line"><span class="comment"># 数据分组</span></span><br><span class="line">data_group=data_state.groupby(by=data_state_col_bm)</span><br><span class="line">data_group_all=[x <span class="keyword">for</span> x <span class="keyword">in</span> data_group]<span class="comment"># 所有表分组</span></span><br><span class="line">data_group_users=data_group_all[<span class="number">2</span>]<span class="comment"># 用户信息表</span></span><br><span class="line">data_group_meal_order_info=data_group_all[<span class="number">1</span>]<span class="comment"># 订单表</span></span><br><span class="line">data_group_meal_order_detail=data_group_all[<span class="number">0</span>]<span class="comment"># 订单详情表</span></span><br><span class="line"><span class="comment"># ---------用户信息表------------</span></span><br><span class="line">users_tz=arrayToLower(data_group_users[<span class="number">1</span>][data_state_col_tz])<span class="comment"># 特征列数据</span></span><br><span class="line">users_sm=data_group_users[<span class="number">1</span>][data_state_col_sm].values.tolist()<span class="comment"># 说明列数据</span></span><br><span class="line"><span class="comment"># -----------订单表--------------</span></span><br><span class="line">info_tz=arrayToLower(data_group_meal_order_info[<span class="number">1</span>][data_state_col_tz])<span class="comment"># 特征列数据</span></span><br><span class="line">info_sm=data_group_meal_order_info[<span class="number">1</span>][data_state_col_sm].values.tolist()<span class="comment"># 说明列数据</span></span><br><span class="line"><span class="comment"># ----------订单详情表-------------</span></span><br><span class="line">detail_tz=arrayToLower(data_group_meal_order_detail[<span class="number">1</span>][data_state_col_tz])<span class="comment"># 特征列数据</span></span><br><span class="line">detail_sm=data_group_meal_order_detail[<span class="number">1</span>][data_state_col_sm].values.tolist()<span class="comment"># 说明列数据</span></span><br><span class="line"><span class="comment"># 封装</span></span><br><span class="line">all_tz=[users_tz,info_tz,detail_tz]<span class="comment"># 特征</span></span><br><span class="line">all_sm=[users_sm,info_sm,detail_sm]<span class="comment"># 说明</span></span><br></pre></td></tr></table></figure><h4 id="4-2-打开用户信息表（返回data-users）"><a href="#4-2-打开用户信息表（返回data-users）" class="headerlink" title="4.2.打开用户信息表（返回data_users）"></a>4.2.打开用户信息表（返回data_users）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始数据</span></span><br><span class="line">data_users_sourse=dataOpen(file_users,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 重命名指定列</span></span><br><span class="line">data_users_sourse=data_users_sourse.rename(columns = &#123;<span class="string">&quot;用户ID&quot;</span>: <span class="string">&quot;会员ID&quot;</span>&#125;)</span><br><span class="line"><span class="comment"># 删除无用列</span></span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;用户自编码&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;组织代码&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;密码&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;QQ&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;微信&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;电子邮箱&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;备注&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;创建人&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;修改人&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;修改日期&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;姓名&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;算法ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;算法名称&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_users_sourse[<span class="string">&#x27;创造日期&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除管理员,老师无用行</span></span><br><span class="line"><span class="comment">#data_users_sourse.drop([0,1],axis = 0,inplace = True)</span></span><br><span class="line"><span class="comment"># 通过~取反，选取不含管理员,老师的行</span></span><br><span class="line">data_users_sourse=data_users_sourse[~data_users_sourse[<span class="string">&#x27;账号&#x27;</span>].isin([<span class="string">&#x27;超级管理员&#x27;</span>,<span class="string">&#x27;老师&#x27;</span>])]</span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_users_sourse.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_users=data_users_sourse</span><br></pre></td></tr></table></figure><h4 id="4-3-打开订单表（返回data-info）"><a href="#4-3-打开订单表（返回data-info）" class="headerlink" title="4.3.打开订单表（返回data_info）"></a>4.3.打开订单表（返回data_info）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始数据</span></span><br><span class="line">data_info_sourse=dataOpen(file_meal_order_info,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 重命名指定列</span></span><br><span class="line">data_info_sourse=data_info_sourse.rename(columns = &#123;<span class="string">&quot;订单状态：0:未结算；1:结算；2：已锁单&quot;</span>: <span class="string">&quot;订单状态&quot;</span>&#125;)</span><br><span class="line">data_info_sourse=data_info_sourse.rename(columns = &#123;<span class="string">&quot;门店ID(org_info.id)&quot;</span>: <span class="string">&quot;门店ID&quot;</span>&#125;)</span><br><span class="line"><span class="comment"># 删除无用列</span></span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;订单状态&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;门店ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;桌子ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_info_sourse[<span class="string">&#x27;电话&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_info_sourse.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_info=data_info_sourse</span><br></pre></td></tr></table></figure><h4 id="4-4-打开订单详情表（返回data-detail）"><a href="#4-4-打开订单详情表（返回data-detail）" class="headerlink" title="4.4.打开订单详情表（返回data_detail）"></a>4.4.打开订单详情表（返回data_detail）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择读第几页</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dataSheet</span>(<span class="params">sheetindex:<span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="comment"># 原始数据</span></span><br><span class="line">    data_detail_sourse=dataOpen(file_meal_order_detail,sheetindex,<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 清除菜品名称列的\n\r和空格</span></span><br><span class="line">    col_dishes_name=data_detail_sourse[detail_sm[<span class="number">5</span>]]</span><br><span class="line">    data_detail_sourse[detail_sm[<span class="number">5</span>]]=[col.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> col <span class="keyword">in</span> col_dishes_name]</span><br><span class="line">    <span class="comment"># 删除无用列</span></span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;订单详情ID&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;会员ID&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;菜品ID&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;是否为添加菜&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;添加价格&#x27;</span>]</span><br><span class="line">    <span class="keyword">del</span> data_detail_sourse[<span class="string">&#x27;图片&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> data_detail_sourse</span><br><span class="line"><span class="comment"># 读所有页</span></span><br><span class="line">df0=dataSheet(<span class="number">0</span>)</span><br><span class="line">df1=dataSheet(<span class="number">1</span>)</span><br><span class="line">df2=dataSheet(<span class="number">2</span>)</span><br><span class="line">data_detail_sourse_all=pd.concat([df0,df1,df2],axis=<span class="number">0</span>,ignore_index=<span class="literal">True</span>)<span class="comment"># 纵向合并</span></span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_detail_sourse_all.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 处理后数据</span></span><br><span class="line">data_detail=data_detail_sourse_all</span><br></pre></td></tr></table></figure><h4 id="4-5-所有表合并（返回data-all）"><a href="#4-5-所有表合并（返回data-all）" class="headerlink" title="4.5.所有表合并（返回data_all）"></a>4.5.所有表合并（返回data_all）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据订单ID合并订单表和订单详情表</span></span><br><span class="line">data_all1=pd.merge(data_info,data_detail,how=<span class="string">&#x27;outer&#x27;</span>,on=[<span class="string">&#x27;订单ID&#x27;</span>])</span><br><span class="line"><span class="comment"># 根据订会员ID合并用户信息表</span></span><br><span class="line">data_all=pd.merge(data_all1,data_users,how=<span class="string">&#x27;inner&#x27;</span>,on=[<span class="string">&#x27;会员ID&#x27;</span>])</span><br><span class="line"><span class="comment"># 删除无用列</span></span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;订单ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;会员ID&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;学号&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;桌子名称&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;账号&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;电话&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;第一次登录&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;最后一次登录&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> data_all[<span class="string">&#x27;付费金额&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除存在NaN的无用行</span></span><br><span class="line">data_all.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 打印</span></span><br><span class="line">file_data_all=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/data_all.csv&#x27;</span></span><br><span class="line">data_all.to_csv(file_data_all,index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="5-表分析"><a href="#5-表分析" class="headerlink" title="5.表分析"></a>5.表分析</h3><h4 id="5-1-用户信息表分析"><a href="#5-1-用户信息表分析" class="headerlink" title="5.1.用户信息表分析"></a>5.1.用户信息表分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_users</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413033159.png!sign"></p><h5 id="5-1-1-注册用户的籍贯分析"><a href="#5-1-1-注册用户的籍贯分析" class="headerlink" title="5.1.1.注册用户的籍贯分析"></a>5.1.1.注册用户的籍贯分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">users_jg=data_users.groupby(by=<span class="string">&#x27;籍贯&#x27;</span>).count()</span><br><span class="line">users_jg_df1=pd.DataFrame(&#123;<span class="string">&#x27;籍贯&#x27;</span>:data_users[<span class="string">&#x27;籍贯&#x27;</span>].unique()&#125;)</span><br><span class="line">users_jg_df2=pd.DataFrame(&#123;<span class="string">&#x27;数量&#x27;</span>:[<span class="number">0</span>]*<span class="built_in">len</span>(users_jg.values)&#125;)</span><br><span class="line"><span class="comment"># 合并</span></span><br><span class="line">users_jg_df=pd.concat([users_jg_df1,users_jg_df2],axis=<span class="number">1</span>,ignore_index=<span class="literal">False</span>)</span><br><span class="line">users_jg_df[<span class="string">&#x27;数量&#x27;</span>]=users_jg.values</span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">plt_x=users_jg_df[<span class="string">&#x27;籍贯&#x27;</span>].values</span><br><span class="line">plt_y=users_jg_df[<span class="string">&#x27;数量&#x27;</span>].values</span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">50</span>,<span class="number">20</span>),dpi=<span class="number">100</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">x=plt.bar(plt_x,plt_y,color=<span class="string">&#x27;red&#x27;</span>,width=<span class="number">.8</span>,label=<span class="string">&#x27;籍贯&#x27;</span>)<span class="comment"># 设置条形图</span></span><br><span class="line">plt.xticks(users_jg_df[<span class="string">&#x27;籍贯&#x27;</span>],rotation=<span class="number">90</span>,fontsize=<span class="number">30</span>)<span class="comment"># 设置X轴的数目与取值</span></span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)<span class="comment"># 设置Y轴标签的数目与取值</span></span><br><span class="line"><span class="comment"># 画图设置</span></span><br><span class="line">plt.title(<span class="string">&#x27;注册用户的籍贯分析条形图&#x27;</span>,fontsize=<span class="number">60</span>)<span class="comment"># 设置标题</span></span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置图例</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;籍贯&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置X轴标签</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;数量&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置Y轴标签</span></span><br><span class="line">plt.margins(<span class="number">0</span>,<span class="number">.2</span>)<span class="comment"># 调节左右上下留白</span></span><br><span class="line">autoBarLabel(x)<span class="comment"># 显示数值</span></span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/用户信息表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;注册用户的籍贯分析条形图.png!sign&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop/摘繁华数据分析文件/用户信息表分析  文件夹创建成功</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413033248.png!sign"></p><blockquote><p>图片保存成功！请在文件夹  Desktop/摘繁华数据分析文件/用户信息表分析/  下查看</p></blockquote><h4 id="5-2-订单表分析"><a href="#5-2-订单表分析" class="headerlink" title="5.2.订单表分析"></a>5.2.订单表分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_info</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413033310.png!sign"></p><h5 id="5-2-1-订单消费金额分析"><a href="#5-2-1-订单消费金额分析" class="headerlink" title="5.2.1.订单消费金额分析"></a>5.2.1.订单消费金额分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">data_info_qj=[<span class="number">0</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">500</span>,<span class="number">600</span>,<span class="number">700</span>,<span class="number">800</span>,<span class="number">900</span>,<span class="number">1000</span>]</span><br><span class="line">data_info_qj_cut=pd.cut(<span class="built_in">list</span>(data_info[<span class="string">&#x27;消费金额&#x27;</span>]),data_info_qj)</span><br><span class="line">data_info_qj_cut_data=data_info_qj_cut.describe()</span><br><span class="line">data_info_qj_percentage=(data_info_qj_cut_data[<span class="string">&#x27;freqs&#x27;</span>].values)*<span class="number">100</span></span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>),dpi=<span class="number">80</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">plt.title(<span class="string">&quot;消费金额分析饼状图&quot;</span>,loc=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">labels=[<span class="string">&#x27;100元以下&#x27;</span>,<span class="string">&#x27;100-200元&#x27;</span>,<span class="string">&#x27;200-300元&#x27;</span>,<span class="string">&#x27;300-400元&#x27;</span>,<span class="string">&#x27;400-500元&#x27;</span>,<span class="string">&#x27;500-600元&#x27;</span>,<span class="string">&#x27;600-700元&#x27;</span>,<span class="string">&#x27;700-800元&#x27;</span>,<span class="string">&#x27;800-900元&#x27;</span>,<span class="string">&#x27;900-1000元&#x27;</span>,<span class="string">&#x27;1000元以上&#x27;</span>]</span><br><span class="line">plt.pie(x=data_info_qj_percentage,labels=labels,autopct=<span class="string">&#x27;%.2f%%&#x27;</span>,pctdistance=<span class="number">0.6</span>,labeldistance=<span class="number">1.1</span>,startangle=<span class="number">180</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/订单表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;消费金额分析饼状图.png!sign&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop/摘繁华数据分析文件/订单表分析  文件夹创建成功</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413033456.png!sign"></p><blockquote><p>图片保存成功！请在文件夹  Desktop/摘繁华数据分析文件/订单表分析/  下查看</p></blockquote><h4 id="5-3-订单详情表分析"><a href="#5-3-订单详情表分析" class="headerlink" title="5.3.订单详情表分析"></a>5.3.订单详情表分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_detail</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413033518.png!sign"></p><h5 id="5-3-1-菜品点单次数分析"><a href="#5-3-1-菜品点单次数分析" class="headerlink" title="5.3.1.菜品点单次数分析"></a>5.3.1.菜品点单次数分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">detail_cp=data_detail.groupby(by=<span class="string">&#x27;菜品名称&#x27;</span>).count()</span><br><span class="line">cpdd_df1=pd.DataFrame(&#123;<span class="string">&#x27;菜品名称&#x27;</span>:data_detail[<span class="string">&#x27;菜品名称&#x27;</span>].unique()&#125;)</span><br><span class="line">cpdd_df2=pd.DataFrame(&#123;<span class="string">&#x27;数量&#x27;</span>:[<span class="number">0</span>]*<span class="built_in">len</span>(detail_cp.values)&#125;)</span><br><span class="line"><span class="comment"># 合并</span></span><br><span class="line">cpdd_df=pd.concat([cpdd_df1,cpdd_df2],axis=<span class="number">1</span>,ignore_index=<span class="literal">False</span>)</span><br><span class="line">cpdd_df[<span class="string">&#x27;数量&#x27;</span>]=detail_cp.values</span><br></pre></td></tr></table></figure><h6 id="5-3-1-1-菜品点单次数饼状图"><a href="#5-3-1-1-菜品点单次数饼状图" class="headerlink" title="5.3.1.1.菜品点单次数饼状图"></a>5.3.1.1.菜品点单次数饼状图</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">cpdd_df_qj=[<span class="number">1</span>,<span class="number">40</span>,<span class="number">80</span>,<span class="number">120</span>,<span class="number">160</span>,<span class="number">200</span>,<span class="number">240</span>,<span class="number">280</span>,<span class="number">350</span>]</span><br><span class="line">cpdd_df_qj_cut=pd.cut(<span class="built_in">list</span>(cpdd_df[<span class="string">&#x27;数量&#x27;</span>]),cpdd_df_qj)</span><br><span class="line">cpdd_df_qj_cut_data=cpdd_df_qj_cut.describe()</span><br><span class="line">cpdd_df_qj_percentage=(cpdd_df_qj_cut_data[<span class="string">&#x27;freqs&#x27;</span>].values)*<span class="number">100</span></span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>),dpi=<span class="number">80</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">plt.title(<span class="string">&quot;菜品点单次数饼状图&quot;</span>,loc=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">labels=[<span class="string">&#x27;40次以下&#x27;</span>,<span class="string">&#x27;40-80次&#x27;</span>,<span class="string">&#x27;80-120次&#x27;</span>,<span class="string">&#x27;120-160次&#x27;</span>,<span class="string">&#x27;160-200次&#x27;</span>,<span class="string">&#x27;200-240次&#x27;</span>,<span class="string">&#x27;240-280次&#x27;</span>,<span class="string">&#x27;280-350次&#x27;</span>]</span><br><span class="line">plt.pie(x=cpdd_df_qj_percentage,labels=labels,autopct=<span class="string">&#x27;%.2f%%&#x27;</span>,pctdistance=<span class="number">0.6</span>,labeldistance=<span class="number">1.1</span>,startangle=<span class="number">180</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/订单详情表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;菜品点单次数饼状图.png!sign&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop/摘繁华数据分析文件/订单详情表分析  文件夹创建成功</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413033618.png!sign"></p><blockquote><p>图片保存成功！请在文件夹  Desktop/摘繁华数据分析文件/订单详情表分析/  下查看</p></blockquote><h6 id="5-3-1-2-菜品点单次数条形图"><a href="#5-3-1-2-菜品点单次数条形图" class="headerlink" title="5.3.1.2.菜品点单次数条形图"></a>5.3.1.2.菜品点单次数条形图</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入数据</span></span><br><span class="line">plt_x=cpdd_df[<span class="string">&#x27;菜品名称&#x27;</span>].values</span><br><span class="line">plt_y=cpdd_df[<span class="string">&#x27;数量&#x27;</span>].values</span><br><span class="line"><span class="comment"># 画图数据</span></span><br><span class="line">plt.figure(figsize=(<span class="number">100</span>,<span class="number">52</span>),dpi=<span class="number">100</span>)  <span class="comment">#设置画布大小</span></span><br><span class="line">x=plt.bar(plt_x,plt_y,color=<span class="string">&#x27;red&#x27;</span>,width=<span class="number">.8</span>,label=<span class="string">&#x27;菜品&#x27;</span>)<span class="comment"># 设置条形图</span></span><br><span class="line">plt.xticks(cpdd_df[<span class="string">&#x27;菜品名称&#x27;</span>],rotation=<span class="number">90</span>,fontsize=<span class="number">30</span>)<span class="comment"># 设置X轴的数目与取值</span></span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)<span class="comment"># 设置Y轴标签的数目与取值</span></span><br><span class="line"><span class="comment"># 画图设置</span></span><br><span class="line">plt.title(<span class="string">&#x27;菜品点单次数条形图&#x27;</span>,fontsize=<span class="number">60</span>)<span class="comment"># 设置标题</span></span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置图例</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;菜品名称&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置X轴标签</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;数量&#x27;</span>,fontsize=<span class="number">40</span>)<span class="comment"># 设置Y轴标签</span></span><br><span class="line">plt.margins(<span class="number">0</span>,<span class="number">.2</span>)<span class="comment"># 调节左右上下留白</span></span><br><span class="line">autoBarLabel(x)<span class="comment"># 显示数值</span></span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/订单详情表分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;菜品点单次数条形图.png!sign&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop/摘繁华数据分析文件/订单详情表分析  文件夹已存在</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413033747.png!sign"></p><blockquote><p>图片保存成功！请在文件夹  Desktop/摘繁华数据分析文件/订单详情表分析/  下查看</p></blockquote><h4 id="5-4-总表综合分析"><a href="#5-4-总表综合分析" class="headerlink" title="5.4.总表综合分析"></a>5.4.总表综合分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_all</span><br></pre></td></tr></table></figure><p><img src="https://img.zhaifanhua.com/blogimg/20210413033816.png!sign"></p><h5 id="5-4-1-重点客户分析"><a href="#5-4-1-重点客户分析" class="headerlink" title="5.4.1.重点客户分析"></a>5.4.1.重点客户分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">textname=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data_all[<span class="string">&#x27;名字&#x27;</span>].tolist():</span><br><span class="line">    textname+=i+<span class="string">&quot; &quot;</span></span><br><span class="line">textname</span><br><span class="line">wordcloud = WordCloud(font_path=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/font.ttf&#x27;</span>,background_color=<span class="string">&#x27;white&#x27;</span>).generate(<span class="string">&quot;&quot;</span>.join(textname))</span><br><span class="line">plt.figure(<span class="string">&quot;&quot;</span>,figsize=(<span class="number">50</span>,<span class="number">20</span>),dpi=<span class="number">200</span>)</span><br><span class="line">plt.imshow(wordcloud)</span><br><span class="line">plt.axis(<span class="string">&quot;off&quot;</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/总表综合分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;重点客户姓名词云图.png!sign&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop/摘繁华数据分析文件/总表综合分析  文件夹创建成功</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413033920.png!sign"></p><blockquote><p>图片保存成功！请在文件夹  Desktop/摘繁华数据分析文件/总表综合分析/  下查看</p></blockquote><h5 id="5-4-2-菜品点单种类分析"><a href="#5-4-2-菜品点单种类分析" class="headerlink" title="5.4.2.菜品点单种类分析"></a>5.4.2.菜品点单种类分析</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">textname=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data_all[<span class="string">&#x27;菜品名称&#x27;</span>].tolist():</span><br><span class="line">    textname+=i+<span class="string">&quot; &quot;</span></span><br><span class="line">textname</span><br><span class="line">wordcloud = WordCloud(font_path=<span class="string">r&#x27;D:/DataSet/餐饮企业订单信息/font.ttf&#x27;</span>,background_color=<span class="string">&#x27;white&#x27;</span>).generate(<span class="string">&quot;&quot;</span>.join(textname))</span><br><span class="line">plt.figure(<span class="string">&quot;&quot;</span>,figsize=(<span class="number">50</span>,<span class="number">20</span>),dpi=<span class="number">200</span>)</span><br><span class="line">plt.imshow(wordcloud)</span><br><span class="line">plt.axis(<span class="string">&quot;off&quot;</span>)</span><br><span class="line"><span class="comment"># 画图保存</span></span><br><span class="line">savepath=<span class="string">r&#x27;Desktop/摘繁华数据分析文件/总表综合分析/&#x27;</span></span><br><span class="line">mkDirectory(savepath)<span class="comment"># 创建文件夹</span></span><br><span class="line">plt.savefig(savepath+<span class="string">r&#x27;重点菜品词云图.png!sign&#x27;</span>)</span><br><span class="line"><span class="comment"># 画图显示</span></span><br><span class="line">plt.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;图片保存成功！请在文件夹  &#x27;</span>+savepath+<span class="string">&#x27;  下查看&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Desktop/摘繁华数据分析文件/总表综合分析  文件夹已存在</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210413034003.png!sign"></p><blockquote><p>图片保存成功！请在文件夹  Desktop/摘繁华数据分析文件/总表综合分析/  下查看</p></blockquote><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Jupyter </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python实现域名注册查询</title>
      <link href="/2020/11/08/8edf13cf11b2/"/>
      <url>/2020/11/08/8edf13cf11b2/</url>
      
        <content type="html"><![CDATA[<h1 id="Python实现域名注册查询"><a href="#Python实现域名注册查询" class="headerlink" title="Python实现域名注册查询"></a>Python实现域名注册查询</h1><p>本程序由 <a href="https://blog.zhaifanhua.com/">摘繁华</a> 和好友 <a href="https://blog.bglb.work/">蓝白社区</a> 联合出品；</p><p>本程序使用第三方接口提供服务，不保证持续稳定性，若失效，请留言反馈；</p><p>本程序仅供学习交流，请勿在于商业；</p><h2 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h2><p>摘繁华私有云盘分享：<a href="https://yun.zhaifanhua.com/s/ydFW">文件下载</a></p><h2 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h2><p><img src="https://img.zhaifanhua.com/blogimg/20210615230646.png!sign" alt="image-20210615230641656"></p><blockquote><p>source，源码文件夹；run，运行程序文件夹；readme，文档及截图。</p></blockquote><h2 id="运行说明"><a href="#运行说明" class="headerlink" title="运行说明"></a>运行说明</h2><ol><li>修改 run 文件夹下 config.json 配置文件为您需要的查询条件；</li><li>点击执行程序运行即可；</li></ol><blockquote><p>config.json配置说明：</p></blockquote><table><thead><tr><th>配置项</th><th>配置详解</th><th>配置类型</th><th>可否为空</th><th>示例</th></tr></thead><tbody><tr><td>domain_list</td><td>域名可选字典</td><td>list</td><td>是</td><td>[“a”,”b”,”c”] 或 []</td></tr><tr><td>count</td><td>域名生成数量</td><td>int</td><td>否</td><td>10（注意不能为0）</td></tr><tr><td>bits</td><td>域名长度</td><td>int</td><td>否</td><td>5（注意不能为0）</td></tr><tr><td>ext</td><td>域名后缀</td><td>list</td><td>是</td><td>[“.com”,”.cn”,”.net”] 或 []</td></tr></tbody></table><h2 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h2><p><img src="https://img.zhaifanhua.com/blogimg/20210615232152.png!sign" alt="exe运行截图"></p><h2 id="源码分享"><a href="#源码分享" class="headerlink" title="源码分享"></a>源码分享</h2><p>1、main.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">--*-- conding:utf-8 --*--</span></span><br><span class="line"><span class="string">Author:zhaifanhua</span></span><br><span class="line"><span class="string">Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="string">Time:2020.11.08 上午 02:27</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> past.builtins <span class="keyword">import</span> raw_input</span><br><span class="line"><span class="keyword">from</span> domain <span class="keyword">import</span> domain_create</span><br><span class="line"><span class="keyword">import</span> xmltodict</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getxml</span>(<span class="params">domain: <span class="built_in">str</span></span>):</span></span><br><span class="line">    url = <span class="string">&quot;http://panda.www.net.cn/cgi-bin/check.cgi&quot;</span></span><br><span class="line">    res = requests.post(url, &#123;<span class="string">&quot;area_domain&quot;</span>: domain&#125;)</span><br><span class="line">    <span class="keyword">return</span> res.content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xml_to_json</span>(<span class="params">xmldoc</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tmp = json.loads(json.dumps(xmltodict.parse(xmldoc, encoding=<span class="string">&#x27;&#x27;</span>)))</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        tmp = &#123;</span><br><span class="line">            <span class="string">&#x27;property&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;returncode&#x27;</span>: -<span class="number">1</span>,</span><br><span class="line">                <span class="string">&#x27;original&#x27;</span>: <span class="string">&#x27;000&#x27;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> tmp[<span class="string">&quot;property&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_out</span>(<span class="params">domain: <span class="built_in">list</span></span>):</span></span><br><span class="line">    path = <span class="string">&quot;./result&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        os.makedirs(path)</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> domain:</span><br><span class="line">        res_dict = xml_to_json(getxml(key))</span><br><span class="line">        <span class="keyword">if</span> res_dict[<span class="string">&quot;returncode&quot;</span>] == <span class="string">&quot;200&quot;</span>:</span><br><span class="line">            statu = <span class="string">&quot;请求成功&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            statu = <span class="string">&quot;请求失败&quot;</span></span><br><span class="line">        <span class="keyword">if</span> res_dict[<span class="string">&quot;original&quot;</span>][:<span class="number">3</span>] == <span class="string">&quot;210&quot;</span>:</span><br><span class="line">            original = <span class="string">&quot;-------域名可以注册--------&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./result/result_true.txt&quot;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> result_true:</span><br><span class="line">                result_true.write(key + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> res_dict[<span class="string">&quot;original&quot;</span>][:<span class="number">3</span>] == <span class="string">&quot;211&quot;</span>:</span><br><span class="line">            original = <span class="string">&quot;域名已经被注册&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> res_dict[<span class="string">&quot;original&quot;</span>][:<span class="number">3</span>] == <span class="string">&quot;212&quot;</span>:</span><br><span class="line">            original = <span class="string">&quot;域名参数传输错误&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            original = <span class="string">&quot;查询超时&quot;</span></span><br><span class="line">        out_str = <span class="string">&quot;域名：&#123;0&#125;\t请求状态：&#123;1&#125;\t注册状态：&#123;2&#125;&quot;</span>.<span class="built_in">format</span>(key, statu, original)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./result/result.txt&quot;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> result:</span><br><span class="line">            result.write(out_str + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(out_str)</span><br><span class="line">    raw_input(<span class="string">&quot;查询完毕！请在result文件夹下的result_true.txt中查看可购买的域名！感谢您的使用，请按任意键退出此窗口！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_json</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./config.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> c:</span><br><span class="line">            config_json = json.load(c)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;配置文件出错！请检查config.json文件！按任意键退出此窗口&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">8</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> config_json[<span class="string">&quot;count&quot;</span>] <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> config_json[<span class="string">&quot;bits&quot;</span>] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        raw_input(<span class="string">&quot;配置文件出错！请检查config.json文件！ 按任意键退出此窗口&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config_json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    config = read_json()</span><br><span class="line">    domain_list = domain_create(domain_list=<span class="built_in">list</span>(config[<span class="string">&quot;domain_list&quot;</span>]), count=<span class="built_in">int</span>(config[<span class="string">&quot;count&quot;</span>]),</span><br><span class="line">                                bits=<span class="built_in">int</span>(config[<span class="string">&quot;bits&quot;</span>]), ext=<span class="built_in">list</span>(config[<span class="string">&quot;exts&quot;</span>]))</span><br><span class="line">    parse_out(domain_list)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、domain.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">--*-- conding:utf-8 --*--</span></span><br><span class="line"><span class="string">Author:zhaifanhua</span></span><br><span class="line"><span class="string">Email:me@zhaifanhua.com</span></span><br><span class="line"><span class="string">Time:2020.11.08 上午 02:27</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">domain_create</span>(<span class="params">domain_list, count=<span class="number">50</span>, bits=<span class="number">5</span>, ext: <span class="built_in">list</span> = [<span class="string">&quot;.com&quot;</span>, <span class="string">&quot;.cn&quot;</span>, <span class="string">&quot;.net&quot;</span>]</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            域名生成方法</span></span><br><span class="line"><span class="string">    :param domain_list:域名可选字典</span></span><br><span class="line"><span class="string">    :param count:域名生成数量</span></span><br><span class="line"><span class="string">    :param bits:域名长度</span></span><br><span class="line"><span class="string">    :param ext:域名后缀</span></span><br><span class="line"><span class="string">    :return: domain_list</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(domain_list) == <span class="number">0</span>:</span><br><span class="line">        domain_list = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>)]  <span class="comment"># 默认为a到z全字典</span></span><br><span class="line">    input_str = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    input_list = []</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">range</span>(bits):</span><br><span class="line">            i = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(domain_list) - <span class="number">1</span>)</span><br><span class="line">            input_str += domain_list[i]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(ext) == <span class="number">0</span>:</span><br><span class="line">            ext = [<span class="string">&quot;.com&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> e <span class="keyword">in</span> ext:</span><br><span class="line">            input_list.append(input_str + e)</span><br><span class="line">        input_str = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    num_list = [<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;q&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(domain_create(num_list, <span class="number">500</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure><p>3、config.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;domain_list&quot;</span>: [],</span><br><span class="line">  <span class="attr">&quot;count&quot;</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="attr">&quot;bits&quot;</span>: <span class="number">6</span>,</span><br><span class="line">  <span class="attr">&quot;exts&quot;</span>:[<span class="string">&quot;.com&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><h3 id="v1-0-0"><a href="#v1-0-0" class="headerlink" title="v1.0.0"></a>v1.0.0</h3><h4 id="感谢："><a href="#感谢：" class="headerlink" title="感谢："></a>感谢：</h4><p>1、感谢接口提供者；</p><h4 id="新增："><a href="#新增：" class="headerlink" title="新增："></a>新增：</h4><p>1、域名自定义，具体为字典自定义和后缀自定义；</p><p>2、域名状态查询；</p><h4 id="优化："><a href="#优化：" class="headerlink" title="优化："></a>优化：</h4><p>1、查询记录保存为文本，方便后续查看，使用者不再需要关注实时信息；</p><p>2、可注册域名保存为文本，方便后续查看；</p><h3 id="v1-0-1"><a href="#v1-0-1" class="headerlink" title="v1.0.1"></a>v1.0.1</h3><h4 id="感谢：-1"><a href="#感谢：-1" class="headerlink" title="感谢："></a>感谢：</h4><p>感谢粉丝 @星星 提出此 bug；</p><h4 id="修复："><a href="#修复：" class="headerlink" title="修复："></a>修复：</h4><p>1、因接口访问规则变化而产生程序异常闪退的问题，已优化为错误提示，不会闪退；</p><p>2、因接口爬虫机制变化导致一直请求失败的问题；</p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PowerDesigner安装教程（含下载+汉化+去试用）</title>
      <link href="/2020/06/01/8bb48e13b62e/"/>
      <url>/2020/06/01/8bb48e13b62e/</url>
      
        <content type="html"><![CDATA[<h1 id="PowerDesigner安装教程（含下载-汉化-去试用）"><a href="#PowerDesigner安装教程（含下载-汉化-去试用）" class="headerlink" title="PowerDesigner安装教程（含下载+汉化+去试用）"></a>PowerDesigner安装教程（含下载+汉化+去试用）</h1><h2 id="1、什么是PowerDesigner"><a href="#1、什么是PowerDesigner" class="headerlink" title="1、什么是PowerDesigner"></a>1、什么是PowerDesigner</h2><blockquote><p>PowerDesigner是一款能进行数据库设计的软件，是一款开发人员常用的数据库建模工具。使用它可以分别从概念数据模型和物理数据模型两个层次对数据库进行设计。概念数据模型描述的是独立于数据库管理系统的实体定义和实体关系定义；物理数据模型是在概念数据模型的基础上对目标数据库管理系统的具体化。而且PowerDesigner还可以和NET、Eclipse等主流平台进行关联，从而优化整个项目的设计方案，达到大大缩短开发时间的效果。</p></blockquote><p>PowerDesigner是Sybase公司的CASE工具集，使用它可以方便地对管理信息系统进行分析设计，它几乎包括了数据库模型设计的全过程。利用PowerDesigner可以制作数据流程图、概念数据模型（ConceptualDataModel）、物理数据模型（PhysicalDataModel），还可以为数据仓库制作结构模型，也能对团队设计模型进行控制。</p><p>在数据库建模的过程中，需要运用PowerDesigner进行数据库设计，这个不但可以让人直观地理解模型，而且可以充分地利用数据库技术，优化数据库的设计。使用PowerDesigner并不感到很陌生，主要就是建立E−R图，在数据库系统概论中有涉及。实体关系E−R图中，一个实体对一个表，实体、属性与联系是进行系统设计时要考虑的三个要素，也是一个好的数据库设计的核心。</p><p>PowerDesigner创始人是一个名字叫王晓昀的中国人。1978年，王晓昀在北京大学就读了三个月，1979年去了法国留学，1986年大学毕业后在巴黎的SDP软件公司工作，当时从事软件的开发和设计，在工作中，他就一直想找到一个很好的建模设计工具，可是当时没有。他就想能不能自己开发一个这样的软件呢，于是在1988年开始开发，1989年开发出了第一个版本，叫作AMC<em>Designor，在法国销售，而且卖得很好。当时王晓昀所在公司的所有软件都用他开发的这个工具，直到现在一直都在用。后来继续开发和完善这个产品，并把市场拓展到了美国，1991年开始在美国销售，产品名字叫作S−Designor。1995年Powersoft买下了SDP公司，同年，Sybase又买下了Powersoft，于是把S−Designor和AMC</em>Designor的名字改为PowerDesigner和PowerAMC。</p><h2 id="2、准备工作，下载安装包及其他文件"><a href="#2、准备工作，下载安装包及其他文件" class="headerlink" title="2、准备工作，下载安装包及其他文件"></a>2、准备工作，下载安装包及其他文件</h2><p>需要下载以下3个文件，我直接把所有文件压缩在了一起放到了我的私有网盘（之所以不用百度网盘，那个速度大家都懂的），方便下载。如果网盘链接有失效，请评论区留言联系我。</p><p>1、PowerDesigner.exe：安装文件（Sybase PowerDesigner 16.5）</p><p>2、pdflm16.dll：破解文件</p><p>3、PowerDesigner汉化文件</p><p>下载地址：<a href="https://yun.zhaifanhua.com/s/Ldca">安装包及其他文件</a></p><h2 id="3、PowerDesigner安装图文教程："><a href="#3、PowerDesigner安装图文教程：" class="headerlink" title="3、PowerDesigner安装图文教程："></a>3、PowerDesigner安装图文教程：</h2><p>1、解压下载的压缩文件，进入解压文件夹，并双击PowerDesigner.exe；</p><p>2、欢迎来到PowerDesigner安装界面，点击 Next；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011729.png!sign" alt="image-20210601003737372"></p><p>3、选择Trial，点击Next。不要选择其它，这一步如果选择错，后面破解是不行的。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011733.png!sign" alt="image-20210601003817645"></p><p>4、选择Hong Kong，点击I AGREE，再点击Next；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011736.png!sign" alt="image-20210601004005847"></p><p>5、选择一个安装目录，默认是安装在C盘。再点击Next；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011836.png!sign" alt="image-20210601004056951"></p><p>6、这一步直接Next；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011739.png!sign" alt="image-20210601004331739"></p><p>7、点击General和Notaion，再点击Next；</p><blockquote><p>这里很多人可能不懂，不懂你全选就不会出错了。具体什么意思，我就不在这里详细说明了。</p></blockquote><p><img src="https://img.zhaifanhua.com/blogimg/20210601011741.png!sign" alt="image-20210601004454564"></p><blockquote><p>注意：<br>走到这一 步，如果你电脑上已经安装了“Eclipse”软件，请不要打勾此插件选项。否则，就会出现让你选择“Eclipse”软件的安装路径。</p></blockquote><p>8、直接点击Next；进入正在安装界面：</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011847.png!sign" alt="image-20210601004713081"></p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011743.png!sign" alt="image-20210601004825583"></p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011856.png!sign" alt="image-20210601004848999"></p><p>9、点击Finish，安装完成。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011745.png!sign" alt="image-20210601004917490"></p><p>10、打开界面是这样的：</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011747.png!sign" alt="image-20210601005258921"></p><p>11、这时，我们点击菜单 Help =》About Power Designer 可以看到是15天的试用。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011906.png!sign" alt="image-20210601005457885"></p><h2 id="4、PowerDesigner破解步骤："><a href="#4、PowerDesigner破解步骤：" class="headerlink" title="4、PowerDesigner破解步骤："></a>4、PowerDesigner破解步骤：</h2><p>1、先关闭软件，进入刚才的解压文件夹，将“PowerDesigner破解文件”文件夹下的“pdflm16.dll”复制；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011749.png!sign" alt="image-20210601010147695"></p><p>2、粘贴并覆盖到你软件安装的目录中，可能需要管理员权限，同意即可；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011751.png!sign" alt="image-20210601010355594"></p><p>3、这时我们再打开软件发现已经没有了试用期限；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011759.png!sign" alt="image-20210601010657058"></p><h2 id="5、PowerDesigner汉化步骤："><a href="#5、PowerDesigner汉化步骤：" class="headerlink" title="5、PowerDesigner汉化步骤："></a>5、PowerDesigner汉化步骤：</h2><p>1、先关闭软件，进入刚才的解压文件夹，将PowerDesigner汉化文件”文件夹下的所有文件全选复制；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011807.png!sign" alt="image-20210601011146191"></p><p>2、粘贴并覆盖到你软件安装的目录中，可能需要管理员权限，同意即可；</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011812.png!sign" alt="image-20210601011327069"></p><p>3、如果点击PdShell16.exe不能正常启动，请点击pdlegacyshell16.exe启动；显示以下页面，汉化成功。</p><p><img src="https://img.zhaifanhua.com/blogimg/20210601011819.png!sign" alt="image-20210601011448929"></p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐 ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 汉化 </tag>
            
            <tag> PowerDesigner </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>夜半思盈</title>
      <link href="/2019/07/19/de4aeeec2e55/"/>
      <url>/2019/07/19/de4aeeec2e55/</url>
      
        <content type="html"><![CDATA[<p>《夜半思盈》（2019.7.19）<br>粉面姣容引梦佳，独着丝袗欲掩纱。<br>芙蓉跃幻羞涩处，岂知何月一遇她？</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>无题</title>
      <link href="/2019/04/04/eeb0bdb0a59d/"/>
      <url>/2019/04/04/eeb0bdb0a59d/</url>
      
        <content type="html"><![CDATA[<p>《无题》（2019.4.4）</p><p>感友殷勤照艳肌，慨惜落圭何记时？</p><p>万痛掩被低声泣，千金难买劬劳矣！ </p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>望惜</title>
      <link href="/2019/03/30/81c121373129/"/>
      <url>/2019/03/30/81c121373129/</url>
      
        <content type="html"><![CDATA[<p>《望惜》（2019.3.30）</p><p>春芽既生心难枯，儒念粉妆善思芙。</p><p>悠悠日月形非孤，痴痴龙荪影常独。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSharp实现模拟双色球控制台应用程序</title>
      <link href="/2018/10/25/1b95bf668cad/"/>
      <url>/2018/10/25/1b95bf668cad/</url>
      
        <content type="html"><![CDATA[<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>这是我在大一第一学期C#的课程设计，要求编写一个模拟双色球彩票的控制台应用程序，用以实现简单的模拟选购彩票。</p><h3 id="1、双色球购号号码生成："><a href="#1、双色球购号号码生成：" class="headerlink" title="1、双色球购号号码生成："></a>1、双色球购号号码生成：</h3><p>1.系统购号：通过“随机数”产生双色球的各个号码，通过“数组”保存所生成的每一注号码，并生成系统购号记录。<br>2.手动购号：用户输入要购买的数字，通过“数组”保存所生成的每一注号码，并生成手动购号记录。</p><h3 id="2、双色球开奖号码生成："><a href="#2、双色球开奖号码生成：" class="headerlink" title="2、双色球开奖号码生成："></a>2、双色球开奖号码生成：</h3><p>同每一注系统购号号码生成原理相同。</p><h3 id="3、开奖对比："><a href="#3、开奖对比：" class="headerlink" title="3、开奖对比："></a>3、开奖对比：</h3><p>将开奖结果与手动、系统购号记录进行对比，输出中奖结果并打印。<br><img src="https://img.zhaifanhua.com/blogimg/20210413031245.jpg!sign" alt="中奖规则"></p><h2 id="二、课题介绍"><a href="#二、课题介绍" class="headerlink" title="二、课题介绍"></a>二、课题介绍</h2><h3 id="1、功能要求"><a href="#1、功能要求" class="headerlink" title="1、功能要求"></a>1、功能要求</h3><p>（1）用 C#语言实现程序设计；<br>（2）利用结构体进行相关信息处理；<br>（3）良好的人机互交；<br>（4）需求设计，满足功能和非功能需求；<br>（5）界面设计，内容编排合理，布局合理，易于操作；<br>（6）结构设计，程序设计合理，逻辑结构清晰，处理流程正确，功能划分明确；<br>（7）项目设计文档，项目架构设计正确，详细描述数据库设计和项目功能模块设计；<br>（8）编码可读性，代码编写遵循规范，注释清晰，可读性强；<br>（9）项目调试，能够熟练调试程序；<br>（10）项目测试，能够熟练测试程序，找到bug并进行修正；<br>（11）项目整体运行情况，项目程序能成功运行，无重大Bug，出现Bug也能当场调试通过；<br>（12）项目答辩，项目讲解较为清晰，能正确回答老师的提问。</p><h3 id="2、主要任务"><a href="#2、主要任务" class="headerlink" title="2、主要任务"></a>2、主要任务</h3><p>（1）运用本学期所学的控制台应用程序；<br>（2）熟练掌握数组、随机数、方法、类等；<br>（3）编写代码；<br>（4）程序分析与调试。 </p><h3 id="3、运行环境"><a href="#3、运行环境" class="headerlink" title="3、运行环境"></a>3、运行环境</h3><p>（1）Win7 /Win10系统；<br>（2）Visual Studio 2019 开发环境；</p><h3 id="4、开发语言"><a href="#4、开发语言" class="headerlink" title="4、开发语言"></a>4、开发语言</h3><p>C#语言。</p><h2 id="三、用到的按键"><a href="#三、用到的按键" class="headerlink" title="三、用到的按键"></a>三、用到的按键</h2><p>功能选择： <kbd>Q</kbd><kbd>W</kbd> <kbd>E</kbd><kbd>R</kbd><br>数字选择：<kbd>0</kbd><kbd>1</kbd><kbd>2</kbd><kbd>3</kbd><kbd>4</kbd><kbd>5</kbd><kbd>6</kbd><kbd>7</kbd><kbd>8</kbd><kbd>9</kbd><br>功能确认：<kbd>Enter</kbd></p><h2 id="四、程序设计"><a href="#四、程序设计" class="headerlink" title="四、程序设计"></a>四、程序设计</h2><h3 id="1、系统流程"><a href="#1、系统流程" class="headerlink" title="1、系统流程"></a>1、系统流程</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210413031153.jpeg!sign" alt="双色球流程图"></p><h3 id="2、特色功能的实现"><a href="#2、特色功能的实现" class="headerlink" title="2、特色功能的实现"></a>2、特色功能的实现</h3><ul><li><input checked="" disabled="" type="checkbox"> 产生模拟奖池；</li><li><input checked="" disabled="" type="checkbox"> 生成自定义数据库；</li><li><input checked="" disabled="" type="checkbox"> 打印数据，读取数据；</li><li><input checked="" disabled="" type="checkbox"> 界面输出优化；</li><li><input checked="" disabled="" type="checkbox"> 保护用户隐私；</li><li><input checked="" disabled="" type="checkbox"> 程序结束后可继续查看中奖记录等。</li></ul><h3 id="3、运行展示"><a href="#3、运行展示" class="headerlink" title="3、运行展示"></a>3、运行展示</h3><p><img src="https://img.zhaifanhua.com/blogimg/20210413031034.jpeg!sign" alt="运行展示"></p><h3 id="4、数据保存设计"><a href="#4、数据保存设计" class="headerlink" title="4、数据保存设计"></a>4、数据保存设计</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">第<span class="number">1</span>次设计.</span><br><span class="line">用普通数据记录</span><br><span class="line">第【<span class="number">01</span>】注：红色球：<span class="number">01</span> <span class="number">02</span> <span class="number">03</span> <span class="number">04</span> <span class="number">05</span> <span class="number">06</span> 蓝色球：<span class="number">07</span>【系统购号】时间：<span class="number">2019.06</span>.<span class="number">12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">01</span></span><br><span class="line">第【<span class="number">02</span>】注：红色球：<span class="number">06</span> <span class="number">14</span> <span class="number">15</span> <span class="number">22</span> <span class="number">29</span> <span class="number">32</span> 蓝色球：<span class="number">11</span>【手动购号】时间：<span class="number">2019.06</span>.<span class="number">12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">07</span></span><br><span class="line">第<span class="number">2</span>次设计.</span><br><span class="line">去掉固定字符</span><br><span class="line"><span class="number">01</span>_01_02_03_04_05_06_07_系统购号_2019.<span class="number">06.12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">01</span></span><br><span class="line"><span class="number">02</span>_06_14_15_22_29_32_11_手动购号_2019.<span class="number">06.12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">07</span></span><br><span class="line">第<span class="number">3</span>次设计.</span><br><span class="line">用标记值 _</span><br><span class="line"><span class="number">01</span>_01_02_03_04_05_06_07_2019.<span class="number">06.12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">01</span></span><br><span class="line"><span class="number">02</span>_06_14_15_22_29_32_11_2019.<span class="number">06.12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">07</span></span><br><span class="line">第<span class="number">4</span>次设计.</span><br><span class="line">用标记值 X R B T</span><br><span class="line">X01R010203040506B07T2019.<span class="number">06.12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">01</span></span><br><span class="line">X02R061415222932B11T2019.<span class="number">06.12</span> <span class="number">22</span>:<span class="number">02</span>:<span class="number">07</span></span><br></pre></td></tr></table></figure><h2 id="五、核心代码"><a href="#五、核心代码" class="headerlink" title="五、核心代码"></a>五、核心代码</h2><h3 id="Program-cs"><a href="#Program-cs" class="headerlink" title="Program.cs"></a>Program.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:Program.cs</span></span><br><span class="line"><span class="comment">//        description:程序入口文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Class1 myclass1_guize = <span class="keyword">new</span> Class1();</span><br><span class="line">            Class3 myclass3_xuanhao = <span class="keyword">new</span> Class3();</span><br><span class="line">            Class4 myclass4_kaijiang = <span class="keyword">new</span> Class4();</span><br><span class="line">            myclass4_kaijiang.ShanChuXiTongWenJian();<span class="comment">//删除程序启动前创建的系统购号记录</span></span><br><span class="line">            myclass4_kaijiang.ShanChuShouDongWenJian();<span class="comment">//删除程序启动前创建的手动购号记录</span></span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                             @摘繁华 版权所有&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;你好！欢迎你进入摘繁华的模拟双色球程序！\n&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;===================================================程序开始===================================================&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> biaojizhi = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (biaojizhi != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;请选择：1.不了解双色球规则，查看规则【Q/q】； \t2.了解双色球规则，进入模拟【W/w】； \t3.结束本程序【E/e】；&quot;</span>);</span><br><span class="line">                <span class="built_in">string</span> xuanze =Console.ReadLine().ToUpper();</span><br><span class="line">                <span class="keyword">switch</span> (xuanze)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了查看双色球规则；&quot;</span>);</span><br><span class="line">                        myclass1_guize.GuiZe();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;W&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了进入模拟；&quot;</span>);</span><br><span class="line">                        myclass3_xuanhao.HaoMa();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;E&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了结束程序!&quot;</span>);</span><br><span class="line">                        biaojizhi = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="literal">default</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你的输入有误，请重新选择!&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;===================================================程序结束===================================================&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;程序结束，按任意键退出。&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                             @摘繁华 版权所有&quot;</span>);</span><br><span class="line">            Console.ReadKey(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-游戏规则-cs"><a href="#1-游戏规则-cs" class="headerlink" title="1_游戏规则.cs"></a>1_游戏规则.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:1_游戏规则.cs</span></span><br><span class="line"><span class="comment">//        description:游戏规则文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class1</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GuiZe</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Cyan;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;一、玩法及说明\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;双色球投注区分为红球号码区和蓝球号码区，红球号码范围为01～33，蓝球号码范围为01～16。双色球每期从33个红球中\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;开出6个号码，从16个蓝球中开出1个号码作为中奖号码，双色球玩法即是竞猜开奖号码的6个红球号码和1个蓝球号码，顺\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;序不限。&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;二、设奖及中奖\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|-----------|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      | 中奖条件  |        |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;| 奖级 |-----------|中奖说明|                          单注奖金                               |单注赔率|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      | 红球 |蓝球|        |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |      |    |        |     当奖池资金低于1亿元时，奖金总额为当期高等奖奖金的75%与奖池中|        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |      |    |        |累积的奖金之和，单注奖金按注均分，单注最高限额封顶500万元。      |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |      |    |        |     当奖池资金高于1亿元(含)时，奖金总额包括两部分，一部分为当期 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|一等奖|RRRRRR| B  | 中6+1  |高等奖奖金的55 % 与奖池中累积的奖金之和，单注奖金按注均分，单注最|  ——  |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |      |    |        |高限额封顶500万元;另一部分为当期高等奖奖金的20%，单注奖金按注均分|        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |      |    |        |，单注最高限额封顶500万元。                                      |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|二等奖|RRRRRR|    | 中6+0  |                    当期高等奖奖金的25%                          |  ——  |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|三等奖|RRRRR | B  | 中5+1  |                   单注奖金额固定为3000元                        | 1:1500 |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |RRRRR |    | 中5+0  |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|四等奖|------|----|--------|                   单注奖金额固定为200元                         | 1:100  |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |RRRRR | B  | 中4+1  |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |RRRR  |    | 中4+0  |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|五等奖|------|----|--------|                   单注奖金额固定为10元                          | 1:5    |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |RRR   | B  | 中3+1  |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |RR    | B  | 中2+0  |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |------|----|--------|                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|六等奖|R     | B  | 中1+1  |                    单注奖金额固定为5元                          | 1:2.5  |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |------|----|--------|                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|      |      | B  | 中0+1  |                                                                 |        |\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;|------|------|----|--------|-----------------------------------------------------------------|--------|&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;注：\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;1、高等奖奖金＝奖金总额－固定奖奖金。\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;2、当奖池奖金超过1亿元(含)时，下期一等奖奖金总额包括两部分，一部分为高等奖奖金的55 % 与奖池奖金之和，单注\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;奖金按注均分，封顶500万元；另一部分为高等奖奖金的20 %，单注奖金按注均分，封顶500万元。 \n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;3、奖池奖金在1亿元以下时，单注奖金封顶500万元。&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;你已查看完双色球规则!\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-账户资金-cs"><a href="#2-账户资金-cs" class="headerlink" title="2_账户资金.cs"></a>2_账户资金.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:2_账户资金.cs</span></span><br><span class="line"><span class="comment">//        description:账户资金文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class2_ZiJi</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ZiJin_shouci</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Class2_ZiJinBianHua myclass_chushiyue = <span class="keyword">new</span> Class2_ZiJinBianHua();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;为了你的首次体验，系统已为你赠送100元用于购买双色球，你的账户初始余额为：&#123;0:C&#125;元；\n&quot;</span>, FormatMoney(myclass_chushiyue.ChuShiYuE(<span class="number">100</span>)));<span class="comment">//输出初始余额</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//手动存取金额</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ZiJin_cunqu</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Class2_ZiJinBianHua myclass_cunqu = <span class="keyword">new</span> Class2_ZiJinBianHua();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入你的账户存取额(正为存入，负为取出)：&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> cunruzhi = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">            <span class="keyword">if</span> (cunruzhi &gt;= <span class="number">0</span>)<span class="comment">//输出账户存入的存入额</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t已存入金额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(Math.Abs(cunruzhi)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (Math.Abs(cunruzhi) &gt; myclass_cunqu.YuE)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t取出金额不能大于账户的余额：&#123;0&#125;元；&quot;</span>,FormatMoney(myclass_cunqu.YuE));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t已取出金额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(Math.Abs(cunruzhi)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//输出账户余额</span></span><br><span class="line">            myclass_cunqu.CunQu(cunruzhi);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t你的账户的余额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(myclass_cunqu.YuE));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//格式化金额</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">FormatMoney</span>(<span class="params"><span class="built_in">int</span> money</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (money.ToString().Length &gt; <span class="number">4</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span> fenge1 = money.ToString().Substring(<span class="number">0</span>, money.ToString().Length - <span class="number">4</span>);</span><br><span class="line">                <span class="built_in">string</span> fenge2 = money.ToString().Substring(money.ToString().Length - <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">                <span class="keyword">if</span> (fenge1.Length &gt; <span class="number">4</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> FormatMoney(Convert.ToInt32(fenge1)) + <span class="string">&quot;,&quot;</span> + fenge2;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> fenge1 + <span class="string">&quot;,&quot;</span> + fenge2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> money.ToString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//购号花费金额</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ZiJin_qu</span>(<span class="params"><span class="built_in">int</span> zhushu</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Class2_ZiJinBianHua myclass_qu = <span class="keyword">new</span> Class2_ZiJinBianHua();</span><br><span class="line">            <span class="built_in">int</span> cunruzhi = <span class="number">-2</span> * zhushu;</span><br><span class="line">            <span class="keyword">if</span> (cunruzhi &lt; <span class="number">0</span>)<span class="comment">//输出账户存入的存入额</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t已花费金额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(Math.Abs(cunruzhi)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//输出账户余额</span></span><br><span class="line">            myclass_qu.CunQu(cunruzhi);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t你的账户的余额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(myclass_qu.YuE));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//中奖存入金额</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ZiJin_cun</span>(<span class="params"><span class="built_in">int</span> cunruzhi</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Class2_ZiJinBianHua myclass_cun = <span class="keyword">new</span> Class2_ZiJinBianHua();</span><br><span class="line">            <span class="keyword">if</span> (cunruzhi &gt; <span class="number">0</span>)<span class="comment">//输出账户存入的存入额</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t你的账户已存入金额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(cunruzhi));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//输出账户余额</span></span><br><span class="line">            myclass_cun.CunQu(cunruzhi);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t你的账户的余额为：&#123;0:C&#125;元；&quot;</span>, FormatMoney(myclass_cun.YuE));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class2_ZiJinBianHua</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">ChuShiYuE</span>(<span class="params"><span class="built_in">int</span> chushiyue</span>)<span class="comment">//接受初始余额</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            YuE = chushiyue;</span><br><span class="line">            <span class="keyword">return</span> YuE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CunQu</span>(<span class="params"><span class="built_in">int</span> cunqu</span>) <span class="comment">//接受存钱</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            YuE = YuE + cunqu;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> yue; <span class="comment">//余额</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> YuE</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> yue;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">set</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">value</span> &gt;= <span class="number">0</span>)</span><br><span class="line">                    yue = <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-0模拟选号-cs"><a href="#3-0模拟选号-cs" class="headerlink" title="3_0模拟选号.cs"></a>3_0模拟选号.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:3_0模拟选号.cs</span></span><br><span class="line"><span class="comment">//        description:模拟选号文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class3</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HaoMa</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Class3_1 myclass3_1_xitong = <span class="keyword">new</span> Class3_1();</span><br><span class="line">            Class3_2 myclass3_2_shoudong = <span class="keyword">new</span> Class3_2();</span><br><span class="line">            Class3_3 myclass3_3_kaijiang = <span class="keyword">new</span> Class3_3();</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;         =======================================模拟双色球开始=======================================&quot;</span>);</span><br><span class="line">            Class2_ZiJi myclass2_zijin = <span class="keyword">new</span> Class2_ZiJi();</span><br><span class="line">            myclass2_zijin.ZiJin_shouci();<span class="comment">//账户资金</span></span><br><span class="line">            <span class="built_in">int</span> biaojizhi = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (biaojizhi != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;请选择：1.系统购号【Q/q】； \t2.手动购号【W/w】；\t3.对已购双色球开奖【E/e】； \t4.返回主菜单【R/r】；&quot;</span>);</span><br><span class="line">                <span class="built_in">string</span> xuanze = Console.ReadLine().ToUpper();</span><br><span class="line">                <span class="keyword">switch</span> (xuanze)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了系统购号；&quot;</span>);</span><br><span class="line">                        myclass3_1_xitong.XiTong();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;W&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了手动购号；&quot;</span>);</span><br><span class="line">                        myclass3_2_shoudong.ShouDong();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;E&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了对已购买双色球开奖；&quot;</span>);</span><br><span class="line">                        myclass3_3_kaijiang.ZhongJiang();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;R&quot;</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你选择了返回主菜单；&quot;</span>);</span><br><span class="line">                        biaojizhi = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="literal">default</span>:</span><br><span class="line">                        Console.WriteLine(<span class="string">&quot;你的输入有误，请重新输入!&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;         =======================================模拟双色球结束=======================================&quot;</span>);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1系统购号-cs"><a href="#3-1系统购号-cs" class="headerlink" title="3_1系统购号.cs"></a>3_1系统购号.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:3_1系统购号.cs</span></span><br><span class="line"><span class="comment">//        description:系统购号文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class3_1</span></span><br><span class="line">    &#123;</span><br><span class="line">        Class2_ZiJi myclass2_zijin = <span class="keyword">new</span> Class2_ZiJi();</span><br><span class="line">        Class2_ZiJinBianHua myclass2_yue = <span class="keyword">new</span> Class2_ZiJinBianHua();</span><br><span class="line">        Class4 XiTong_myclass4 = <span class="keyword">new</span> Class4();</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span>[] xitonggouhao = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">XiTong</span>(<span class="params"></span>)<span class="comment">//系统购买</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                    =============================系统购号开始=============================&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入你要购买几注双色球:&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> zhushu = <span class="built_in">int</span>.Parse(Console.ReadLine());<span class="comment">//定义购买双色球的注数</span></span><br><span class="line">            <span class="keyword">if</span> ((<span class="built_in">decimal</span>)zhushu * <span class="number">2</span> &gt; myclass2_yue.YuE)<span class="comment">//判断余额</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> ((<span class="built_in">decimal</span>)zhushu * <span class="number">2</span> &gt; myclass2_yue.YuE)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你的账户余额不够购买&#123;0&#125;注双色球，请充值；&quot;</span>, zhushu);</span><br><span class="line">                    myclass2_zijin.ZiJin_cunqu();</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;请输入你要购买几注双色球:&quot;</span>);</span><br><span class="line">                    zhushu = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t系统正在为你购买【&#123;0&#125;】注双色球...&quot;</span>, zhushu);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> zhushujishu = <span class="number">1</span>; zhushujishu &lt;= zhushu; zhushujishu++)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">&quot;第【&#123;0,2&#125;】注：&quot;</span>, zhushujishu);</span><br><span class="line">                Red();</span><br><span class="line">                Blue();</span><br><span class="line">                Console.Write(<span class="string">&quot;\t【系统购号】&quot;</span>);</span><br><span class="line">                Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, DateTime.Now.ToString());</span><br><span class="line">                XiTong_myclass4.XiTongGouHaoJiLu(zhushujishu, xitonggouhao);</span><br><span class="line">                Console.WriteLine();</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t系统已为你完成购买【&#123;0,2&#125;】注双色球！&quot;</span>, zhushu);</span><br><span class="line">            myclass2_zijin.ZiJin_qu(zhushu);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                    =============================系统购号结束=============================&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                           (你可以选择继续购号或开奖)&quot;</span>);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Red</span>(<span class="params"></span>)<span class="comment">//红色球</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span>[] zuheredshuzi = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];<span class="comment">//定义红色球数组</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> everyzhushushuzi = <span class="number">0</span>; everyzhushushuzi &lt; zuheredshuzi.Length; everyzhushushuzi++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span> redshuzi = random.Next(<span class="number">1</span>, <span class="number">34</span>);<span class="comment">//产生随机数字（1-33）</span></span><br><span class="line">                redshuzi = RedChongFu(everyzhushushuzi, zuheredshuzi, redshuzi);</span><br><span class="line">                zuheredshuzi[everyzhushushuzi] = redshuzi;</span><br><span class="line">            &#125;</span><br><span class="line">            RedShengXu(zuheredshuzi);</span><br><span class="line">            RedShuChu(zuheredshuzi);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">RedChongFu</span>(<span class="params"><span class="built_in">int</span> everyzhushushuzi,<span class="built_in">int</span>[] zuheredshuzi,<span class="built_in">int</span> redshuzi</span>)<span class="comment">//红色球_重复数字检验</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> chongfu = <span class="number">0</span>; chongfu &lt; everyzhushushuzi; chongfu++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> (redshuzi == zuheredshuzi[chongfu])</span><br><span class="line">                &#123;</span><br><span class="line">                    redshuzi = random.Next(<span class="number">1</span>, <span class="number">34</span>);</span><br><span class="line">                    redshuzi = RedChongFu(everyzhushushuzi, zuheredshuzi, redshuzi);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> redshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RedShengXu</span>(<span class="params"><span class="built_in">int</span>[] zuheredshuzi</span>)<span class="comment">//红色球_升序</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; zuheredshuzi.Length - <span class="number">1</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; zuheredshuzi.Length - <span class="number">1</span> - i; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (zuheredshuzi[j] &gt; zuheredshuzi[j + <span class="number">1</span>])</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">int</span> max = zuheredshuzi[j];</span><br><span class="line">                        zuheredshuzi[j] = zuheredshuzi[j + <span class="number">1</span>];</span><br><span class="line">                        zuheredshuzi[j + <span class="number">1</span>] = max;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RedShuChu</span>(<span class="params"><span class="built_in">int</span>[] zuheredshuzi</span>)<span class="comment">//红色球_输出</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;红色球：&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> shuchu = <span class="number">0</span>; shuchu &lt; zuheredshuzi.Length; shuchu++)</span><br><span class="line">            &#123;</span><br><span class="line">                System.Threading.Thread.Sleep(<span class="number">50</span>);</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, zuheredshuzi[shuchu]);</span><br><span class="line">                xitonggouhao[shuchu] = zuheredshuzi[shuchu];</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Blue</span>(<span class="params"></span>)<span class="comment">//蓝色球</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> blueshuzi = random.Next(<span class="number">1</span>, <span class="number">17</span>);<span class="comment">//产生随机数字（1-16）</span></span><br><span class="line">            Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);<span class="comment">//输出</span></span><br><span class="line">            System.Threading.Thread.Sleep(<span class="number">50</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, blueshuzi);</span><br><span class="line">            xitonggouhao[<span class="number">6</span>] = blueshuzi;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-2手动购号-cs"><a href="#3-2手动购号-cs" class="headerlink" title="3_2手动购号.cs"></a>3_2手动购号.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:3_2手动购号.cs</span></span><br><span class="line"><span class="comment">//        description:手动购号文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class3_2</span></span><br><span class="line">    &#123;</span><br><span class="line">        Class2_ZiJi myclass2_zijin = <span class="keyword">new</span> Class2_ZiJi();</span><br><span class="line">        Class2_ZiJinBianHua myclass2_yue = <span class="keyword">new</span> Class2_ZiJinBianHua();</span><br><span class="line">        Class4 ShouDong_myclass4 = <span class="keyword">new</span> Class4();</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span>[] shoudonggouhao = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShouDong</span>(<span class="params"></span>)<span class="comment">//手动购买</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                    =============================手动购号开始=============================&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入你要购买几注双色球:&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> zhushu = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">            <span class="keyword">if</span> ((<span class="built_in">decimal</span>)zhushu * <span class="number">2</span> &gt; myclass2_yue.YuE)<span class="comment">//判断余额</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> ((<span class="built_in">decimal</span>)zhushu * <span class="number">2</span> &gt; myclass2_yue.YuE)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;\t你的账户余额不够购买&#123;0&#125;注双色球，请充值；&quot;</span>, zhushu);</span><br><span class="line">                    myclass2_zijin.ZiJin_cunqu();</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;请输入你要购买几注双色球:&quot;</span>);</span><br><span class="line">                    zhushu = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t你正在手动购买【&#123;0&#125;】注双色球...&quot;</span>, zhushu);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> zhushujishu = <span class="number">1</span>; zhushujishu &lt;= zhushu; zhushujishu++)<span class="comment">//对注数进行计数</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span>[] allredshuzi = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];<span class="comment">//定义红色球数字组合后的数组</span></span><br><span class="line">                <span class="built_in">int</span> blueshuzi = <span class="number">0</span>;<span class="comment">//定义蓝色球数字</span></span><br><span class="line">                Red(zhushujishu, allredshuzi);<span class="comment">//调用红色球方法</span></span><br><span class="line">                blueshuzi = Blue(zhushujishu);<span class="comment">//调用蓝色球方法</span></span><br><span class="line">                Console.Write(<span class="string">&quot;第【&#123;0,2&#125;】注：&quot;</span>, zhushujishu);</span><br><span class="line">                ShuChu(zhushujishu, allredshuzi, blueshuzi);<span class="comment">//组合输出双色球</span></span><br><span class="line">                Console.Write(<span class="string">&quot;\t【手动购号】&quot;</span>);</span><br><span class="line">                Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, DateTime.Now.ToString());</span><br><span class="line">                ShouDong_myclass4.ShouDongGouHaoJiLu(zhushujishu, shoudonggouhao);</span><br><span class="line">                Console.WriteLine();</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t你已完成手动购买【&#123;0,2&#125;】注双色球！&quot;</span>, zhushu);</span><br><span class="line">            myclass2_zijin.ZiJin_qu(zhushu);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                    =============================手动购号结束=============================&quot;</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                           (你可以选择继续购号或开奖)&quot;</span>);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Red</span>(<span class="params"><span class="built_in">int</span> zhushujishu, <span class="built_in">int</span>[] allredshuzi</span>)<span class="comment">//红色球</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入第[&#123;0,2&#125;]注你要选择的(1-33之间的)6个[红色球]号码：&quot;</span>, zhushujishu);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> everyzhushushuzi = <span class="number">0</span>; everyzhushushuzi &lt; allredshuzi.Length; everyzhushushuzi++)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">&quot;第&#123;0&#125;位：&quot;</span>, everyzhushushuzi + <span class="number">1</span>);</span><br><span class="line">                <span class="built_in">int</span> redshuzi = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                redshuzi = RedPanDuan(everyzhushushuzi, redshuzi, allredshuzi); <span class="comment">//红色球_判断</span></span><br><span class="line">                allredshuzi[everyzhushushuzi] = redshuzi;</span><br><span class="line">            &#125;</span><br><span class="line">            RedShengXu(allredshuzi);<span class="comment">//调用红色球_升序的方法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">RedPanDuan</span>(<span class="params"><span class="built_in">int</span> everyzhushushuzi, <span class="built_in">int</span> redshuzi, <span class="built_in">int</span>[] allredshuzi</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            redshuzi = RedFanWei(everyzhushushuzi, redshuzi);<span class="comment">//调用红色球_范围的方法</span></span><br><span class="line">            redshuzi = RedChongFu(everyzhushushuzi, redshuzi, allredshuzi);<span class="comment">//调用红色球_重复数字检验的方法</span></span><br><span class="line">            <span class="keyword">return</span> redshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">RedFanWei</span>(<span class="params"><span class="built_in">int</span> everyzhushushuzi, <span class="built_in">int</span> redshuzi</span>)<span class="comment">//红色球_范围</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (!(redshuzi &gt;= <span class="number">1</span> &amp;&amp; redshuzi &lt;= <span class="number">33</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(redshuzi &gt;= <span class="number">1</span> &amp;&amp; redshuzi &lt;= <span class="number">33</span>))<span class="comment">//判断输入数字是否在（1-33）范围内，若不是，重新输入，若是，赋值</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Console.Write(<span class="string">&quot;第&#123;0&#125;位数：(输入范围错误！[&#123;1&#125;]超出了输入范围,请重新输入(1-33之间)的数)&quot;</span>, everyzhushushuzi + <span class="number">1</span>, redshuzi);</span><br><span class="line">                    redshuzi = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                    redshuzi = RedFanWei(everyzhushushuzi, redshuzi);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> redshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">RedChongFu</span>(<span class="params"><span class="built_in">int</span> everyzhushushuzi, <span class="built_in">int</span> redshuzi, <span class="built_in">int</span>[] allredshuzi</span>)<span class="comment">//红色球_重复数字检验</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> xuhao = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span> chongfubiaojizhi = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; everyzhushushuzi; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (redshuzi == allredshuzi[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    xuhao = i;</span><br><span class="line">                    chongfubiaojizhi++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (chongfubiaojizhi != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span> biaojizhi = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (biaojizhi != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> chongfutishi = <span class="string">&quot;除&quot;</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="built_in">int</span> shuchu = <span class="number">0</span>; shuchu &lt; everyzhushushuzi; shuchu++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">string</span> chongfushu = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="built_in">int</span> t = <span class="number">0</span>; t &lt;= shuchu; t++)</span><br><span class="line">                        &#123;</span><br><span class="line">                            chongfushu = <span class="string">&quot;[&quot;</span> + Convert.ToString(allredshuzi[t]) + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        chongfutishi = chongfutishi + chongfushu;</span><br><span class="line">                    &#125;</span><br><span class="line">                    Console.Write(<span class="string">&quot;第&#123;0&#125;位数：(输入重复错误！你购买的第&#123;1&#125;位数字已存在数字&#123;2&#125;，请重新输入(1-33之间)(&#123;3&#125;)的数)&quot;</span>, everyzhushushuzi + <span class="number">1</span>, xuhao + <span class="number">1</span>, redshuzi, chongfutishi);</span><br><span class="line">                    redshuzi = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                    redshuzi = RedPanDuan(everyzhushushuzi, redshuzi, allredshuzi);</span><br><span class="line">                    biaojizhi = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> redshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RedShengXu</span>(<span class="params"><span class="built_in">int</span>[] allredshuzi</span>)<span class="comment">//红色球_升序</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; allredshuzi.Length - <span class="number">1</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; allredshuzi.Length - <span class="number">1</span> - i; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (allredshuzi[j] &gt; allredshuzi[j + <span class="number">1</span>])</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">int</span> max = allredshuzi[j];</span><br><span class="line">                        allredshuzi[j] = allredshuzi[j + <span class="number">1</span>];</span><br><span class="line">                        allredshuzi[j + <span class="number">1</span>] = max;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">Blue</span>(<span class="params"><span class="built_in">int</span> zhushujishu</span>)<span class="comment">//蓝色球</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;请输入第[&#123;0,2&#125;]注你要选择的(1-16之间的)1个[蓝色球]号码：&quot;</span>, zhushujishu);</span><br><span class="line">            Console.Write(<span class="string">&quot;第1位：&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> blueshuzi = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">            blueshuzi = BlueFanWei(blueshuzi);<span class="comment">//调用蓝色球_范围的方法</span></span><br><span class="line">            <span class="keyword">return</span> blueshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">BlueFanWei</span>(<span class="params"><span class="built_in">int</span> blueshuzi</span>)<span class="comment">//蓝色球_范围</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (!(blueshuzi &gt;= <span class="number">1</span> &amp;&amp; blueshuzi &lt;= <span class="number">16</span>))<span class="comment">//判断输入数字是否在（1-16）范围内，若是，返回值，若不是，重新输入</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(blueshuzi &gt;= <span class="number">1</span> &amp;&amp; blueshuzi &lt;= <span class="number">16</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.Write(<span class="string">&quot;第1位数：(输入范围错误！请重新输入(1-16之间)的数)&quot;</span>);</span><br><span class="line">                    blueshuzi = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> blueshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShuChu</span>(<span class="params"><span class="built_in">int</span> zhushujishu, <span class="built_in">int</span>[] allredshuzi, <span class="built_in">int</span> blueshuzi</span>)<span class="comment">//总输出</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            ShuChuRed(allredshuzi);</span><br><span class="line">            ShuChuBlue(zhushujishu, blueshuzi);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShuChuRed</span>(<span class="params"><span class="built_in">int</span>[] allredshuzi</span>)<span class="comment">//红色球_输出</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;红色球：&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> shuchu = <span class="number">0</span>; shuchu &lt; allredshuzi.Length; shuchu++)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, allredshuzi[shuchu]);</span><br><span class="line">                shoudonggouhao[shuchu] = allredshuzi[shuchu];</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShuChuBlue</span>(<span class="params"><span class="built_in">int</span> zhushujishu, <span class="built_in">int</span> blueshuzi</span>)<span class="comment">//蓝色球_输出</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, blueshuzi);</span><br><span class="line">            shoudonggouhao[<span class="number">6</span>] = blueshuzi;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-3模拟开奖-cs"><a href="#3-3模拟开奖-cs" class="headerlink" title="3_3模拟开奖.cs"></a>3_3模拟开奖.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:3_3模拟开奖.cs</span></span><br><span class="line"><span class="comment">//        description:模拟开奖文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class3_3</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/*------------中奖入口-----------判断是否开奖(判断记录存在)------------开奖结果------------查找数据-------------*/</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> duquming_kaijiang_xitong = <span class="string">&quot;系统购号&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> duquming_kaijiang_shoudong = <span class="string">&quot;手动购号&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">bool</span> chazhaojilu;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> hangshu;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> monijiangchi;<span class="comment">//模拟奖池</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> zong_zhongjiang = <span class="number">0</span>;<span class="comment">//中奖总数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> yi_zhongjiang = <span class="number">0</span>;<span class="comment">//一等奖总数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> er_zhongjiang = <span class="number">0</span>;<span class="comment">//二等总数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> san_zhongjiang = <span class="number">0</span>;<span class="comment">//三等总数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> si_zhongjiang = <span class="number">0</span>;<span class="comment">//四等总数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> wu_zhongjiang = <span class="number">0</span>;<span class="comment">//五等总数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> liu_zhongjiang = <span class="number">0</span>;<span class="comment">//六等总数</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span>[] kaijianghong = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span> zhongjiangdengji;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> zhongjiangjine;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> zhongjiangjine_zong;</span><br><span class="line">        Class5 myclass5_duqu = <span class="keyword">new</span> Class5();</span><br><span class="line">        Class2_ZiJi myclass2_zijin = <span class="keyword">new</span> Class2_ZiJi();</span><br><span class="line">        <span class="comment">/*--------------中奖入口----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ZhongJiang</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            PanDuan_kaijiang(); <span class="comment">//判断是否开奖</span></span><br><span class="line">            <span class="comment">//判断记录存在、开奖结果</span></span><br><span class="line">            <span class="keyword">if</span> (chazhaojilu) &#123; ChaZhao_shuju(); &#125;<span class="comment">//记录存在时查找数据</span></span><br><span class="line">            ShanChu_gouhaojilu();<span class="comment">//删除购号记录</span></span><br><span class="line">        &#125;</span><br><span class="line">        Class4 myclass4_dayin = <span class="keyword">new</span> Class4();</span><br><span class="line">        <span class="comment">/*--------------判断是否开奖----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">PanDuan_kaijiang</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            myclass4_dayin.ShanChuKaiJiangWenJian();<span class="comment">//删除开奖前创建的模拟开奖历史记录</span></span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t正在判断是否开奖...&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            System.Threading.Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">            chazhaojilu = myclass5_duqu.ChaZhao();</span><br><span class="line">            PanDuan_jilucunzai(chazhaojilu);<span class="comment">//判断记录存在</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------判断记录存在----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">PanDuan_jilucunzai</span>(<span class="params"><span class="built_in">bool</span> panduancunzai</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.Write(<span class="string">&quot;\t正在判断是否存在购号记录...&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            System.Threading.Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">            <span class="keyword">if</span> (panduancunzai)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">&quot;\t存在购号记录，即将开奖！\n&quot;</span>);</span><br><span class="line">                KaiJiang();<span class="comment">//存在购号记录后开奖</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">&quot;\t你没有任何形式的购号记录，请先购号后开奖！\n&quot;</span>);</span><br><span class="line">                Console.WriteLine();</span><br><span class="line">            &#125;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------开奖结果----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">KaiJiang</span>(<span class="params"></span>)<span class="comment">//产生开奖号</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                ================模拟开奖开始================&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t正在产生开奖号码...&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            Console.Write(<span class="string">&quot;【开奖号码】&quot;</span>);</span><br><span class="line">            Red();</span><br><span class="line">            Blue();</span><br><span class="line">            Console.Write(<span class="string">&quot;\t【模拟开奖】&quot;</span>);</span><br><span class="line">            Console.Write(<span class="string">&quot;时间:&#123;0&#125;\n&quot;</span>, DateTime.Now.ToString());</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t开奖号码已产生!\n&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.Write(<span class="string">&quot;\t正在计算奖池金额...&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            Random jiangchi = <span class="keyword">new</span> Random();</span><br><span class="line">            monijiangchi = jiangchi.Next(<span class="number">56214873</span>, <span class="number">942746513</span>);</span><br><span class="line">            System.Threading.Thread.Sleep(<span class="number">3000</span>);</span><br><span class="line">            Console.Write(<span class="string">&quot;\t本次开奖奖池金额为：[&#123;0&#125;]元;\n&quot;</span>, myclass2_zijin.FormatMoney(monijiangchi));</span><br><span class="line">            myclass4_dayin.MoNiKaiJiang(kaijianghong, myclass2_zijin.FormatMoney(monijiangchi));<span class="comment">//打印模拟开奖记录</span></span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                ================模拟开奖结束================&quot;</span>);</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Red</span>(<span class="params"></span>)<span class="comment">//红色球</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span>[] zuheredshuzi = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];<span class="comment">//定义红色球数组</span></span><br><span class="line">            Random red = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> everyzhushushuzi = <span class="number">0</span>; everyzhushushuzi &lt; zuheredshuzi.Length; everyzhushushuzi++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span> redshuzi = red.Next(<span class="number">1</span>, <span class="number">34</span>);<span class="comment">//产生随机数字（1-33）</span></span><br><span class="line">                redshuzi = RedChongFu(everyzhushushuzi, zuheredshuzi, redshuzi);</span><br><span class="line">                zuheredshuzi[everyzhushushuzi] = redshuzi;</span><br><span class="line">            &#125;</span><br><span class="line">            RedShengXu(zuheredshuzi);</span><br><span class="line">            RedShuChu(zuheredshuzi);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">RedChongFu</span>(<span class="params"><span class="built_in">int</span> everyzhushushuzi, <span class="built_in">int</span>[] zuheredshuzi, <span class="built_in">int</span> redshuzi</span>)<span class="comment">//红色球_重复数字检验</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Random redchongfu = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> chongfu = <span class="number">0</span>; chongfu &lt; everyzhushushuzi; chongfu++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> (redshuzi == zuheredshuzi[chongfu])</span><br><span class="line">                &#123;</span><br><span class="line">                    redshuzi = redchongfu.Next(<span class="number">1</span>, <span class="number">34</span>);</span><br><span class="line">                    redshuzi = RedChongFu(everyzhushushuzi, zuheredshuzi, redshuzi);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> redshuzi;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RedShengXu</span>(<span class="params"><span class="built_in">int</span>[] zuheredshuzi</span>)<span class="comment">//红色球_升序</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; zuheredshuzi.Length - <span class="number">1</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; zuheredshuzi.Length - <span class="number">1</span> - i; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (zuheredshuzi[j] &gt; zuheredshuzi[j + <span class="number">1</span>])</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">int</span> max = zuheredshuzi[j];</span><br><span class="line">                        zuheredshuzi[j] = zuheredshuzi[j + <span class="number">1</span>];</span><br><span class="line">                        zuheredshuzi[j + <span class="number">1</span>] = max;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RedShuChu</span>(<span class="params"><span class="built_in">int</span>[] zuheredshuzi</span>)<span class="comment">//红色球_输出</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;红色球：&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> shuchu = <span class="number">0</span>; shuchu &lt; zuheredshuzi.Length; shuchu++)</span><br><span class="line">            &#123;</span><br><span class="line">                System.Threading.Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, zuheredshuzi[shuchu]);</span><br><span class="line">                kaijianghong[shuchu] = zuheredshuzi[shuchu];</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Blue</span>(<span class="params"></span>)<span class="comment">//蓝色球</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Random blue = <span class="keyword">new</span> Random();</span><br><span class="line">            System.Threading.Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">            <span class="built_in">int</span> blueshuzi = blue.Next(<span class="number">1</span>, <span class="number">17</span>);<span class="comment">//产生随机数字（1-16）</span></span><br><span class="line">            Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);<span class="comment">//输出</span></span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, blueshuzi);</span><br><span class="line">            kaijianghong[<span class="number">6</span>] = blueshuzi;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------查找数据----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChaZhao_shuju</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t正在查找数据，请稍候...&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                        ========查看中奖开始========&quot;</span>);</span><br><span class="line">            ChaZhao_shuju_xitong(); <span class="comment">//查找数据_系统</span></span><br><span class="line">            ChaZhao_shuju_shoudong();<span class="comment">//查找数据_手动</span></span><br><span class="line">            <span class="keyword">if</span> (zong_zhongjiang == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t抱歉，你没有中奖！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t你共中奖[&#123;0&#125;]注，获得总奖金：[&#123;7&#125;]元！其中：\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;\t一等奖[&#123;1&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;二等奖[&#123;2&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;三等奖[&#123;3&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;四等奖[&#123;4&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;五等奖[&#123;5&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;六等奖[&#123;6&#125;]注；&quot;</span>, zong_zhongjiang, yi_zhongjiang, er_zhongjiang, san_zhongjiang, si_zhongjiang, wu_zhongjiang, liu_zhongjiang, myclass2_zijin.FormatMoney(zhongjiangjine_zong));</span><br><span class="line">            &#125;</span><br><span class="line">            myclass2_zijin.ZiJin_cun(zhongjiangjine_zong);</span><br><span class="line">            myclass4_dayin.MoNiKaiJiang_zhongjiang_jine_zong(zong_zhongjiang, yi_zhongjiang, er_zhongjiang, san_zhongjiang, si_zhongjiang, wu_zhongjiang, liu_zhongjiang, myclass2_zijin.FormatMoney(zhongjiangjine_zong));</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;                                        ========查看中奖结束========&quot;</span>);</span><br><span class="line">            zong_zhongjiang = <span class="number">0</span>;<span class="comment">//总中奖数清零</span></span><br><span class="line">            yi_zhongjiang = <span class="number">0</span>;<span class="comment">//一等奖总数清零</span></span><br><span class="line">            er_zhongjiang = <span class="number">0</span>;<span class="comment">//二等总数清零</span></span><br><span class="line">            san_zhongjiang = <span class="number">0</span>;<span class="comment">//三等总数清零</span></span><br><span class="line">            si_zhongjiang = <span class="number">0</span>;<span class="comment">//四等总数清零</span></span><br><span class="line">            wu_zhongjiang = <span class="number">0</span>;<span class="comment">//五等总数清零</span></span><br><span class="line">            liu_zhongjiang = <span class="number">0</span>;<span class="comment">//六等总数清零</span></span><br><span class="line">            zhongjiangjine_zong = <span class="number">0</span>;<span class="comment">//总中奖金额清零</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChaZhao_shuju_xitong</span>(<span class="params"></span>)<span class="comment">//查找数据_系统</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bool</span> xitong_cunzai = myclass5_duqu.ChaZhao_xitong();<span class="comment">//判断是否存在系统购号记录</span></span><br><span class="line">            <span class="keyword">if</span> (xitong_cunzai)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t查找到系统购号数据，正在读取...&quot;</span>);</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">                DuQu_hangshu(duquming_kaijiang_xitong);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t你没有系统购号数据！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChaZhao_shuju_shoudong</span>(<span class="params"></span>)<span class="comment">//查找数据_手动</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bool</span> shoudong_cunzai = myclass5_duqu.ChaZhao_shoudong();<span class="comment">//判断是否存在手动购号记录</span></span><br><span class="line">            <span class="keyword">if</span> (shoudong_cunzai)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t查找到手动购号数据，正在读取...&quot;</span>);</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">                DuQu_hangshu(duquming_kaijiang_shoudong);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t你没有手动购号数据！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*-----------------读取数据-------------判断数据---------------判断中奖----------------输出中奖-----------删除购号记录-----------*/</span></span><br><span class="line">        <span class="comment">/*--------------读取数据----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DuQu_hangshu</span>(<span class="params"><span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//读取行数</span></span><br><span class="line">            hangshu = myclass5_duqu.DuQu_hang(duquming);</span><br><span class="line">            <span class="comment">//判断数据</span></span><br><span class="line">            PanDuan_shuju(duquming);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------判断数据----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PanDuan_shuju</span>(<span class="params"><span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> red = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span> blue = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span>[] duqu = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];</span><br><span class="line">            duqu = myclass5_duqu.DuQu_shuzi;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> everyhang = <span class="number">1</span>; everyhang &lt;= hangshu; everyhang++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//读取数据</span></span><br><span class="line">                myclass5_duqu.DuQu_shuju(everyhang, duquming);</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> kaijianghong_weishu = <span class="number">0</span>; kaijianghong_weishu &lt; kaijianghong.Length - <span class="number">1</span>; kaijianghong_weishu++)<span class="comment">//开奖号数字</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="built_in">int</span> duququ_weishu = <span class="number">0</span>; duququ_weishu &lt; <span class="number">6</span>; duququ_weishu++)<span class="comment">//读取号数字</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (kaijianghong[kaijianghong_weishu] == duqu[duququ_weishu])</span><br><span class="line">                        &#123;</span><br><span class="line">                            red++;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (kaijianghong[<span class="number">6</span>] == duqu[<span class="number">6</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    blue = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                PanDuan_zhongjiang(myclass5_duqu.DuQu_xuhao, red, blue, myclass5_duqu.DuQu_time, duqu, duquming);</span><br><span class="line">                red = <span class="number">0</span>;<span class="comment">//对比之后红色计数归零</span></span><br><span class="line">                blue = <span class="number">0</span>;<span class="comment">//对比之后蓝色计数归零</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------判断中奖----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PanDuan_zhongjiang</span>(<span class="params"><span class="built_in">int</span> xuhao, <span class="built_in">int</span> red, <span class="built_in">int</span> blue, <span class="built_in">string</span> time, <span class="built_in">int</span>[] duqu, <span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bool</span> shuchu = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (red == <span class="number">6</span> &amp;&amp; blue == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangdengji = <span class="string">&quot;一&quot;</span>;</span><br><span class="line">                zhongjiangjine = Convert.ToInt32(monijiangchi * <span class="number">0.6</span>);</span><br><span class="line">                <span class="keyword">if</span> (monijiangchi &gt;= <span class="number">100000000</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    zhongjiangjine = <span class="number">5000000</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                zong_zhongjiang++;</span><br><span class="line">                yi_zhongjiang++;</span><br><span class="line">                shuchu = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (red == <span class="number">6</span> &amp;&amp; blue == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangdengji = <span class="string">&quot;二&quot;</span>;</span><br><span class="line">                zhongjiangjine = Convert.ToInt32(monijiangchi * <span class="number">0.2</span>);</span><br><span class="line">                <span class="keyword">if</span> (monijiangchi &gt;= <span class="number">100000000</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    zhongjiangjine = <span class="number">500000</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                zong_zhongjiang++;</span><br><span class="line">                er_zhongjiang++;</span><br><span class="line">                shuchu = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (red == <span class="number">5</span> &amp;&amp; blue == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangdengji = <span class="string">&quot;三&quot;</span>;</span><br><span class="line">                zhongjiangjine = <span class="number">3000</span>;</span><br><span class="line">                zong_zhongjiang++;</span><br><span class="line">                san_zhongjiang++;</span><br><span class="line">                shuchu = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ((red == <span class="number">5</span> &amp;&amp; blue == <span class="number">0</span>) || (red == <span class="number">4</span> &amp;&amp; blue == <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangdengji = <span class="string">&quot;四&quot;</span>;</span><br><span class="line">                zhongjiangjine = <span class="number">200</span>;</span><br><span class="line">                zong_zhongjiang++;</span><br><span class="line">                si_zhongjiang++;</span><br><span class="line">                shuchu = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ((red == <span class="number">4</span> &amp;&amp; blue == <span class="number">0</span>) || (red == <span class="number">3</span> &amp;&amp; blue == <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangdengji = <span class="string">&quot;五&quot;</span>;</span><br><span class="line">                zhongjiangjine = <span class="number">10</span>;</span><br><span class="line">                zong_zhongjiang++;</span><br><span class="line">                wu_zhongjiang++;</span><br><span class="line">                shuchu = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ((red == <span class="number">2</span> &amp;&amp; blue == <span class="number">1</span>) || (red == <span class="number">1</span> &amp;&amp; blue == <span class="number">1</span>) || (red == <span class="number">0</span> &amp;&amp; blue == <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangdengji = <span class="string">&quot;六&quot;</span>;</span><br><span class="line">                zhongjiangjine = <span class="number">5</span>;</span><br><span class="line">                zong_zhongjiang++;</span><br><span class="line">                liu_zhongjiang++;</span><br><span class="line">                shuchu = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (shuchu)</span><br><span class="line">            &#123;</span><br><span class="line">                zhongjiangjine_zong += zhongjiangjine;</span><br><span class="line">                PanDuan_shuchu(xuhao, duqu, time, duquming);</span><br><span class="line">                Console.Write(<span class="string">&quot;\t[该注中了&#123;0&#125;等奖！获得奖金：&#123;1&#125;元；]&quot;</span>, zhongjiangdengji, myclass2_zijin.FormatMoney(zhongjiangjine));</span><br><span class="line">                myclass4_dayin.MoNiKaiJiang_zhongjiang_jine(zhongjiangdengji, myclass2_zijin.FormatMoney(zhongjiangjine));</span><br><span class="line">                Console.WriteLine();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------中奖输出----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PanDuan_shuchu</span>(<span class="params"><span class="built_in">int</span> xuhao, <span class="built_in">int</span>[] duqu, <span class="built_in">string</span> time, <span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;第【&#123;0,2&#125;】注：红色球：&quot;</span>, xuhao);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, duqu[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            Console.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.Write(<span class="string">&quot;&#123;0,2:D2&#125;&quot;</span>, duqu[<span class="number">6</span>]);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Gray;</span><br><span class="line">            Console.Write(<span class="string">&quot;\t【&#123;0&#125;】&quot;</span>, duquming);</span><br><span class="line">            Console.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            myclass4_dayin.MoNiKaiJiang_zhongjiang(xuhao, duqu, time, duquming);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*--------------删除购号记录----------------*/</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShanChu_gouhaojilu</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            myclass4_dayin.ShanChuXiTongWenJian();<span class="comment">//删除上一次开奖前创建的系统购号记录</span></span><br><span class="line">            myclass4_dayin.ShanChuShouDongWenJian();<span class="comment">//删除上一次开奖前创建的手动购号记录</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-打印数据-cs"><a href="#4-打印数据-cs" class="headerlink" title="4_打印数据.cs"></a>4_打印数据.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:4_打印数据.cs</span></span><br><span class="line"><span class="comment">//        description:打印数据文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class4</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//系统购号记录</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> XiTongFile = <span class="string">@&quot;系统购号.txt&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShanChuXiTongWenJian</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (File.Exists(XiTongFile))</span><br><span class="line">            &#123;</span><br><span class="line">                File.Delete(XiTongFile);<span class="comment">//删除该文件</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">XiTongGouHaoJiLu</span>(<span class="params"><span class="built_in">int</span> zhushujishu, <span class="built_in">int</span>[] shuangseqiu</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            StreamWriter wenjian = File.AppendText(XiTongFile);</span><br><span class="line">            <span class="built_in">string</span> xuhao = <span class="string">&quot;X&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> red = <span class="string">&quot;R&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> blue = <span class="string">&quot;B&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> time = <span class="string">&quot;T&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> gouhaojilu = xuhao + zhushujishu.ToString(<span class="string">&quot;D2&quot;</span>) + red</span><br><span class="line">                + shuangseqiu[<span class="number">0</span>].ToString(<span class="string">&quot;D2&quot;</span>) + shuangseqiu[<span class="number">1</span>].ToString(<span class="string">&quot;D2&quot;</span>) + shuangseqiu[<span class="number">2</span>].ToString(<span class="string">&quot;D2&quot;</span>)</span><br><span class="line">                + shuangseqiu[<span class="number">3</span>].ToString(<span class="string">&quot;D2&quot;</span>) + shuangseqiu[<span class="number">4</span>].ToString(<span class="string">&quot;D2&quot;</span>) + shuangseqiu[<span class="number">5</span>].ToString(<span class="string">&quot;D2&quot;</span>)</span><br><span class="line">                + blue + shuangseqiu[<span class="number">6</span>].ToString(<span class="string">&quot;D2&quot;</span>) + time + DateTime.Now.ToString();</span><br><span class="line">            wenjian.WriteLine(gouhaojilu);</span><br><span class="line">            wenjian.Flush();</span><br><span class="line">            wenjian.Close();</span><br><span class="line">            wenjian.Dispose();<span class="comment">//释放对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//手动购号记录</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> ShouDongFile = <span class="string">@&quot;手动购号.txt&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShanChuShouDongWenJian</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (File.Exists(ShouDongFile))</span><br><span class="line">            &#123;</span><br><span class="line">                File.Delete(ShouDongFile);<span class="comment">//删除该文件</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShouDongGouHaoJiLu</span>(<span class="params"><span class="built_in">int</span> zhushujishu, <span class="built_in">int</span>[] shuangseqiu</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            StreamWriter wenjian = File.AppendText(ShouDongFile);</span><br><span class="line">            <span class="built_in">string</span> xuhao = <span class="string">&quot;X&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> red = <span class="string">&quot;R&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> blue = <span class="string">&quot;B&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> time = <span class="string">&quot;T&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> gouhaojilu = xuhao+zhushujishu.ToString(<span class="string">&quot;D2&quot;</span>)+ red </span><br><span class="line">                + shuangseqiu[<span class="number">0</span>].ToString(<span class="string">&quot;D2&quot;</span>)+ shuangseqiu[<span class="number">1</span>].ToString(<span class="string">&quot;D2&quot;</span>)+ shuangseqiu[<span class="number">2</span>].ToString(<span class="string">&quot;D2&quot;</span>)</span><br><span class="line">                + shuangseqiu[<span class="number">3</span>].ToString(<span class="string">&quot;D2&quot;</span>)+ shuangseqiu[<span class="number">4</span>].ToString(<span class="string">&quot;D2&quot;</span>)+ shuangseqiu[<span class="number">5</span>].ToString(<span class="string">&quot;D2&quot;</span>)</span><br><span class="line">                +blue+ shuangseqiu[<span class="number">6</span>].ToString(<span class="string">&quot;D2&quot;</span>) + time + DateTime.Now.ToString();</span><br><span class="line">            wenjian.WriteLine(gouhaojilu);</span><br><span class="line">            wenjian.Flush();</span><br><span class="line">            wenjian.Close();</span><br><span class="line">            wenjian.Dispose();<span class="comment">//释放对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//模拟开奖记录</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> KaiJiangFile = <span class="string">@&quot;模拟开奖.txt&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShanChuKaiJiangWenJian</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (File.Exists(KaiJiangFile))</span><br><span class="line">            &#123;</span><br><span class="line">                File.Delete(KaiJiangFile);<span class="comment">//删除该文件</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoNiKaiJiang</span>(<span class="params"><span class="built_in">int</span>[] kaijiang,<span class="built_in">string</span> monijiangchi</span>)</span> &#123;</span><br><span class="line">            StreamWriter wenjian = File.AppendText(KaiJiangFile);</span><br><span class="line">            <span class="built_in">string</span> kong = <span class="string">&quot; &quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> gouhaojilu = <span class="string">&quot;【开奖号码】&quot;</span></span><br><span class="line">                + <span class="string">&quot;红色球：&quot;</span> + kaijiang[<span class="number">0</span>].ToString(<span class="string">&quot;D2&quot;</span>) + kong + kaijiang[<span class="number">1</span>].ToString(<span class="string">&quot;D2&quot;</span>) + kong + kaijiang[<span class="number">2</span>].ToString(<span class="string">&quot;D2&quot;</span>)</span><br><span class="line">                + kong + kaijiang[<span class="number">3</span>].ToString(<span class="string">&quot;D2&quot;</span>) + kong + kaijiang[<span class="number">4</span>].ToString(<span class="string">&quot;D2&quot;</span>) + kong + kaijiang[<span class="number">5</span>].ToString(<span class="string">&quot;D2&quot;</span>) + kong</span><br><span class="line">                + <span class="string">&quot;蓝色球：&quot;</span> + kaijiang[<span class="number">6</span>].ToString(<span class="string">&quot;D2&quot;</span>);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;&#123;0&#125;&quot;</span>, gouhaojilu);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;\t【模拟开奖】&quot;</span>);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, DateTime.Now.ToString());</span><br><span class="line">            wenjian.Write(<span class="string">&quot;\t本次开奖奖池金额为：[&#123;0&#125;]元;\n&quot;</span>, monijiangchi);</span><br><span class="line">            wenjian.WriteLine();</span><br><span class="line">            wenjian.Flush();</span><br><span class="line">            wenjian.Close();</span><br><span class="line">            wenjian.Dispose();<span class="comment">//释放对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//模拟开奖中奖记录</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoNiKaiJiang_zhongjiang</span>(<span class="params"><span class="built_in">int</span> xuhao, <span class="built_in">int</span>[] duqu, <span class="built_in">string</span> time, <span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            StreamWriter wenjian = File.AppendText(KaiJiangFile);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;第【&#123;0,2&#125;】注：红色球：&quot;</span>, xuhao);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                wenjian.Write(<span class="string">&quot;&#123;0,2:D2&#125; &quot;</span>, duqu[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            wenjian.Write(<span class="string">&quot;蓝色球：&quot;</span>);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;&#123;0,2:D2&#125;&quot;</span>, duqu[<span class="number">6</span>]);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;\t【&#123;0&#125;】&quot;</span>, duquming);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;时间：&#123;0&#125;&quot;</span>, time);</span><br><span class="line">            wenjian.Flush();</span><br><span class="line">            wenjian.Close();</span><br><span class="line">            wenjian.Dispose();<span class="comment">//释放对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//模拟开奖中奖金额记录</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoNiKaiJiang_zhongjiang_jine</span>(<span class="params"><span class="built_in">string</span> zhongjiangdengji, <span class="built_in">string</span> zhongjiangjine</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            StreamWriter wenjian = File.AppendText(KaiJiangFile);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;\t[该注中了&#123;0&#125;等奖！获得奖金：&#123;1&#125;元；]&quot;</span>, zhongjiangdengji, zhongjiangjine);</span><br><span class="line">            wenjian.WriteLine();</span><br><span class="line">            wenjian.Flush();</span><br><span class="line">            wenjian.Close();</span><br><span class="line">            wenjian.Dispose();<span class="comment">//释放对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//模拟开奖中奖金额记录</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoNiKaiJiang_zhongjiang_jine_zong</span>(<span class="params"><span class="built_in">int</span> zong_zhongjiang, <span class="built_in">int</span> yi_zhongjiang, <span class="built_in">int</span> er_zhongjiang, <span class="built_in">int</span> san_zhongjiang, <span class="built_in">int</span> si_zhongjiang, <span class="built_in">int</span> wu_zhongjiang, <span class="built_in">int</span> liu_zhongjiang, <span class="built_in">string</span> zhongjiangjine_zong</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            StreamWriter wenjian = File.AppendText(KaiJiangFile);</span><br><span class="line">            wenjian.Write(<span class="string">&quot;\t你共中奖[&#123;0&#125;]注，获得总奖金：[&#123;7&#125;]元！其中：\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;\t一等奖[&#123;1&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;二等奖[&#123;2&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;三等奖[&#123;3&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;四等奖[&#123;4&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;五等奖[&#123;5&#125;]注；&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;六等奖[&#123;6&#125;]注；&quot;</span>, zong_zhongjiang, yi_zhongjiang, er_zhongjiang, san_zhongjiang, si_zhongjiang, wu_zhongjiang, liu_zhongjiang, zhongjiangjine_zong);</span><br><span class="line">            wenjian.Flush();</span><br><span class="line">            wenjian.Close();</span><br><span class="line">            wenjian.Dispose();<span class="comment">//释放对象</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-读取数据-cs"><a href="#5-读取数据-cs" class="headerlink" title="5_读取数据.cs"></a>5_读取数据.cs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="comment">//        Copyright © 2018 摘繁华 All Rights Reserved.</span></span><br><span class="line"><span class="comment">//        filename:5_读取数据.cs</span></span><br><span class="line"><span class="comment">//        description:读取数据文件</span></span><br><span class="line"><span class="comment">//        created by 摘繁华 at 2019/10/25</span></span><br><span class="line"><span class="comment">//======================================================================</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Class5</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//定义需要用到的变量</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> duquming_xitong = <span class="string">@&quot;系统购号&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> duquming_shoudong = <span class="string">@&quot;手动购号&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> file_xitong = <span class="string">@&quot;系统购号.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> file_shoudong = <span class="string">@&quot;手动购号.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//查找文件</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ChaZhao</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bool</span> zongchazhao = ChaZhao_xitong() || ChaZhao_shoudong();</span><br><span class="line">            <span class="keyword">return</span> zongchazhao;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ChaZhao_xitong</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (File.Exists(file_xitong));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ChaZhao_shoudong</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (File.Exists(file_shoudong));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//获取行数</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">DuQu_hang</span>(<span class="params"><span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> hang = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (duquming == duquming_xitong)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (StreamReader read = <span class="keyword">new</span> StreamReader(file_xitong, Encoding.Default))</span><br><span class="line">                &#123;</span><br><span class="line">                    hang = read.ReadToEnd().Split(<span class="string">&#x27;\n&#x27;</span>).Length - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (duquming == duquming_shoudong)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (StreamReader read = <span class="keyword">new</span> StreamReader(file_shoudong, Encoding.Default))</span><br><span class="line">                &#123;</span><br><span class="line">                    hang = read.ReadToEnd().Split(<span class="string">&#x27;\n&#x27;</span>).Length - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> hang;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//读取数据</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DuQu_shuju</span>(<span class="params"><span class="built_in">int</span> hang, <span class="built_in">string</span> duquming</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span>[] tiqu = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">if</span> (duquming == duquming_xitong)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span>[] yuanshuju = File.ReadAllLines(file_xitong, Encoding.UTF8);</span><br><span class="line">                tiqu = yuanshuju[hang - <span class="number">1</span>].Split(<span class="keyword">new</span> <span class="built_in">char</span>[<span class="number">4</span>] &#123; <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;T&#x27;</span> &#125;);</span><br><span class="line">                ChaiFen(tiqu);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (duquming == duquming_shoudong)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span>[] yuanshuju = File.ReadAllLines(file_shoudong, Encoding.UTF8);</span><br><span class="line">                tiqu = yuanshuju[hang - <span class="number">1</span>].Split(<span class="keyword">new</span> <span class="built_in">char</span>[<span class="number">4</span>] &#123; <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;T&#x27;</span> &#125;);</span><br><span class="line">                ChaiFen(tiqu);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//定义开奖需要用到的数据</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> DuQu_xuhao;<span class="comment">//拆分后的序号(int)</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span>[] DuQu_shuzi = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">7</span>];<span class="comment">//定义一个读取文件后赋值的数组，用于比较是否中奖</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> DuQu_time;<span class="comment">//拆分后的时间(string)</span></span><br><span class="line">        <span class="comment">//拆分</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChaiFen</span>(<span class="params"><span class="built_in">string</span>[] tiqu</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//拆分后的序号(int)</span></span><br><span class="line">            DuQu_xuhao = <span class="built_in">int</span>.Parse(tiqu[<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">//拆分后的红球(string)</span></span><br><span class="line">            <span class="built_in">string</span> chai_red = tiqu[<span class="number">2</span>];</span><br><span class="line">            <span class="built_in">int</span>[] chaifen_red = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];</span><br><span class="line">            chaifen_red = ChaiFenRed(chai_red);</span><br><span class="line">            <span class="comment">//拆分后的蓝球(int)</span></span><br><span class="line">            <span class="built_in">int</span> chaifen_blue = <span class="built_in">int</span>.Parse(tiqu[<span class="number">3</span>]);</span><br><span class="line">            <span class="comment">//拆分后的时间(string)</span></span><br><span class="line">            DuQu_time = tiqu[<span class="number">4</span>];</span><br><span class="line">            <span class="comment">//转换数据类型</span></span><br><span class="line">            IntZhuanHuan(chaifen_red, chaifen_blue);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//继续拆分红球</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">int</span>[] <span class="title">ChaiFenRed</span>(<span class="params"><span class="built_in">string</span> chai_red</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span>[] red = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>];</span><br><span class="line">            <span class="built_in">int</span> t = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                red[i] = <span class="built_in">int</span>.Parse(chai_red.Substring(t, <span class="number">2</span>));</span><br><span class="line">                t = t + <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> red;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//读取文件后赋值的数组赋值</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">IntZhuanHuan</span>(<span class="params"><span class="built_in">int</span>[] chaifen_red, <span class="built_in">int</span> chaifen_blue</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                DuQu_shuzi[i] = chaifen_red[i];</span><br><span class="line">            &#125;</span><br><span class="line">            DuQu_shuzi[<span class="number">6</span>] = chaifen_blue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="六、最后"><a href="#六、最后" class="headerlink" title="六、最后"></a>六、最后</h2><h3 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h3><blockquote><p>C# 文本文件的读写：<br><a href="https://www.runoob.com/csharp/csharp-text-files.html%EF%BC%9B">https://www.runoob.com/csharp/csharp-text-files.html；</a><br>C# 如何改变控制台输出字体颜色：<br><a href="https://zhidao.baidu.com/question/1429971132764662059.html%EF%BC%9B">https://zhidao.baidu.com/question/1429971132764662059.html；</a></p></blockquote><h3 id="源码分享"><a href="#源码分享" class="headerlink" title="源码分享"></a>源码分享</h3><p>源码分享： <a href="https://zhaifanhua.lanzous.com/iSJgGjl45od">源码分享</a> </p><blockquote><p>如果你觉得这篇文章还不错，请动动小指头点赞、收藏和关注哦！若本文带给你很大帮助，也可以打赏博主一杯可乐ღゝ◡╹)ノ♡<br>摘繁华版权所有，转发或引用请附上原文链接哦！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CSharp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> 模拟双色球 </tag>
            
            <tag> 控制台应用程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爱遇暮春花亦知秋（二）</title>
      <link href="/2018/10/08/7213e94fcf21/"/>
      <url>/2018/10/08/7213e94fcf21/</url>
      
        <content type="html"><![CDATA[<p>爱遇暮春 花亦知秋（二）</p><p>​            ——赠会宁一中相遇的你</p><p>执笔：摘繁华</p><p>丁酉年的深秋，在追求知识的路上，感谢时光让我们相知相遇。</p><p>秋，是个收获的季节，也是一个感怀的季节，她不像春一样有着万般柔情，也没有冬夏的严寒酷暑，却有着让人感到静谧释然的意境，总是被感叹光阴的文人墨客所留恋。正如唐张谔《九日》诗：“秋天林下不知春，一种佳游事也均。”秋天人人共适，而与自然山水雅居的心境，却诠释着一种独特的季节。我不是文人墨客，不能像苏东坡那样写出秋“纵一苇之所如，凌万顷之茫然”的气象万千，以诗借景抒情。又备战高考，于是只能闲步于校园，稍作放松。</p><p>静立在博雅楼前孔子像旁，景色自是美到了极致：阳光下金色的叶趁着湛蓝的天空于风中婆娑起舞，那种强烈反差、鲜明影调和亮丽色彩，足以惊艳世间。每一个叶片都将太阳托起，每一根叶脉都注满了能量，光在叶间闪烁，年轮在枝干上凝结。肥厚的叶片，一阵风吹过，仿佛有千万个风铃响起，清脆悦耳，炽烈的阳光穿透厚厚的叶片，投下一地细碎的光影，感觉整个校园都在光波里摇曳。</p><p>漫过后院长廊，花园的秋同样不吝啬：绯红的藤蔓间依稀夹杂着几片时光遗忘了的绿，与枝间凉亭红柱交相呼应，浑然一体。园中有几颗柏树，叶子已落的剩下不多，秋天迟迟没有降霜，似乎在延长这些生命最后的期限。</p><p>这是久久不能忘怀的那个秋。</p><p>田径场上没有秋，课外活动嬉戏玩闹的同学中，我看到的只有慢步的你。</p><p>今又逢秋非故地，过往离愁落江城。</p><p>武汉，又称江城，作为楚文华的重要发祥地、国家历史文化名城，原想移步于枫多山“霜叶亭”，可泛舟湖上，欣赏满山一片红叶的秋景，感受“霜叶红于二月花”的意境。怎奈现未入深秋，无长风落叶，湖也略显小气，远风平浪静，近波光粼粼，又没有鱼虾玩乐之趣，也就无观赏之情了。而会宁一中又被透红的叶儿点缀的色彩斑斓了吧。于是愈加怀念此时节母校的秋了。</p><p>前两天，母亲通电话那边已然落了雪，雪踏红叶的安静可能优胜于喧嚣的繁华吧？或许是因为我本就不圆滑的社会价值观：看到纯粹，朴实的季节更让我神往。</p><p>而秋天里的偶遇：那份我即便努力等待也不会随时间打磨隔阂的背影，那个温文尔雅，气质如霜的你，也像我跟母校一样被江河山川阻挡，远在津师，恐难以再次相视，相识。</p><p>禅意歌者刘珂矣《风誓》歌词中有“最短暂的相逢，最动人 、是刹那、是缘分，茫茫的人海里，又是谁静静数黄昏。秋天在等微雨，我等风也在等你”。而我，也在这没有秋的武汉，静静地敲击出这些文字，等那不会拂面的风、和不再相见的你。</p><p>2018.10.8 感怀</p>]]></content>
      
      
      <categories>
          
          <category> 散文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 散文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>秋殇别恋</title>
      <link href="/2018/08/22/dedc85679aee/"/>
      <url>/2018/08/22/dedc85679aee/</url>
      
        <content type="html"><![CDATA[<p>《秋殇别恋》（2018.8.22）</p><p>秋风渐劲草木黄，独留一树着红裳。</p><p>落意反顾萧瑟处，朦胧俏笑贞情郎。</p><p>十书玉言微雨凉，陌路天涯痛自尝。</p><p>终生难视佳人袂，身老不愧桃花伤。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微雨更寄叶之秋</title>
      <link href="/2018/02/18/54d443ad3e42/"/>
      <url>/2018/02/18/54d443ad3e42/</url>
      
        <content type="html"><![CDATA[<p>《微雨更寄叶之秋》（2018.2.18）</p><p>去年同窗共写意，忽生对诗点笔情。</p><p>寂夜孤灯留独影，弱姿频梦印我心。</p><p>那堪更事无相告，暗落清泪染白裙。</p><p>踏韵揉墨贞情刻，何惜终得残月魂！</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>九张机之繁华世鉴</title>
      <link href="/2017/09/15/aff489e68966/"/>
      <url>/2017/09/15/aff489e68966/</url>
      
        <content type="html"><![CDATA[<p>《九张机之繁华世鉴》（2017.9.15）</p><p>一张机。半城烟沙走天涯，金戈铁马赢天下。一生君王，盛世繁华。牵起了风沙？</p><p>两张机。范院兰衫忧思深，广询山水浮华真。昆仑少林，武当峨嵋。其道源于他？</p><p>三张机。幸遇红颜嫣然俏，运转清酒百盏杯。一点清香，十里芬芳。只因一席话？</p><p>四张机。花田文字鉴真心，一点朱墨玉簟青。万古长安，千滴苍泪。把相思放下？</p><p>五张机。轻卷珠帘雁双飞，直泻瀑布孤单行。白菊奇艳，辉洒满遍。竟染白红霞？</p><p>六张机。投箸忽闻泼茶香，微转巧得佳人厢。又感馨芳，流连茶香。今缘已挥洒？</p><p>七张机。芳龄尚小倾天下，青城楼兰何谓她。回眸一笑，百媚娇艳。倾动依丹砂？</p><p>八张机。语话桑麻古河畔，缘定三生今昙花。同门云集，对弹琵琶。弦传埋自夸？</p><p>九张机。人生常梦画中话，槐花飘香风流他。始于脚下，意气风发。终生不负她？</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爱遇暮春花亦知秋（一）</title>
      <link href="/2017/06/06/96606c332d17/"/>
      <url>/2017/06/06/96606c332d17/</url>
      
        <content type="html"><![CDATA[<p>爱遇暮春花亦知秋（一）</p><p>​            ——赠生病的爱花开心果</p><p>执笔：摘繁华</p><p>生命每天在开玩笑，如曾经许诺憧憬的似水年华。</p><p>余生我只剩下梦了。除了窗前汲取阳光与温暖的你，谁也没有看见我眼角落下的泪。你两叶的边缘正渐渐泛黄，也许，恰需要这种溶解着感伤的咸液用痛着的爱来滋养一颗干涸寂寞的心。</p><p>人无逢适处，却惹粉翠怜。</p><p>知，亦或不知，等待命运对自身的如是真许，经风雨几番辗转，随意漂浮流散的愉悦，任时光中的浊尘与辛甘抚孕着你几乎无力支撑的叶脉，归于初识的纯贞。</p><p>雨，仍旧冲洗着你突刺的枝干，同岁月不断刷新着我束缚灵魂的骨肉一样，悄然无声。这是不挥手的告别，还是世间苍老的深叹？留给你和我最原始的回忆。</p><p>夜静栏栅凉，行人甚匆匆。</p><p>此刻，你正吸吮着我与你共同蕴存的峥嵘岁月，在昏明的灯光下，私自贮藏只属于你的悲与乐。但对我，你又那么傻，触破你的心把你的幸福如数给我，用已换我久违的笑。你将爱给了一个普通的平凡人，而我因为有你，才觉得这世上仅只我们两个：最不平凡。</p><p>许是梦久了，人自然会醒。可我并不想醒，那便喝酒吧。现在的酒不同古时，少了单纯香醇的清冽，却倍增着浓烈的浮华，这其中还夹杂着喧嚣与污浊，很容易将人吃醉。很多人就沉恋于此种酒色迷离的生活里，听从这些浊液的摆布。醉便醉吧！我不愿醒，不愿让这垂暮的模糊映入我的双眸，不愿让这寒冷的轻浮传入我的两耳。</p><p>昨日已经过去。</p><p>朦胧中慵懒的睁开一只眼，今天的阳光真好，斜照着反射出飘于空中的埃尘，异常斑斓。你倚在金属窗框上，仍然使劲地争取着自然的能量，仿佛要窥探多彩光晕的秘密一样。你深知我不能够再去消受这些淳朴的慈爱，可你是否知道，我也不想让你受伤的身子去承受我的痛苦。</p><p>曾经无话不说的玩伴，现在抬头仰望的五官。接近社会的体验让我感到大城市里对于沉稳安静的追求几近消失，也让我莫名地有了一种天涯相逢无知己的孤独的悲痛。</p><p>于是我变得不敢再面对你，继续用愈烈的酒消磨在我自己理想的天真里，继续梦我的梦吧，梦中有新的宇宙……</p><p>2017.6.6 感怀</p>]]></content>
      
      
      <categories>
          
          <category> 散文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 散文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>九世劫之笔墨纸砚书风花雪月</title>
      <link href="/2017/06/05/2112dbc289ba/"/>
      <url>/2017/06/05/2112dbc289ba/</url>
      
        <content type="html"><![CDATA[<p>《九世劫之笔墨纸砚书风花雪月》（2017.6.5）</p><p>你为笔时，潜题雅词启腕成诗千世灵戬。</p><p>你为墨时，轻斟一韵点点陈情愁思难迁。</p><p>你为纸时，黄昏倩影倚风倦尺泪落榴莲。</p><p>你为砚时，拦尘入画生死白话沉殣当年。</p><p>你为书时，寒窗苦读聚圣汇贤风度翩翩。</p><p>你为风时，尘漠万丈浩势当空毫不示娴。</p><p>你为花时，绽放娇艳终落归根栖地长眠。</p><p>你为雪时，漫天飞舞停歇竹竿却压枝甸。</p><p>你为月时，夜明晨息待缘相续中秋话甜。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三叠奏 挚尘无诲</title>
      <link href="/2017/01/06/871413cedde9/"/>
      <url>/2017/01/06/871413cedde9/</url>
      
        <content type="html"><![CDATA[<p>《三叠奏 挚尘无诲》（2017.1.6）</p><p>夜静月闲，人不寐，时过境迁化觉最。</p><p>伏顷祈荡诗已碎，却拦故人战袍翠。</p><p>着试逸茵便沉对，陌上扑泪哭满慧。</p><p>是不知寐，可知寐？</p><p>笔破寒眉换淑媚，汝既知悦吾不寐。</p><p>青瓶梅颂，书落纵，寂谷幽空剑持讼。</p><p>迫饮荼醇且自恭，然看花魂醉眼聪。</p><p>铮筝念动武墨鸿，孤背依阳仇聚瞳。</p><p>是不知颂，可知颂？</p><p>丹田气涌天欲颂，破镜重圆实可颂？</p><p>梦里痴愁，人不愁，心潮散廓病千秋。</p><p>晌池已过否他眸，斜日诉归变了楼。</p><p>银戟威扬征颤手，寇还未境玉兰勾。</p><p>是不知愁，可知愁？</p><p>峰潭必过湮没愁，筱琴穿空说无愁。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>金缕曲 冬月廿五日思英囡闲读性德词有感</title>
      <link href="/2016/12/23/dcc0e378817f/"/>
      <url>/2016/12/23/dcc0e378817f/</url>
      
        <content type="html"><![CDATA[<p>《金缕曲 冬月廿五日思英囡闲读性德词有感》〔1〕（2016.12.23）</p><p> 同窗夜鼾宿。弎〔2〕辗转，信语成谶〔3〕，昶〔4〕思倾绪。莫道人生如初见〔5〕，迨庠序〔6〕逐期满。顾圞月〔7〕，浮生若梦〔8〕。过往皎洁〔9〕不成睆〔10〕，此间累、与何人快觞？途生隶〔11〕，无休矣。</p><p> 遥幻黛沫〔12〕时已寐。心交织，川峘〔13〕相缪〔14〕，几载悱言〔15〕。独着丝袗〔16〕鬟〔17〕溢黁〔18〕，思忆终成情诺。掷流光，上元有六〔19〕。隔日闲淡甚駪〔20〕念，可曾有，琼枝〔21〕现馨昪〔22〕？高考毕，芳心依。</p><p>【注释】：</p><p>〔1〕金缕曲：词牌名；英囡:友人。拜读纳兰容若词集，有感而发，即兴之作。</p><p>〔2〕弎（sān）：同“三”，这里表概数，几次，数次。</p><p>〔3〕谶（chèn）：谶语，迷信的人指事后应验的话。</p><p>〔4〕昶（chǎng）：舒畅，畅通。</p><p>〔5〕莫道人生如初见：引用纳兰容若《木兰花令•拟古决绝词》首句“人生若只如初见，何事秋风悲画扇”。意为人生如果就像最初相识那样（这里包含了对繁华苑的感慨）。</p><p>〔6〕迨（dài）：等到；庠序：学校。这里指在学校的日子。</p><p>〔7〕圞（luán）月：圆月。</p><p>〔8〕浮生若梦：慨叹人生苦短。</p><p>〔9〕皎洁：借指月亮。</p><p>〔10〕睆（huǎn）：明亮。</p><p>〔11〕途生隶：倒装，生隶途，生活在像奴隶一样没有自由的时代。</p><p>〔12〕黛沫：英囡繁华苑圈名。</p><p>〔13〕峘（huán）：大山。</p><p>〔14〕相缪：相互交错。</p><p>〔15〕悱（fěi）言：想说却又不知道怎么说的话。</p><p>〔16〕丝袗（zhěn）：有丝带的单衣。</p><p>〔17〕鬟（huán）：女子梳妆的发束，成环状。这里泛指秀发。</p><p>〔18〕黁（nún）：香气。</p><p>〔19〕上元有六：上元，上元节，即元宵节，这里借指每月十五日月圆之夜。距高考还有六个月圆之夜，即有六个月。</p><p>〔20〕駪（shēn）：众多。</p><p>〔21〕琼枝：带冰雪的树枝。晶莹剔透的枝头。</p><p>〔22〕昪（biàn）：欢乐。 </p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百字令之剑士离情</title>
      <link href="/2016/09/08/4641376a76f2/"/>
      <url>/2016/09/08/4641376a76f2/</url>
      
        <content type="html"><![CDATA[<p>《百字令之剑士离情》（2016.9.8）</p><p>凌</p><p>腾空</p><p>织缎扬</p><p>执念彷徨</p><p>溅血落成洑</p><p>心禅旧时潋足</p><p>寒刃流影指眉间</p><p>谷峡久荡豪声空笑</p><p>风云武林花叶已成末</p><p>剑之故事定将以血为墨</p><p>沿途黄泉情寄彼岸花</p><p>一笑倾城如若鸩吻</p><p>生死相离梅枝恋</p><p>泪淌笑忆梁祝</p><p>饮她酿酴醾</p><p>一世羁绊</p><p>蓝衫落</p><p>宗师</p><p>亡</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>御街行 边城临绝</title>
      <link href="/2016/05/27/dfcc21de800b/"/>
      <url>/2016/05/27/dfcc21de800b/</url>
      
        <content type="html"><![CDATA[<p>《御街行 边城临绝》（2016.5.27）</p><p>卯时鸡鸣晨露睡。相思碎、青城泪。雨落埋头心萍迈，初月嶦陌静寐。言语无悔，云愁昧昧，谱一曲安泰。</p><p>夜夜梦樱伊人会。懿窭费、半生累。红尘已醉楼兰坠，碑文苍颜憔悴。烛光媚媚，泪流不洄，素笺丢烟台。</p><p>【注释】：</p><p>①在早五六点钟鸡鸣之时，叶上所沾的露水还是静静的，似在沉睡。想起丈夫临行前对自己所说的话，便不由自主流下了眼泪。心中的思念就像大雨滂沱淹过了心头，而山中小路则像傍晚刚刚升起月亮的时候一样静。虽然不悔当初答应他的不会独自饮酒默默流泪思念他的誓言，但也愁上阵杀敌的他的安危，那我就弹一首他最爱的曲子愿他平平安安吧。</p><p>②在边疆的每一个夜晚都无不梦到和她相见，但是现在再美好的想象也都不可能实现，只能感叹自己生活的太累。自己的妻子因思念自己而独自饮酒发醉，国家边疆又失了一座城池，突然间想起为国捐躯的自己的父亲，如今他的墓碑上已是尘土沾满、杂草丛生了吧？军帐里的烛光闪闪跳动，眼中落下的泪水不会流回，妻子从家乡寄来的信笺中包含的思念让像我这样的千千万万的将士无心御敌，导致又丢掉了一座风烟台。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>西江月 遥谊</title>
      <link href="/2016/03/02/11782b46c064/"/>
      <url>/2016/03/02/11782b46c064/</url>
      
        <content type="html"><![CDATA[<p>《西江月 遥谊》（2016.3.2）</p><p>拂晓梦魇筝弦，诗词残杯苦心。</p><p>玉砚笔墨讽古今，墙外冰雪时劲。</p><p>乌云冬风难断，昔日枯枝情愁。</p><p>小楼欲坠融珠漏，笑如初识春游。</p>]]></content>
      
      
      <categories>
          
          <category> 诗词 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2016/02/26/9dcf3840ada1/"/>
      <url>/2016/02/26/9dcf3840ada1/</url>
      
        <content type="html"><![CDATA[<h1 id="即鹿比虞，唯入于林中，君子几，不如舍，往吝。"><a href="#即鹿比虞，唯入于林中，君子几，不如舍，往吝。" class="headerlink" title="即鹿比虞，唯入于林中，君子几，不如舍，往吝。"></a>即鹿比虞，唯入于林中，君子几，不如舍，往吝。</h1><p><img src="https://img.zhaifanhua.com/blogimg/20210413031401.jpeg!sign" alt="HelloWorld"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Hello World </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>愚之自鉴，喜逢同道中人。</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>摘繁华 ZhaiFanhua<br>白衣无尘，亦如初见。陇右人士，喜古风与汉服。 相互珍重，各自安好。<br>The white clothes are dust- free,as if we first met.I was born in Gansu, China,and like ancient customs and Han Dynasty Clothing.Cherish each other and everything goes smoothly for you and me.</p></blockquote><p>我是一个初级程序员都算不上的渣渣，但如果我们成为朋友，且你乐意分享快乐与知识，我会成为你忠实的倾听者。因为比起说，我更喜欢倾听……</p><p>欲了解更多，请移步摘繁华官方主页：<a href="https://www.zhaifanhua.com/">https://www.zhaifanhua.com</a></p><div class="tabs" id="喜欢与不喜欢"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#喜欢与不喜欢-1">喜欢的</button></li><li class="tab"><button type="button" data-href="#喜欢与不喜欢-2">不喜欢的</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="喜欢与不喜欢-1"><h2 id="喜欢的"><a href="#喜欢的" class="headerlink" title="喜欢的"></a>喜欢的</h2><h3 id="大佬"><a href="#大佬" class="headerlink" title="大佬"></a>大佬</h3><blockquote><p>尤雨溪（独立开源开发者，前端框架Vue.js的作者）、Anders Hejlsberg（CSharp之父）</p></blockquote><h3 id="演员"><a href="#演员" class="headerlink" title="演员"></a>演员</h3><blockquote><p>六小龄童、靳东、赵丽颖、王宝强、李幼斌、游本昌、谢孟伟、张一山、钟汉良、毛晓彤、乔振宇、焦恩俊、钟汉良、黄渤</p></blockquote><h3 id="歌手"><a href="#歌手" class="headerlink" title="歌手"></a>歌手</h3><blockquote><p>刘珂矣（禅意歌者）、李健、李玉刚、邓紫棋、胡彦斌、萨顶顶、华晨宇、毛不易、刀郎、叶里、周深、腾格尔、许嵩、龚琳娜</p></blockquote><h3 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h3><blockquote><p>《花田半亩》、《周易》、《断舍离》</p></blockquote><h3 id="电影"><a href="#电影" class="headerlink" title="电影"></a>电影</h3><blockquote><p>《大鱼海棠》、《天空之眼》、《海上钢琴师》、《功夫》、《Hello！树先生》、《天下无贼》、《一个人的武林》、《唐伯虎点秋香》、《武状元苏乞儿》、《中国机长》、《让子弹飞》、《霸王别姬》、《一出好戏》</p></blockquote><h3 id="电视剧"><a href="#电视剧" class="headerlink" title="电视剧"></a>电视剧</h3><blockquote><p>《西游记》（杨洁导演86版）、《水浒传》（1998李雪健版）、《红楼梦》（王扶林导演87版）、《三国演义》（1994唐国强版）、《亮剑》（李幼斌版）、《暖春》、《济公》、《铁道游击队》、《长安十二时辰》、《余罪》、《阳光之下》、《最好的我们》、《神探狄仁杰》、《楚乔传》、《天涯明月刀》、《宝莲灯》</p></blockquote><h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><blockquote><p>《秦时明月》系列、《墓王之王》系列、《天行九歌》、《斗罗大陆》、《武庚纪》、《西行纪》、《魔道祖师》、《灵笼》、《吞噬星空》</p></blockquote><h3 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h3><blockquote><p>《十一年》、《半壶纱》、《山水之间》、《贝加尔湖畔》、《天堂》、《少年不识愁滋味》、《提诗侧畔》、《万疆》、《Faded》、《忐忑》（唱功第一的神曲）、《卷珠帘》</p></blockquote><h3 id="艺术家"><a href="#艺术家" class="headerlink" title="艺术家"></a>艺术家</h3><blockquote><p>方锦龙</p></blockquote><h3 id="纯音乐"><a href="#纯音乐" class="headerlink" title="纯音乐"></a>纯音乐</h3><blockquote><p>《淡淡的忧伤》(长安十二时辰)</p></blockquote><h3 id="纪录片"><a href="#纪录片" class="headerlink" title="纪录片"></a>纪录片</h3><blockquote><p>《航拍中国》、《舌尖上的中国》、《海昏侯》</p></blockquote><h3 id="企业家"><a href="#企业家" class="headerlink" title="企业家"></a>企业家</h3><blockquote><p>任正非、曹德旺、刘强东、雷军</p></blockquote><h3 id="一句话"><a href="#一句话" class="headerlink" title="一句话"></a>一句话</h3><blockquote><ul><li>生命是跌撞的曲折，死亡是宁静的星，归于尘土，归于雨露，这世界上不再有我，却又无处不是我。<br>——田维 《花田半亩》</li><li>不吃辣椒的人非要贬低吃辣椒的人，其心可诛。<br>吃辣椒的非要天下都一起无辣不欢，既顽且鲁。</li><li>不是年少守不住旧情，而是深情一往都是人走茶凉。</li><li>以金刚石猪牙还牙，以钛合金狗眼还眼。</li></ul></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="喜欢与不喜欢-2"><h2 id="不喜欢"><a href="#不喜欢" class="headerlink" title="不喜欢"></a>不喜欢</h2><h3 id="这些人"><a href="#这些人" class="headerlink" title="这些人"></a>这些人</h3><blockquote><p>没多大本事爱装逼的、喜欢背后议论别人的、染发纹身等不良少年的、多说少做的、无脑追星的</p></blockquote><h3 id="一句话"><a href="#一句话" class="headerlink" title="一句话"></a>一句话</h3><blockquote><p>你喜欢就好！<br>还好吧，也就……<br>你干嘛非要……</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>既遇桃园，处处志之。</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>道不同不相为谋，亦各从其志也。</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>居必择乡，游必择士。</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[<div class="tabs" id="友链信息"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#友链信息-1">友链要求</button></li><li class="tab"><button type="button" data-href="#友链信息-2">本站信息</button></li><li class="tab"><button type="button" data-href="#友链信息-3">申请格式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="友链信息-1"><p>1、使用独立域名且全站 SSL 加密，站点稳定运行，在百度、谷歌等各大搜索引擎中能够正常收录；<br>2、站点性质为非商业性的个人博客或古风文学类网站，凡内容污秽、暴力、广告、盗版、破解、网页植入脚本、极低质量内容、违背道德概不添加；<br>3、博友能长期互访，尊重创作版权，参考内容写清来源；<br>4、请移步本站关于页面，若兴趣相投，优先添加并置顶；<br>5、申请友链前请先添加本站为友链，且贵站友链没有 nofollow；<br>6、喜欢古风文学、诗词散文、汉服（非cosplay）者，无视以上直接添加；</p><blockquote><p>长期未更新或无法访问、单方面移除本站链接等，将直接移除，恕不另行通知，敬请谅解。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="友链信息-2"><p>站点名称：摘繁华个人博客<br>站点描述：白衣无尘，亦如初见。<br>站点链接：<a href="https://blog.zhaifanhua.com/">https://blog.zhaifanhua.com</a><br>图标链接：<a href="https://cdn.zhaifanhua.com/static/img/avatar/zhaifanhua.png">https://cdn.zhaifanhua.com/static/img/avatar/zhaifanhua.png</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---国内CDN链接（推荐）---</span><br><span class="line">jpg：https://cdn.zhaifanhua.com/static/img/avatar/zhaifanhua.jpg</span><br><span class="line">png：https://cdn.zhaifanhua.com/static/img/avatar/zhaifanhua.png</span><br><span class="line">webp：https://cdn.zhaifanhua.com/static/img/avatar/zhaifanhua.webp</span><br><span class="line">---全球通用头像（不推荐）---</span><br><span class="line">gravatar：</span><br><span class="line">https://sdn.geekzu.org/avatar/bcd6dd5e3a4bfade22b7ec6dcad556a9?s=200</span><br><span class="line">https://gravatar.loli.net/avatar/bcd6dd5e3a4bfade22b7ec6dcad556a9?s=200</span><br></pre></td></tr></table></figure><blockquote><p>请优先使用国内链接，以优化您网站的访问速度。受不可抗力因素，全球通用头像gravatar链接会经常性失效，这里不再推荐使用。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="友链信息-3"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">站点名称：您的站点名称；</span><br><span class="line">站点描述：您网站的简短描述；</span><br><span class="line">站点链接：您网站的地址；</span><br><span class="line">图标链接：您网站的图标，请优先提供国内链接。</span><br></pre></td></tr></table></figure><blockquote><p>确认您满足友链要求后，在添加本站链接后按照以上格式在留言申请友链，我会第一时间添加您的站点。</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/static/css/modify.css"/>
      <url>/static/css/modify.css</url>
      
        <content type="html"><![CDATA[#toggle-sidebar {  bottom: 80px;}@media screen and (max-width: 700px) {  .aplayer {    display: none;  }}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/static/js/seo.js"/>
      <url>/static/js/seo.js</url>
      
        <content type="html"><![CDATA[/* -----------------------360搜索----------------------- */(function () {  var src = "https://s.ssl.qhres2.com/ssl/ab77b6ea7f3fbf79.js";  document.write('<script src="' + src + '" id="sozz"></script>');})();/* -----------------------百度搜索----------------------- */(function () {  var canonicalURL, curProtocol;  //Get the <link> tag  var x = document.getElementsByTagName("link");  //Find the last canonical URL  if (x.length > 0) {    for (i = 0; i < x.length; i++) {      if (x[i].rel.toLowerCase() == "canonical" && x[i].href) {        canonicalURL = x[i].href;      }    }  }  //Get protocol  if (!canonicalURL) {    curProtocol = window.location.protocol.split(":")[0];  } else {    curProtocol = canonicalURL.split(":")[0];  }  //Get current URL if the canonical URL does not exist  if (!canonicalURL) canonicalURL = window.location.href;  //Assign script content. Replace current URL with the canonical URL  !(function () {    var e = /([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,      r = canonicalURL,      t = document.referrer;    if (!e.test(r)) {      var n =        String(curProtocol).toLowerCase() === "https"          ? "https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif"          : "//api.share.baidu.com/s.gif";      t        ? ((n += "?r=" + encodeURIComponent(document.referrer)),          r && (n += "&l=" + r))        : r && (n += "?l=" + r);      var i = new Image();      i.src = n;    }  })(window);})();/* -----------------------头条搜索----------------------- */(function () {  (function () {    var el = document.createElement("script");    el.src =      "https://sf1-scmcdn-tos.pstatp.com/goofy/ttzz/push.js?7ba195fade40c93d381c7da8ebc6bc6333b3bae5457e9f0e8017ad7c9cf74984c26e2585b8f4bfda193e82b0f7517b02431fe1e5187b24174fe892c4cb1cf00c0630377f861b7f6846b53633941134fa";    el.id = "ttzz";    var s = document.getElementsByTagName("script")[0];    s.parentNode.insertBefore(el, s);  })(window);})();]]></content>
      
    </entry>
    
    
  
</search>
